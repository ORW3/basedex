import{A as nS,B as Dn,C as Ei,D as gh,E as ec,F as Yy,G as rS,H as iS,I as z,J as on,K as pt,L as Xy,M as sS,N as tc,O as W,P as St,Q as mh,R as Zy,S as Tn,T as Ii,U as Hr,V as $o,W as oS,X as an,Y as Ye,a as M,b as fe,c as Wy,d as _,e as Kb,f as uh,g as Qb,h as Yb,i as T,j as Uo,k as dh,l as Xb,m as Zb,n as yt,o as Bo,p as Jl,q as Ky,r as Jb,s as ar,t as Qy,u as hh,v as fh,w as eS,x as ph,y as st,z as tS}from"./chunk-SEUN3R5A.js";var aS=null;var Jy=1,e_=Symbol("SIGNAL");function we(t){let e=aS;return aS=t,e}var lS={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function wj(t){if(!(r_(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Jy)){if(!t.producerMustRecompute(t)&&!t_(t)){t.dirty=!1,t.lastCleanEpoch=Jy;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Jy}}function cS(t){return t&&(t.nextProducerIndex=0),we(t)}function uS(t,e){if(we(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(r_(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)n_(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function t_(t){yh(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(wj(n),r!==n.version))return!0}return!1}function dS(t){if(yh(t),r_(t))for(let e=0;e<t.producerNode.length;e++)n_(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function n_(t,e){if(Ej(t),yh(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)n_(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];yh(i),i.producerIndexOfThis[r]=e}}function r_(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function yh(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function Ej(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function Ij(){throw new Error}var Cj=Ij;function hS(t){Cj=t}function Y(t){return typeof t=="function"}function qo(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var _h=qo(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Ss(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Xe=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(Y(r))try{r()}catch(s){e=s instanceof _h?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{fS(s)}catch(o){e=e??[],o instanceof _h?e=[...e,...o.errors]:e.push(o)}}if(e)throw new _h(e)}}add(e){var n;if(e&&e!==this)if(this.closed)fS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Ss(n,e)}remove(e){let{_finalizers:n}=this;n&&Ss(n,e),e instanceof t&&e._removeParent(this)}};Xe.EMPTY=(()=>{let t=new Xe;return t.closed=!0,t})();var i_=Xe.EMPTY;function vh(t){return t instanceof Xe||t&&"closed"in t&&Y(t.remove)&&Y(t.add)&&Y(t.unsubscribe)}function fS(t){Y(t)?t():t.unsubscribe()}var Un={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ho={setTimeout(t,e,...n){let{delegate:r}=Ho;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Ho;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function wh(t){Ho.setTimeout(()=>{let{onUnhandledError:e}=Un;if(e)e(t);else throw t})}function As(){}var pS=s_("C",void 0,void 0);function gS(t){return s_("E",void 0,t)}function mS(t){return s_("N",t,void 0)}function s_(t,e,n){return{kind:t,value:e,error:n}}var xs=null;function zo(t){if(Un.useDeprecatedSynchronousErrorHandling){let e=!xs;if(e&&(xs={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=xs;if(xs=null,n)throw r}}else t()}function yS(t){Un.useDeprecatedSynchronousErrorHandling&&xs&&(xs.errorThrown=!0,xs.error=t)}var Rs=class extends Xe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,vh(e)&&e.add(this)):this.destination=bj}static create(e,n,r){return new zr(e,n,r)}next(e){this.isStopped?a_(mS(e),this):this._next(e)}error(e){this.isStopped?a_(gS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?a_(pS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Dj=Function.prototype.bind;function o_(t,e){return Dj.call(t,e)}var l_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Eh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Eh(r)}else Eh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Eh(n)}}},zr=class extends Rs{constructor(e,n,r){super();let i;if(Y(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Un.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&o_(e.next,s),error:e.error&&o_(e.error,s),complete:e.complete&&o_(e.complete,s)}):i=e}this.destination=new l_(i)}};function Eh(t){Un.useDeprecatedSynchronousErrorHandling?yS(t):wh(t)}function Tj(t){throw t}function a_(t,e){let{onStoppedNotification:n}=Un;n&&Ho.setTimeout(()=>n(t,e))}var bj={closed:!0,next:As,error:Tj,complete:As};var Go=typeof Symbol=="function"&&Symbol.observable||"@@observable";function At(t){return t}function c_(...t){return u_(t)}function u_(t){return t.length===0?At:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var Z=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=Aj(n)?n:new zr(n,r,i);return zo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=_S(r),new r((i,s)=>{let o=new zr({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Go](){return this}pipe(...n){return u_(n)(this)}toPromise(n){return n=_S(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function _S(t){var e;return(e=t??Un.Promise)!==null&&e!==void 0?e:Promise}function Sj(t){return t&&Y(t.next)&&Y(t.error)&&Y(t.complete)}function Aj(t){return t&&t instanceof Rs||Sj(t)&&vh(t)}function d_(t){return Y(t?.lift)}function K(t){return e=>{if(d_(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function G(t,e,n,r,i){return new h_(t,e,n,r,i)}var h_=class extends Rs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Wo(){return K((t,e)=>{let n=null;t._refCount++;let r=G(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Ko=class extends Z{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,d_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Xe;let n=this.getSubject();e.add(this.source.subscribe(G(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Xe.EMPTY)}return e}refCount(){return Wo()(this)}};var vS=qo(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ge=(()=>{class t extends Z{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Ih(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new vS}next(n){zo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){zo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){zo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?i_:(this.currentObservers=null,s.push(n),new Xe(()=>{this.currentObservers=null,Ss(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new Z;return n.source=this,n}}return t.create=(e,n)=>new Ih(e,n),t})(),Ih=class extends Ge{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:i_}};var xt=class extends Ge{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var nc={now(){return(nc.delegate||Date).now()},delegate:void 0};var Ch=class extends Ge{constructor(e=1/0,n=1/0,r=nc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let l=1;l<r.length&&r[l]<=o;l+=2)a=l;a&&r.splice(0,a+1)}}};var Dh=class extends Xe{constructor(e,n){super()}schedule(e,n=0){return this}};var rc={setInterval(t,e,...n){let{delegate:r}=rc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=rc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Qo=class extends Dh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return rc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&rc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Ss(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Yo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Yo.now=nc.now;var Xo=class extends Yo{constructor(e,n=Yo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Gr=new Xo(Qo);var Th=class extends Qo{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var bh=class extends Xo{};var f_=new bh(Th);var Gt=new Z(t=>t.complete());function wS(t){return t&&Y(t.schedule)}function p_(t){return t[t.length-1]}function Zo(t){return Y(p_(t))?t.pop():void 0}function lr(t){return wS(p_(t))?t.pop():void 0}function ES(t,e){return typeof p_(t)=="number"?t.pop():e}var Sh=t=>t&&typeof t.length=="number"&&typeof t!="function";function Ah(t){return Y(t?.then)}function xh(t){return Y(t[Go])}function Rh(t){return Symbol.asyncIterator&&Y(t?.[Symbol.asyncIterator])}function Mh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function xj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Nh=xj();function Ph(t){return Y(t?.[Nh])}function kh(t){return Qb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield uh(n.read());if(i)return yield uh(void 0);yield yield uh(r)}}finally{n.releaseLock()}})}function Oh(t){return Y(t?.getReader)}function Se(t){if(t instanceof Z)return t;if(t!=null){if(xh(t))return Rj(t);if(Sh(t))return Mj(t);if(Ah(t))return Nj(t);if(Rh(t))return IS(t);if(Ph(t))return Pj(t);if(Oh(t))return kj(t)}throw Mh(t)}function Rj(t){return new Z(e=>{let n=t[Go]();if(Y(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Mj(t){return new Z(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Nj(t){return new Z(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,wh)})}function Pj(t){return new Z(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function IS(t){return new Z(e=>{Oj(t,e).catch(n=>e.error(n))})}function kj(t){return IS(kh(t))}function Oj(t,e){var n,r,i,s;return Kb(this,void 0,void 0,function*(){try{for(n=Yb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function ln(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function fn(t,e=0){return K((n,r)=>{n.subscribe(G(r,i=>ln(r,t,()=>r.next(i),e),()=>ln(r,t,()=>r.complete(),e),i=>ln(r,t,()=>r.error(i),e)))})}function Bn(t,e=0){return K((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function CS(t,e){return Se(t).pipe(Bn(e),fn(e))}function DS(t,e){return Se(t).pipe(Bn(e),fn(e))}function TS(t,e){return new Z(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function bS(t,e){return new Z(n=>{let r;return ln(n,e,()=>{r=t[Nh](),ln(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>Y(r?.return)&&r.return()})}function Fh(t,e){if(!t)throw new Error("Iterable cannot be null");return new Z(n=>{ln(n,e,()=>{let r=t[Symbol.asyncIterator]();ln(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function SS(t,e){return Fh(kh(t),e)}function AS(t,e){if(t!=null){if(xh(t))return CS(t,e);if(Sh(t))return TS(t,e);if(Ah(t))return DS(t,e);if(Rh(t))return Fh(t,e);if(Ph(t))return bS(t,e);if(Oh(t))return SS(t,e)}throw Mh(t)}function re(t,e){return e?AS(t,e):Se(t)}function L(...t){let e=lr(t);return re(t,e)}function Jo(t,e){let n=Y(t)?t:()=>t,r=i=>i.error(n());return new Z(e?i=>e.schedule(r,0,i):r)}function g_(t){return!!t&&(t instanceof Z||Y(t.lift)&&Y(t.subscribe))}var Wr=qo(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function F(t,e){return K((n,r)=>{let i=0;n.subscribe(G(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:Fj}=Array;function Lj(t,e){return Fj(e)?t(...e):t(e)}function Lh(t){return F(e=>Lj(t,e))}var{isArray:Vj}=Array,{getPrototypeOf:jj,prototype:Uj,keys:Bj}=Object;function Vh(t){if(t.length===1){let e=t[0];if(Vj(e))return{args:e,keys:null};if($j(e)){let n=Bj(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function $j(t){return t&&typeof t=="object"&&jj(t)===Uj}function jh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function ic(...t){let e=lr(t),n=Zo(t),{args:r,keys:i}=Vh(t);if(r.length===0)return re([],e);let s=new Z(qj(r,e,i?o=>jh(i,o):At));return n?s.pipe(Lh(n)):s}function qj(t,e,n=At){return r=>{xS(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let l=0;l<i;l++)xS(e,()=>{let c=re(t[l],e),u=!1;c.subscribe(G(r,d=>{s[l]=d,u||(u=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function xS(t,e,n){t?ln(n,t,e):e()}function RS(t,e,n,r,i,s,o,a){let l=[],c=0,u=0,d=!1,h=()=>{d&&!l.length&&!c&&e.complete()},f=g=>c<r?p(g):l.push(g),p=g=>{s&&e.next(g),c++;let m=!1;Se(n(g,u++)).subscribe(G(e,w=>{i?.(w),s?f(w):e.next(w)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;l.length&&c<r;){let w=l.shift();o?ln(e,o,()=>p(w)):p(w)}h()}catch(w){e.error(w)}}))};return t.subscribe(G(e,f,()=>{d=!0,h()})),()=>{a?.()}}function ot(t,e,n=1/0){return Y(e)?ot((r,i)=>F((s,o)=>e(r,s,i,o))(Se(t(r,i))),n):(typeof e=="number"&&(n=e),K((r,i)=>RS(r,i,t,n)))}function Ci(t=1/0){return ot(At,t)}function MS(){return Ci(1)}function ea(...t){return MS()(re(t,lr(t)))}function Uh(t){return new Z(e=>{Se(t()).subscribe(e)})}function m_(...t){let e=Zo(t),{args:n,keys:r}=Vh(t),i=new Z(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),l=o,c=o;for(let u=0;u<o;u++){let d=!1;Se(n[u]).subscribe(G(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(r?jh(r,a):a),s.complete())}))}});return e?i.pipe(Lh(e)):i}function ta(...t){let e=lr(t),n=ES(t,1/0),r=t;return r.length?r.length===1?Se(r[0]):Ci(n)(re(r,e)):Gt}function gt(t,e){return K((n,r)=>{let i=0;n.subscribe(G(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Di(t){return K((e,n)=>{let r=null,i=!1,s;r=e.subscribe(G(n,void 0,void 0,o=>{s=Se(t(o,Di(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function NS(t,e,n,r,i){return(s,o)=>{let a=n,l=e,c=0;s.subscribe(G(o,u=>{let d=c++;l=a?t(l,u,d):(a=!0,u),r&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}function Kr(t,e){return Y(e)?ot(t,e,1):ot(t,1)}function y_(t,e=Gr){return K((n,r)=>{let i=null,s=null,o=null,a=()=>{if(i){i.unsubscribe(),i=null;let c=s;s=null,r.next(c)}};function l(){let c=o+t,u=e.now();if(u<c){i=this.schedule(void 0,c-u),r.add(i);return}a()}n.subscribe(G(r,c=>{s=c,o=e.now(),i||(i=e.schedule(l,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function Ti(t){return K((e,n)=>{let r=!1;e.subscribe(G(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Qr(t){return t<=0?()=>Gt:K((e,n)=>{let r=0;e.subscribe(G(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function __(t){return F(()=>t)}function sc(t,e=At){return t=t??Hj,K((n,r)=>{let i,s=!0;n.subscribe(G(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Hj(t,e){return t===e}function Bh(t=zj){return K((e,n)=>{let r=!1;e.subscribe(G(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function zj(){return new Wr}function bi(t){return K((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function bn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?gt((i,s)=>t(i,s,r)):At,Qr(1),n?Ti(e):Bh(()=>new Wr))}function na(t){return t<=0?()=>Gt:K((e,n)=>{let r=[];e.subscribe(G(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function v_(t,e){let n=arguments.length>=2;return r=>r.pipe(t?gt((i,s)=>t(i,s,r)):At,na(1),n?Ti(e):Bh(()=>new Wr))}function oc(){return K((t,e)=>{let n,r=!1;t.subscribe(G(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function cr(t,e){return K(NS(t,e,arguments.length>=2,!0))}function ac(t={}){let{connector:e=()=>new Ge,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,l,c=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return K((g,m)=>{c++,!d&&!u&&h();let w=l=l??e();m.add(()=>{c--,c===0&&!d&&!u&&(a=w_(p,i))}),w.subscribe(m),!o&&c>0&&(o=new zr({next:S=>w.next(S),error:S=>{d=!0,h(),a=w_(f,n,S),w.error(S)},complete:()=>{u=!0,h(),a=w_(f,r),w.complete()}}),Se(g).subscribe(o))})(s)}}function w_(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new zr({next:()=>{r.unsubscribe(),t()}});return Se(e(...n)).subscribe(r)}function $h(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,ac({connector:()=>new Ch(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function E_(t){return K((e,n)=>{let r=!1,i=0;e.subscribe(G(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function Ms(...t){let e=lr(t);return K((n,r)=>{(e?ea(t,n,e):ea(t,n)).subscribe(r)})}function Ce(t,e){return K((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(G(r,l=>{i?.unsubscribe();let c=0,u=s++;Se(t(l,u)).subscribe(i=G(r,d=>r.next(e?e(l,d,u,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function qh(t,e){return Y(e)?Ce(()=>t,e):Ce(()=>t)}function I_(t){return K((e,n)=>{Se(t).subscribe(G(n,()=>n.complete(),As)),!n.closed&&e.subscribe(n)})}function Ze(t,e,n){let r=Y(t)||e||n?{next:t,error:e,complete:n}:t;return r?K((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(G(s,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),s.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),s.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),s.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):At}function C_(...t){let e=Zo(t);return K((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let l=0;l<i;l++)Se(t[l]).subscribe(G(r,c=>{s[l]=c,!a&&!o[l]&&(o[l]=!0,(a=o.every(At))&&(o=null))},As));n.subscribe(G(r,l=>{if(a){let c=[l,...s];r.next(e?e(...c):c)}}))})}var EA="https://g.co/ng/security#xss",V=class extends Error{constructor(e,n){super(bf(e,n)),this.code=e}};function bf(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function wc(t){return{toString:t}.toString()}var Hh="__parameters__";function Gj(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function IA(t,e,n){return wc(()=>{let r=Gj(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(l,c,u){let d=l.hasOwnProperty(Hh)?l[Hh]:Object.defineProperty(l,Hh,{value:[]})[Hh];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var Rt=globalThis;function Ae(t){for(let e in t)if(t[e]===Ae)return e;throw Error("Could not find renamed property on target object.")}function Wj(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function un(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(un).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function V_(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var Kj=Ae({__forward_ref__:Ae});function mr(t){return t.__forward_ref__=mr,t.toString=function(){return un(this())},t}function Wt(t){return CA(t)?t():t}function CA(t){return typeof t=="function"&&t.hasOwnProperty(Kj)&&t.__forward_ref__===mr}function k(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Pe(t){return{providers:t.providers||[],imports:t.imports||[]}}function Sf(t){return PS(t,TA)||PS(t,bA)}function DA(t){return Sf(t)!==null}function PS(t,e){return t.hasOwnProperty(e)?t[e]:null}function Qj(t){let e=t&&(t[TA]||t[bA]);return e||null}function kS(t){return t&&(t.hasOwnProperty(OS)||t.hasOwnProperty(Yj))?t[OS]:null}var TA=Ae({\u0275prov:Ae}),OS=Ae({\u0275inj:Ae}),bA=Ae({ngInjectableDef:Ae}),Yj=Ae({ngInjectorDef:Ae}),x=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=k({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function SA(t){return t&&!!t.\u0275providers}var Xj=Ae({\u0275cmp:Ae}),Zj=Ae({\u0275dir:Ae}),Jj=Ae({\u0275pipe:Ae}),eU=Ae({\u0275mod:Ae}),nf=Ae({\u0275fac:Ae}),lc=Ae({__NG_ELEMENT_ID__:Ae}),FS=Ae({__NG_ENV_ID__:Ae});function Ec(t){return typeof t=="string"?t:t==null?"":String(t)}function tU(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Ec(t)}function nU(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new V(-200,t)}function Rv(t,e){throw new V(-201,!1)}var le=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(le||{}),j_;function AA(){return j_}function Sn(t){let e=j_;return j_=t,e}function xA(t,e,n){let r=Sf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&le.Optional)return null;if(e!==void 0)return e;Rv(t,"Injector")}var rU={},uc=rU,U_="__NG_DI_FLAG__",rf="ngTempTokenPath",iU="ngTokenPath",sU=/\n/gm,oU="\u0275",LS="__source",aa;function aU(){return aa}function Si(t){let e=aa;return aa=t,e}function lU(t,e=le.Default){if(aa===void 0)throw new V(-203,!1);return aa===null?xA(t,void 0,e):aa.get(t,e&le.Optional?null:void 0,e)}function E(t,e=le.Default){return(AA()||lU)(Wt(t),e)}function A(t,e=le.Default){return E(t,Af(e))}function Af(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function B_(t){let e=[];for(let n=0;n<t.length;n++){let r=Wt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new V(900,!1);let i,s=le.Default;for(let o=0;o<r.length;o++){let a=r[o],l=cU(a);typeof l=="number"?l===-1?i=a.token:s|=l:i=a}e.push(E(i,s))}else e.push(E(r))}return e}function RA(t,e){return t[U_]=e,t.prototype[U_]=e,t}function cU(t){return t[U_]}function uU(t,e,n,r){let i=t[rf];throw e[LS]&&i.unshift(e[LS]),t.message=dU(`
`+t.message,i,n,r),t[iU]=i,t[rf]=null,t}function dU(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==oU?t.slice(2):t;let i=un(e);if(Array.isArray(e))i=e.map(un).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):un(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(sU,`
  `)}`}var _a=RA(IA("Optional"),8);var Mv=RA(IA("SkipSelf"),4);function ca(t,e){let n=t.hasOwnProperty(nf);return n?t[nf]:null}function Nv(t,e){t.forEach(n=>Array.isArray(n)?Nv(n,e):e(n))}function MA(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function sf(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function hU(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function Pv(t,e,n){let r=Ic(t,e);return r>=0?t[r|1]=n:(r=~r,hU(t,r,e,n)),r}function D_(t,e){let n=Ic(t,e);if(n>=0)return t[n|1]}function Ic(t,e){return fU(t,e,1)}function fU(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var ua={},cn=[],da=new x(""),NA=new x("",-1),PA=new x(""),of=class{get(e,n=uc){if(n===uc){let r=new Error(`NullInjectorError: No provider for ${un(e)}!`);throw r.name="NullInjectorError",r}return n}},kA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(kA||{}),hr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(hr||{}),Lt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Lt||{});function pU(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function $_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];gU(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function OA(t){return t===3||t===4||t===6}function gU(t){return t.charCodeAt(0)===64}function dc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?VS(t,n,i,null,e[++r]):VS(t,n,i,null,null))}}return t}function VS(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var FA="ng-template";function mU(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&pU(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(kv(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function kv(t){return t.type===4&&t.value!==FA}function yU(t,e,n){let r=t.type===4&&!n?FA:t.value;return e===r}function _U(t,e,n){let r=4,i=t.attrs,s=i!==null?EU(i):0,o=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!o&&!$n(r)&&!$n(l))return!1;if(o&&$n(l))continue;o=!1,r=l|r&1;continue}if(!o)if(r&4){if(r=2|r&1,l!==""&&!yU(t,l,n)||l===""&&e.length===1){if($n(r))return!1;o=!0}}else if(r&8){if(i===null||!mU(t,i,l,n)){if($n(r))return!1;o=!0}}else{let c=e[++a],u=vU(l,i,kv(t),n);if(u===-1){if($n(r))return!1;o=!0;continue}if(c!==""){let d;if(u>s?d="":d=i[u+1].toLowerCase(),r&2&&c!==d){if($n(r))return!1;o=!0}}}}return $n(r)||o}function $n(t){return(t&1)===0}function vU(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return IU(e,t)}function wU(t,e,n=!1){for(let r=0;r<e.length;r++)if(_U(t,e[r],n))return!0;return!1}function EU(t){for(let e=0;e<t.length;e++){let n=t[e];if(OA(n))return e}return t.length}function IU(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function jS(t,e){return t?":not("+e.trim()+")":e}function CU(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!$n(o)&&(e+=jS(s,i),i=""),r=o,s=s||!$n(r);n++}return i!==""&&(e+=jS(s,i)),e}function DU(t){return t.map(CU).join(",")}function TU(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!$n(i))break;i=s}r++}return{attrs:e,classes:n}}function Pi(t){return wc(()=>{let e=BA(t),n=fe(M({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===kA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||hr.Emulated,styles:t.styles||cn,_:null,schemas:t.schemas||null,tView:null,id:""});$A(n);let r=t.dependencies;return n.directiveDefs=BS(r,!1),n.pipeDefs=BS(r,!0),n.id=AU(n),n})}function bU(t){return xi(t)||LA(t)}function SU(t){return t!==null}function ke(t){return wc(()=>({type:t.type,bootstrap:t.bootstrap||cn,declarations:t.declarations||cn,imports:t.imports||cn,exports:t.exports||cn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function US(t,e){if(t==null)return ua;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Lt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Lt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function et(t){return wc(()=>{let e=BA(t);return $A(e),e})}function xi(t){return t[Xj]||null}function LA(t){return t[Zj]||null}function VA(t){return t[Jj]||null}function jA(t){let e=xi(t)||LA(t)||VA(t);return e!==null?e.standalone:!1}function UA(t,e){let n=t[eU]||null;if(!n&&e===!0)throw new Error(`Type ${un(t)} does not have '\u0275mod' property.`);return n}function BA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||ua,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||cn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:US(t.inputs,e),outputs:US(t.outputs),debugInfo:null}}function $A(t){t.features?.forEach(e=>e(t))}function BS(t,e){if(!t)return null;let n=e?VA:bU;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(SU)}function AU(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function xf(t){return{\u0275providers:t}}function xU(...t){return{\u0275providers:qA(!0,t),\u0275fromNgModule:!0}}function qA(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Nv(e,o=>{let a=o;q_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&HA(i,s),n}function HA(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];Ov(i,s=>{e(s,r)})}}function q_(t,e,n,r){if(t=Wt(t),!t)return!1;let i=null,s=kS(t),o=!s&&xi(t);if(!s&&!o){let l=t.ngModule;if(s=kS(l),s)i=l;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let l=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of l)q_(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{Nv(s.imports,u=>{q_(u,e,n,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&HA(c,e)}if(!a){let c=ca(i)||(()=>new i);e({provide:i,useFactory:c,deps:cn},i),e({provide:PA,useValue:i,multi:!0},i),e({provide:da,useValue:()=>E(i),multi:!0},i)}let l=s.providers;if(l!=null&&!a){let c=t;Ov(l,u=>{e(u,c)})}}else return!1;return i!==t&&t.providers!==void 0}function Ov(t,e){for(let n of t)SA(n)&&(n=n.\u0275providers),Array.isArray(n)?Ov(n,e):e(n)}var RU=Ae({provide:String,useValue:Ae});function zA(t){return t!==null&&typeof t=="object"&&RU in t}function MU(t){return!!(t&&t.useExisting)}function NU(t){return!!(t&&t.useFactory)}function ha(t){return typeof t=="function"}function PU(t){return!!t.useClass}var Rf=new x(""),Xh={},kU={},T_;function Fv(){return T_===void 0&&(T_=new of),T_}var Kt=class{},hc=class extends Kt{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,z_(e,o=>this.processProvider(o)),this.records.set(NA,ra(void 0,this)),i.has("environment")&&this.records.set(Kt,ra(void 0,this));let s=this.records.get(Rf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(PA,cn,le.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=we(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),we(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Si(this),r=Sn(void 0),i;try{return e()}finally{Si(n),Sn(r)}}get(e,n=uc,r=le.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(FS))return e[FS](this);r=Af(r);let i,s=Si(this),o=Sn(void 0);try{if(!(r&le.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=jU(e)&&Sf(e);c&&this.injectableDefInScope(c)?l=ra(H_(e),Xh):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=r&le.Self?Fv():this.parent;return n=r&le.Optional&&n===uc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[rf]=a[rf]||[]).unshift(un(e)),s)throw a;return uU(a,e,"R3InjectorError",this.source)}else throw a}finally{Sn(o),Si(s)}}resolveInjectorInitializers(){let e=we(null),n=Si(this),r=Sn(void 0),i;try{let s=this.get(da,cn,le.Self);for(let o of s)o()}finally{Si(n),Sn(r),we(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(un(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new V(205,!1)}processProvider(e){e=Wt(e);let n=ha(e)?e:Wt(e&&e.provide),r=FU(e);if(!ha(e)&&e.multi===!0){let i=this.records.get(n);i||(i=ra(void 0,Xh,!0),i.factory=()=>B_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=we(null);try{return n.value===Xh&&(n.value=kU,n.value=n.factory()),typeof n.value=="object"&&n.value&&VU(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{we(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Wt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function H_(t){let e=Sf(t),n=e!==null?e.factory:ca(t);if(n!==null)return n;if(t instanceof x)throw new V(204,!1);if(t instanceof Function)return OU(t);throw new V(204,!1)}function OU(t){if(t.length>0)throw new V(204,!1);let n=Qj(t);return n!==null?()=>n.factory(t):()=>new t}function FU(t){if(zA(t))return ra(void 0,t.useValue);{let e=GA(t);return ra(e,Xh)}}function GA(t,e,n){let r;if(ha(t)){let i=Wt(t);return ca(i)||H_(i)}else if(zA(t))r=()=>Wt(t.useValue);else if(NU(t))r=()=>t.useFactory(...B_(t.deps||[]));else if(MU(t))r=()=>E(Wt(t.useExisting));else{let i=Wt(t&&(t.useClass||t.provide));if(LU(t))r=()=>new i(...B_(t.deps));else return ca(i)||H_(i)}return r}function ra(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function LU(t){return!!t.deps}function VU(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function jU(t){return typeof t=="function"||typeof t=="object"&&t instanceof x}function z_(t,e){for(let n of t)Array.isArray(n)?z_(n,e):n&&SA(n)?z_(n.\u0275providers,e):e(n)}function Wn(t,e){t instanceof hc&&t.assertNotDestroyed();let n,r=Si(t),i=Sn(void 0);try{return e()}finally{Si(r),Sn(i)}}function WA(){return AA()!==void 0||aU()!=null}function UU(t){if(!WA())throw new V(-203,!1)}function BU(t){let e=Rt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function $U(t){return typeof t=="function"}var Zr=0,he=1,Q=2,Vt=3,Hn=4,Kn=5,af=6,fc=7,zn=8,fa=9,Gn=10,Je=11,pc=12,$S=13,va=14,fr=15,Mf=16,ia=17,pa=18,Nf=19,KA=20,Ai=21,b_=22,ks=23,Ri=25,QA=1;var Os=7,lf=8,cf=9,An=10,Lv=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(Lv||{});function Ns(t){return Array.isArray(t)&&typeof t[QA]=="object"}function Jr(t){return Array.isArray(t)&&t[QA]===!0}function YA(t){return(t.flags&4)!==0}function Pf(t){return t.componentOffset>-1}function Vv(t){return(t.flags&1)===1}function Mi(t){return!!t.template}function qU(t){return(t[Q]&512)!==0}var G_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function XA(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function ki(){return ZA}function ZA(t){return t.type.prototype.ngOnChanges&&(t.setInput=zU),HU}ki.ngInherit=!0;function HU(){let t=ex(this),e=t?.current;if(e){let n=t.previous;if(n===ua)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function zU(t,e,n,r,i){let s=this.declaredInputs[r],o=ex(t)||GU(t,{previous:ua,current:null}),a=o.current||(o.current={}),l=o.previous,c=l[s];a[s]=new G_(c&&c.currentValue,n,l===ua),XA(t,e,i,n)}var JA="__ngSimpleChanges__";function ex(t){return t[JA]||null}function GU(t,e){return t[JA]=e}var qS=null;var ur=function(t,e,n){qS?.(t,e,n)},WU="svg",KU="math",QU=!1;function YU(){return QU}function pr(t){for(;Array.isArray(t);)t=t[Zr];return t}function tx(t,e){return pr(e[t])}function xn(t,e){return pr(e[t.index])}function nx(t,e){return t.data[e]}function Oi(t,e){let n=e[t];return Ns(n)?n:n[Zr]}function jv(t){return(t[Q]&128)===128}function XU(t){return Jr(t[Vt])}function uf(t,e){return e==null?null:t[e]}function rx(t){t[ia]=0}function ZU(t){t[Q]&1024||(t[Q]|=1024,jv(t)&&gc(t))}function JU(t,e){for(;t>0;)e=e[va],t--;return e}function Uv(t){return!!(t[Q]&9216||t[ks]?.dirty)}function W_(t){t[Gn].changeDetectionScheduler?.notify(1),Uv(t)?gc(t):t[Q]&64&&(YU()?(t[Q]|=1024,gc(t)):t[Gn].changeDetectionScheduler?.notify())}function gc(t){t[Gn].changeDetectionScheduler?.notify();let e=mc(t);for(;e!==null&&!(e[Q]&8192||(e[Q]|=8192,!jv(e)));)e=mc(e)}function ix(t,e){if((t[Q]&256)===256)throw new V(911,!1);t[Ai]===null&&(t[Ai]=[]),t[Ai].push(e)}function eB(t,e){if(t[Ai]===null)return;let n=t[Ai].indexOf(e);n!==-1&&t[Ai].splice(n,1)}function mc(t){let e=t[Vt];return Jr(e)?e[Vt]:e}var ue={lFrame:hx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function tB(){return ue.lFrame.elementDepthCount}function nB(){ue.lFrame.elementDepthCount++}function rB(){ue.lFrame.elementDepthCount--}function sx(){return ue.bindingsEnabled}function iB(){return ue.skipHydrationRootTNode!==null}function sB(t){return ue.skipHydrationRootTNode===t}function oB(){ue.skipHydrationRootTNode=null}function be(){return ue.lFrame.lView}function Qt(){return ue.lFrame.tView}function kf(t){return ue.lFrame.contextLView=t,t[zn]}function Of(t){return ue.lFrame.contextLView=null,t}function dn(){let t=ox();for(;t!==null&&t.type===64;)t=t.parent;return t}function ox(){return ue.lFrame.currentTNode}function aB(){let t=ue.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Cc(t,e){let n=ue.lFrame;n.currentTNode=t,n.isParent=e}function ax(){return ue.lFrame.isParent}function lB(){ue.lFrame.isParent=!1}function cB(t){return ue.lFrame.bindingIndex=t}function Ff(){return ue.lFrame.bindingIndex++}function lx(t){let e=ue.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function uB(){return ue.lFrame.inI18n}function dB(t,e){let n=ue.lFrame;n.bindingIndex=n.bindingRootIndex=t,K_(e)}function hB(){return ue.lFrame.currentDirectiveIndex}function K_(t){ue.lFrame.currentDirectiveIndex=t}function fB(t){let e=ue.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function cx(t){ue.lFrame.currentQueryIndex=t}function pB(t){let e=t[he];return e.type===2?e.declTNode:e.type===1?t[Kn]:null}function ux(t,e,n){if(n&le.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&le.Host);)if(i=pB(s),i===null||(s=s[va],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=ue.lFrame=dx();return r.currentTNode=e,r.lView=t,!0}function Bv(t){let e=dx(),n=t[he];ue.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function dx(){let t=ue.lFrame,e=t===null?null:t.child;return e===null?hx(t):e}function hx(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function fx(){let t=ue.lFrame;return ue.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var px=fx;function $v(){let t=fx();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function gB(t){return(ue.lFrame.contextLView=JU(t,ue.lFrame.contextLView))[zn]}function Bs(){return ue.lFrame.selectedIndex}function Fs(t){ue.lFrame.selectedIndex=t}function Lf(){let t=ue.lFrame;return nx(t.tView,t.selectedIndex)}function mB(){return ue.lFrame.currentNamespace}var gx=!0;function qv(){return gx}function Hv(t){gx=t}function yB(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=ZA(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function zv(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),l&&(t.viewHooks??=[]).push(-n,l),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function Zh(t,e,n){mx(t,e,3,n)}function Jh(t,e,n,r){(t[Q]&3)===n&&mx(t,e,n,r)}function S_(t,e){let n=t[Q];(n&3)===e&&(n&=16383,n+=1,t[Q]=n)}function mx(t,e,n,r){let i=r!==void 0?t[ia]&65535:0,s=r??-1,o=e.length-1,a=0;for(let l=i;l<o;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(t[ia]+=65536),(a<s||s==-1)&&(_B(t,n,e,l),t[ia]=(t[ia]&4294901760)+l+2),l++}function HS(t,e){ur(4,t,e);let n=we(null);try{e.call(t)}finally{we(n),ur(5,t,e)}}function _B(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[Q]>>14<t[ia]>>16&&(t[Q]&3)===e&&(t[Q]+=16384,HS(a,s)):HS(a,s)}var la=-1,Ls=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function vB(t){return t instanceof Ls}function wB(t){return(t.flags&8)!==0}function EB(t){return(t.flags&16)!==0}function yx(t){return t!==la}function df(t){return t&32767}function IB(t){return t>>16}function hf(t,e){let n=IB(t),r=e;for(;n>0;)r=r[va],n--;return r}var Q_=!0;function zS(t){let e=Q_;return Q_=t,e}var CB=256,_x=CB-1,vx=5,DB=0,dr={};function TB(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(lc)&&(r=n[lc]),r==null&&(r=n[lc]=DB++);let i=r&_x,s=1<<i;e.data[t+(i>>vx)]|=s}function ff(t,e){let n=wx(t,e);if(n!==-1)return n;let r=e[he];r.firstCreatePass&&(t.injectorIndex=e.length,A_(r.data,t),A_(e,null),A_(r.blueprint,null));let i=Gv(t,e),s=t.injectorIndex;if(yx(i)){let o=df(i),a=hf(i,e),l=a[he].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=i,s}function A_(t,e){t.push(0,0,0,0,0,0,0,0,e)}function wx(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Gv(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=Tx(i),r===null)return la;if(n++,i=i[va],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return la}function Y_(t,e,n){TB(t,e,n)}function bB(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(OA(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function Ex(t,e,n){if(n&le.Optional||t!==void 0)return t;Rv(e,"NodeInjector")}function Ix(t,e,n,r){if(n&le.Optional&&r===void 0&&(r=null),!(n&(le.Self|le.Host))){let i=t[fa],s=Sn(void 0);try{return i?i.get(e,r,n&le.Optional):xA(e,r,n&le.Optional)}finally{Sn(s)}}return Ex(r,e,n)}function Cx(t,e,n,r=le.Default,i){if(t!==null){if(e[Q]&2048&&!(r&le.Self)){let o=MB(t,e,n,r,dr);if(o!==dr)return o}let s=Dx(t,e,n,r,dr);if(s!==dr)return s}return Ix(e,n,r,i)}function Dx(t,e,n,r,i){let s=xB(n);if(typeof s=="function"){if(!ux(e,t,r))return r&le.Host?Ex(i,n,r):Ix(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&le.Optional))Rv(n);else return o}finally{px()}}else if(typeof s=="number"){let o=null,a=wx(t,e),l=la,c=r&le.Host?e[fr][Kn]:null;for((a===-1||r&le.SkipSelf)&&(l=a===-1?Gv(t,e):e[a+8],l===la||!WS(r,!1)?a=-1:(o=e[he],a=df(l),e=hf(l,e)));a!==-1;){let u=e[he];if(GS(s,a,u.data)){let d=SB(a,e,n,o,r,c);if(d!==dr)return d}l=e[a+8],l!==la&&WS(r,e[he].data[a+8]===c)&&GS(s,a,e)?(o=u,a=df(l),e=hf(l,e)):a=-1}}return i}function SB(t,e,n,r,i,s){let o=e[he],a=o.data[t+8],l=r==null?Pf(a)&&Q_:r!=o&&(a.type&3)!==0,c=i&le.Host&&s===a,u=AB(a,o,n,l,c);return u!==null?ga(e,o,u,a):dr}function AB(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,l=t.directiveStart,c=t.directiveEnd,u=s>>20,d=r?a:a+u,h=i?a+u:c;for(let f=d;f<h;f++){let p=o[f];if(f<l&&n===p||f>=l&&p.type===n)return f}if(i){let f=o[l];if(f&&Mi(f)&&f.type===n)return l}return null}function ga(t,e,n,r){let i=t[n],s=e.data;if(vB(i)){let o=i;o.resolving&&nU(tU(s[n]));let a=zS(o.canSeeViewProviders);o.resolving=!0;let l,c=o.injectImpl?Sn(o.injectImpl):null,u=ux(t,r,le.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&yB(n,s[n],e)}finally{c!==null&&Sn(c),zS(a),o.resolving=!1,px()}}return i}function xB(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(lc)?t[lc]:void 0;return typeof e=="number"?e>=0?e&_x:RB:e}function GS(t,e,n){let r=1<<t;return!!(n[e+(t>>vx)]&r)}function WS(t,e){return!(t&le.Self)&&!(t&le.Host&&e)}var Ps=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return Cx(this._tNode,this._lView,e,Af(r),n)}};function RB(){return new Ps(dn(),be())}function ei(t){return wc(()=>{let e=t.prototype.constructor,n=e[nf]||X_(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[nf]||X_(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function X_(t){return CA(t)?()=>{let e=X_(Wt(t));return e&&e()}:ca(t)}function MB(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[Q]&2048&&!(o[Q]&512);){let a=Dx(s,o,n,r|le.Self,dr);if(a!==dr)return a;let l=s.parent;if(!l){let c=o[KA];if(c){let u=c.get(n,dr,r);if(u!==dr)return u}l=Tx(o),o=o[va]}s=l}return i}function Tx(t){let e=t[he],n=e.type;return n===2?e.declTNode:n===1?t[Kn]:null}function Wv(t){return bB(dn(),t)}function KS(t,e=null,n=null,r){let i=bx(t,e,n,r);return i.resolveInjectorInitializers(),i}function bx(t,e=null,n=null,r,i=new Set){let s=[n||cn,xU(t)];return r=r||(typeof t=="object"?void 0:un(t)),new hc(s,e||Fv(),r||null,i)}var Qn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return KS({name:""},i,r,"");{let s=r.name??"";return KS({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=uc,e.NULL=new of,e.\u0275prov=k({token:e,providedIn:"any",factory:()=>E(NA)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var NB="ngOriginalError";function x_(t){return t[NB]}var gr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&x_(e);for(;n&&x_(n);)n=x_(n);return n||null}},Sx=new x("",{providedIn:"root",factory:()=>A(gr).handleError.bind(void 0)}),Kv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=PB,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),Z_=class extends Kv{constructor(e){super(),this._lView=e}onDestroy(e){return ix(this._lView,e),()=>eB(this._lView,e)}};function PB(){return new Z_(be())}function kB(){return Vf(dn(),be())}function Vf(t,e){return new yr(xn(t,e))}var yr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=kB;let t=e;return t})();var J_=class extends Ge{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,WA()&&(this.destroyRef=A(Kv,{optional:!0})??void 0)}emit(e){let n=we(null);try{super.next(e)}finally{we(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=R_(s),i&&(i=R_(i)),o&&(o=R_(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Xe&&e.add(a),a}};function R_(t){return e=>{setTimeout(t,void 0,e)}}var at=J_;function Ax(t){return(t.flags&128)===128}var ev;function xx(t){ev=t}function Rx(){if(ev!==void 0)return ev;if(typeof document<"u")return document;throw new V(210,!1)}var jf=new x("",{providedIn:"root",factory:()=>OB}),OB="ng",Qv=new x(""),lt=new x("",{providedIn:"platform",factory:()=>"unknown"});var Yv=new x("",{providedIn:"root",factory:()=>Rx().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var FB="h",LB="b";var VB=()=>null;function Xv(t,e,n=!1){return VB(t,e,n)}var Mx=!1,jB=new x("",{providedIn:"root",factory:()=>Mx});var zh;function UB(){if(zh===void 0&&(zh=null,Rt.trustedTypes))try{zh=Rt.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return zh}function Uf(t){return UB()?.createHTML(t)||t}var Gh;function Nx(){if(Gh===void 0&&(Gh=null,Rt.trustedTypes))try{Gh=Rt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Gh}function QS(t){return Nx()?.createHTML(t)||t}function YS(t){return Nx()?.createScriptURL(t)||t}var pf=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${EA})`}};function $s(t){return t instanceof pf?t.changingThisBreaksApplicationSecurity:t}function Bf(t,e){let n=BB(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${EA})`)}return n===e}function BB(t){return t instanceof pf&&t.getTypeName()||null}function $B(t){let e=new nv(t);return qB()?new tv(e):e}var tv=class{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let n=new window.DOMParser().parseFromString(Uf(e),"text/html").body;return n===null?this.inertDocumentHelper.getInertBodyElement(e):(n.removeChild(n.firstChild),n)}catch{return null}}},nv=class{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let n=this.inertDocument.createElement("template");return n.innerHTML=Uf(e),n}};function qB(){try{return!!new window.DOMParser().parseFromString(Uf(""),"text/html")}catch{return!1}}var HB=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Zv(t){return t=String(t),t.match(HB)?t:"unsafe:"+t}function ti(t){let e={};for(let n of t.split(","))e[n]=!0;return e}function Dc(...t){let e={};for(let n of t)for(let r in n)n.hasOwnProperty(r)&&(e[r]=!0);return e}var Px=ti("area,br,col,hr,img,wbr"),kx=ti("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Ox=ti("rp,rt"),zB=Dc(Ox,kx),GB=Dc(kx,ti("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),WB=Dc(Ox,ti("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),XS=Dc(Px,GB,WB,zB),Fx=ti("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),KB=ti("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),QB=ti("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),YB=Dc(Fx,KB,QB),XB=ti("script,style,template"),rv=class{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let n=e.firstChild,r=!0,i=[];for(;n;){if(n.nodeType===Node.ELEMENT_NODE?r=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,r&&n.firstChild){i.push(n),n=e$(n);continue}for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let s=JB(n);if(s){n=s;break}n=i.pop()}}return this.buf.join("")}startElement(e){let n=ZS(e).toLowerCase();if(!XS.hasOwnProperty(n))return this.sanitizedSomething=!0,!XB.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);let r=e.attributes;for(let i=0;i<r.length;i++){let s=r.item(i),o=s.name,a=o.toLowerCase();if(!YB.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;Fx[a]&&(l=Zv(l)),this.buf.push(" ",o,'="',JS(l),'"')}return this.buf.push(">"),!0}endElement(e){let n=ZS(e).toLowerCase();XS.hasOwnProperty(n)&&!Px.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(e){this.buf.push(JS(e))}};function ZB(t,e){return(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function JB(t){let e=t.nextSibling;if(e&&t!==e.previousSibling)throw Lx(e);return e}function e$(t){let e=t.firstChild;if(e&&ZB(t,e))throw Lx(e);return e}function ZS(t){let e=t.nodeName;return typeof e=="string"?e:"FORM"}function Lx(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}var t$=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,n$=/([^\#-~ |!])/g;function JS(t){return t.replace(/&/g,"&amp;").replace(t$,function(e){let n=e.charCodeAt(0),r=e.charCodeAt(1);return"&#"+((n-55296)*1024+(r-56320)+65536)+";"}).replace(n$,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Wh;function Vx(t,e){let n=null;try{Wh=Wh||$B(t);let r=e?String(e):"";n=Wh.getInertBodyElement(r);let i=5,s=r;do{if(i===0)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=n.innerHTML,n=Wh.getInertBodyElement(r)}while(r!==s);let a=new rv().sanitizeChildren(eA(n)||n);return Uf(a)}finally{if(n){let r=eA(n)||n;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function eA(t){return"content"in t&&r$(t)?t.content:null}function r$(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName==="TEMPLATE"}var Tc=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Tc||{});function jx(t){let e=ew();return e?QS(e.sanitize(Tc.HTML,t)||""):Bf(t,"HTML")?QS($s(t)):Vx(Rx(),Ec(t))}function Jv(t){let e=ew();return e?e.sanitize(Tc.URL,t)||"":Bf(t,"URL")?$s(t):Zv(Ec(t))}function i$(t){let e=ew();if(e)return YS(e.sanitize(Tc.RESOURCE_URL,t)||"");if(Bf(t,"ResourceURL"))return YS($s(t));throw new V(904,!1)}function s$(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?i$:Jv}function Ux(t,e,n){return s$(e,n)(t)}function ew(){let t=be();return t&&t[Gn].sanitizer}var Bx=new Map,o$=0;function a$(){return o$++}function l$(t){Bx.set(t[Nf],t)}function c$(t){Bx.delete(t[Nf])}var tA="__ngContext__";function Vs(t,e){Ns(e)?(t[tA]=e[Nf],l$(e)):t[tA]=e}function $x(t){return t instanceof Function?t():t}function u$(t){return(t??A(Qn)).get(lt)==="browser"}var Yr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Yr||{}),d$;function tw(t,e){return d$(t,e)}function sa(t,e,n,r,i){if(r!=null){let s,o=!1;Jr(r)?s=r:Ns(r)&&(o=!0,r=r[Zr]);let a=pr(r);t===0&&n!==null?i==null?Wx(e,n,a):gf(e,n,a,i||null,!0):t===1&&n!==null?gf(e,n,a,i||null,!0):t===2?A$(e,a,o):t===3&&e.destroyNode(a),s!=null&&R$(e,t,s,n,i)}}function h$(t,e){return t.createText(e)}function f$(t,e,n){t.setValue(e,n)}function qx(t,e,n){return t.createElement(e,n)}function p$(t,e){Hx(t,e),e[Zr]=null,e[Kn]=null}function g$(t,e,n,r,i,s){r[Zr]=i,r[Kn]=e,$f(t,r,n,1,i,s)}function Hx(t,e){e[Gn].changeDetectionScheduler?.notify(1),$f(t,e,e[Je],2,null,null)}function m$(t){let e=t[pc];if(!e)return M_(t[he],t);for(;e;){let n=null;if(Ns(e))n=e[pc];else{let r=e[An];r&&(n=r)}if(!n){for(;e&&!e[Hn]&&e!==t;)Ns(e)&&M_(e[he],e),e=e[Vt];e===null&&(e=t),Ns(e)&&M_(e[he],e),n=e&&e[Hn]}e=n}}function y$(t,e,n,r){let i=An+r,s=n.length;r>0&&(n[i-1][Hn]=e),r<s-An?(e[Hn]=n[i],MA(n,An+r,e)):(n.push(e),e[Hn]=null),e[Vt]=n;let o=e[Mf];o!==null&&n!==o&&_$(o,e);let a=e[pa];a!==null&&a.insertView(t),W_(e),e[Q]|=128}function _$(t,e){let n=t[cf],i=e[Vt][Vt][fr];e[fr]!==i&&(t[Q]|=Lv.HasTransplantedViews),n===null?t[cf]=[e]:n.push(e)}function zx(t,e){let n=t[cf],r=n.indexOf(e);n.splice(r,1)}function iv(t,e){if(t.length<=An)return;let n=An+e,r=t[n];if(r){let i=r[Mf];i!==null&&i!==t&&zx(i,r),e>0&&(t[n-1][Hn]=r[Hn]);let s=sf(t,An+e);p$(r[he],r);let o=s[pa];o!==null&&o.detachView(s[he]),r[Vt]=null,r[Hn]=null,r[Q]&=-129}return r}function Gx(t,e){if(!(e[Q]&256)){let n=e[Je];n.destroyNode&&$f(t,e,n,3,null,null),m$(e)}}function M_(t,e){if(e[Q]&256)return;let n=we(null);try{e[Q]&=-129,e[Q]|=256,e[ks]&&dS(e[ks]),w$(t,e),v$(t,e),e[he].type===1&&e[Je].destroy();let r=e[Mf];if(r!==null&&Jr(e[Vt])){r!==e[Vt]&&zx(r,e);let i=e[pa];i!==null&&i.detachView(t)}c$(e)}finally{we(n)}}function v$(t,e){let n=t.cleanup,r=e[fc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[fc]=null);let i=e[Ai];if(i!==null){e[Ai]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function w$(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Ls)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],l=s[o+1];ur(4,a,l);try{l.call(a)}finally{ur(5,a,l)}}else{ur(4,i,s);try{s.call(i)}finally{ur(5,i,s)}}}}}function E$(t,e,n){return I$(t,e.parent,n)}function I$(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Zr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===hr.None||s===hr.Emulated)return null}return xn(r,n)}}function gf(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Wx(t,e,n){t.appendChild(e,n)}function nA(t,e,n,r,i){r!==null?gf(t,e,n,r,i):Wx(t,e,n)}function C$(t,e,n,r){t.removeChild(e,n,r)}function nw(t,e){return t.parentNode(e)}function D$(t,e){return t.nextSibling(e)}function T$(t,e,n){return S$(t,e,n)}function b$(t,e,n){return t.type&40?xn(t,n):null}var S$=b$,rA;function rw(t,e,n,r){let i=E$(t,r,e),s=e[Je],o=r.parent||e[Kn],a=T$(o,r,e);if(i!=null)if(Array.isArray(n))for(let l=0;l<n.length;l++)nA(s,i,n[l],a,!1);else nA(s,i,n,a,!1);rA!==void 0&&rA(s,r,e,n,i)}function ef(t,e){if(e!==null){let n=e.type;if(n&3)return xn(e,t);if(n&4)return sv(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return ef(t,r);{let i=t[e.index];return Jr(i)?sv(-1,i):pr(i)}}else{if(n&32)return tw(e,t)()||pr(t[e.index]);{let r=Kx(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=mc(t[fr]);return ef(i,r)}else return ef(t,e.next)}}}return null}function Kx(t,e){if(e!==null){let r=t[fr][Kn],i=e.projection;return r.projection[i]}return null}function sv(t,e){let n=An+t+1;if(n<e.length){let r=e[n],i=r[he].firstChild;if(i!==null)return ef(r,i)}return e[Os]}function A$(t,e,n){let r=nw(t,e);r&&C$(t,r,e,n)}function iw(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],l=n.type;if(o&&e===0&&(a&&Vs(pr(a),r),n.flags|=2),(n.flags&32)!==32)if(l&8)iw(t,e,n.child,r,i,s,!1),sa(e,t,i,a,s);else if(l&32){let c=tw(n,r),u;for(;u=c();)sa(e,t,i,u,s);sa(e,t,i,a,s)}else l&16?x$(t,e,r,n,i,s):sa(e,t,i,a,s);n=o?n.projectionNext:n.next}}function $f(t,e,n,r,i,s){iw(n,r,t.firstChild,e,i,s,!1)}function x$(t,e,n,r,i,s){let o=n[fr],l=o[Kn].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];sa(e,t,i,u,s)}else{let c=l,u=o[Vt];Ax(r)&&(c.flags|=128),iw(t,e,c,u,i,s,!0)}}function R$(t,e,n,r,i){let s=n[Os],o=pr(n);s!==o&&sa(e,t,r,s,i);for(let a=An;a<n.length;a++){let l=n[a];$f(l[he],l,t,e,r,s)}}function M$(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Yr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Yr.Important),t.setStyle(n,r,i,s))}}function N$(t,e,n){t.setAttribute(e,"style",n)}function Qx(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function Yx(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&$_(t,e,r),i!==null&&Qx(t,e,i),s!==null&&N$(t,e,s)}var ni={};function $e(t=1){Xx(Qt(),be(),Bs()+t,!1)}function Xx(t,e,n,r){if(!r)if((e[Q]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Zh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Jh(e,s,0,n)}Fs(n)}function se(t,e=le.Default){let n=be();if(n===null)return E(t,e);let r=dn();return Cx(r,n,Wt(t),e)}function Zx(){let t="invalid";throw new Error(t)}function Jx(t,e,n,r,i,s){let o=we(null);try{let a=null;i&Lt.SignalBased&&(a=e[r][e_]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Lt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):XA(e,a,r,s)}finally{we(o)}}function P$(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Fs(~i);else{let s=i,o=n[++r],a=n[++r];dB(o,s);let l=e[s];a(2,l)}}}finally{Fs(-1)}}function qf(t,e,n,r,i,s,o,a,l,c,u){let d=e.blueprint.slice();return d[Zr]=i,d[Q]=r|4|128|8|64,(c!==null||t&&t[Q]&2048)&&(d[Q]|=2048),rx(d),d[Vt]=d[va]=t,d[zn]=n,d[Gn]=o||t&&t[Gn],d[Je]=a||t&&t[Je],d[fa]=l||t&&t[fa]||null,d[Kn]=s,d[Nf]=a$(),d[af]=u,d[KA]=c,d[fr]=e.type==2?t[fr]:d,d}function Hf(t,e,n,r,i){let s=t.data[e];if(s===null)s=k$(t,e,n,r,i),uB()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=aB();s.injectorIndex=o===null?-1:o.injectorIndex}return Cc(s,!0),s}function k$(t,e,n,r,i){let s=ox(),o=ax(),a=o?s:s&&s.parent,l=t.data[e]=j$(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=l),s!==null&&(o?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function eR(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function tR(t,e,n,r,i){let s=Bs(),o=r&2;try{Fs(-1),o&&e.length>Ri&&Xx(t,e,Ri,!1),ur(o?2:0,i),n(r,i)}finally{Fs(s),ur(o?3:1,i)}}function nR(t,e,n){if(YA(e)){let r=we(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let l=n[o];a.contentQueries(1,l,o)}}}finally{we(r)}}}function rR(t,e,n){sx()&&(z$(t,e,n,xn(n,e)),(n.flags&64)===64&&lR(t,e,n))}function iR(t,e,n=xn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function sR(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=sw(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function sw(t,e,n,r,i,s,o,a,l,c,u){let d=Ri+r,h=d+i,f=O$(d,h),p=typeof c=="function"?c():c;return f[he]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}function O$(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:ni);return n}function F$(t,e,n,r){let s=r.get(jB,Mx)||n===hr.ShadowDom,o=t.selectRootElement(e,s);return L$(o),o}function L$(t){V$(t)}var V$=()=>null;function j$(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return iB()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function iA(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,l=Lt.None;Array.isArray(o)?(a=o[0],l=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?sA(r,n,c,a,l):sA(r,n,c,a)}return r}function sA(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function U$(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],l=null,c=null;for(let u=r;u<i;u++){let d=s[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;l=iA(0,d.inputs,u,l,f),c=iA(1,d.outputs,u,c,p);let g=l!==null&&o!==null&&!kv(e)?n4(l,u,o):null;a.push(g)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function B$(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function ow(t,e,n,r,i,s,o,a){let l=xn(e,n),c=e.inputs,u;!a&&c!=null&&(u=c[r])?(aw(t,n,u,r,i),Pf(e)&&$$(n,e.index)):e.type&3?(r=B$(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(l,r,i)):e.type&12}function $$(t,e){let n=Oi(e,t);n[Q]&16||(n[Q]|=64)}function oR(t,e,n,r){if(sx()){let i=r===null?null:{"":-1},s=W$(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&aR(t,e,n,o,i,a),i&&K$(n,r,i)}n.mergedAttrs=dc(n.mergedAttrs,n.attrs)}function aR(t,e,n,r,i,s){for(let c=0;c<r.length;c++)Y_(ff(n,e),t,r[c].type);Y$(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let u=r[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=eR(t,e,r.length,null);for(let c=0;c<r.length;c++){let u=r[c];n.mergedAttrs=dc(n.mergedAttrs,u.hostAttrs),X$(t,n,e,l,u),Q$(l,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),l++}U$(t,n,s)}function q$(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;H$(o)!=a&&o.push(a),o.push(n,r,s)}}function H$(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function z$(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Pf(n)&&Z$(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||ff(n,e),Vs(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let l=t.data[a],c=ga(e,t,a,n);if(Vs(c,e),o!==null&&t4(e,a-i,c,l,n,o),Mi(l)){let u=Oi(n.index,e);u[zn]=ga(e,t,a,n)}}}function lR(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=hB();try{Fs(s);for(let a=r;a<i;a++){let l=t.data[a],c=e[a];K_(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&G$(l,c)}}finally{Fs(-1),K_(o)}}function G$(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function W$(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(wU(e,o.selectors,!1))if(r||(r=[]),Mi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let l=a.length;ov(t,e,l)}else r.unshift(o),ov(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function ov(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function K$(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new V(-301,!1);r.push(e[i],s)}}}function Q$(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Mi(e)&&(n[""]=t)}}function Y$(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function X$(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=ca(i.type,!0)),o=new Ls(s,Mi(i),se);t.blueprint[r]=o,n[r]=o,q$(t,e,r,eR(t,n,i.hostVars,ni),i)}function Z$(t,e,n){let r=xn(e,t),i=sR(n),s=t[Gn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=zf(t,qf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function J$(t,e,n,r,i,s){let o=xn(t,e);e4(e[Je],o,s,t.value,n,r,i)}function e4(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?Ec(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function t4(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let l=o[a++],c=o[a++],u=o[a++],d=o[a++];Jx(r,n,l,c,u,d)}}function n4(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function cR(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function uR(t,e){let n=t.contentQueries;if(n!==null){let r=we(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];cx(s),a.contentQueries(2,e[o],o)}}}finally{we(r)}}}function zf(t,e){return t[pc]?t[$S][Hn]=e:t[pc]=e,t[$S]=e,e}function av(t,e,n){cx(0);let r=we(null);try{e(t,n)}finally{we(r)}}function r4(t){return t[fc]||(t[fc]=[])}function i4(t){return t.cleanup||(t.cleanup=[])}function dR(t,e){let n=t[fa],r=n?n.get(gr,null):null;r&&r.handleError(e)}function aw(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],l=n[s++],c=e[o],u=t.data[o];Jx(u,c,r,a,l,i)}}function s4(t,e,n){let r=tx(e,t);f$(t[Je],r,n)}function o4(t,e){let n=Oi(e,t),r=n[he];a4(r,n);let i=n[Zr];i!==null&&n[af]===null&&(n[af]=Xv(i,n[fa])),lw(r,n,n[zn])}function a4(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function lw(t,e,n){Bv(e);try{let r=t.viewQuery;r!==null&&av(1,r,n);let i=t.template;i!==null&&tR(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[pa]?.finishViewCreation(t),t.staticContentQueries&&uR(t,e),t.staticViewQueries&&av(2,t.viewQuery,n);let s=t.components;s!==null&&l4(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[Q]&=-5,$v()}}function l4(t,e){for(let n=0;n<e.length;n++)o4(t,e[n])}function c4(t,e,n,r){let i=we(null);try{let s=e.tView,a=t[Q]&4096?4096:16,l=qf(t,s,n,a,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),c=t[e.index];l[Mf]=c;let u=t[pa];return u!==null&&(l[pa]=u.createEmbeddedView(s)),lw(s,l,n),l}finally{we(i)}}function oA(t,e){return!e||e.firstChild===null||Ax(t)}function u4(t,e,n,r=!0){let i=e[he];if(y$(i,e,t,n),r){let o=sv(n,t),a=e[Je],l=nw(a,t[Os]);l!==null&&g$(i,t[Kn],a,e,l,o)}let s=e[af];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function mf(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(pr(s)),Jr(s)&&d4(s,r);let o=n.type;if(o&8)mf(t,e,n.child,r);else if(o&32){let a=tw(n,e),l;for(;l=a();)r.push(l)}else if(o&16){let a=Kx(e,n);if(Array.isArray(a))r.push(...a);else{let l=mc(e[fr]);mf(l[he],l,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function d4(t,e){for(let n=An;n<t.length;n++){let r=t[n],i=r[he].firstChild;i!==null&&mf(r[he],r,i,e)}t[Os]!==t[Zr]&&e.push(t[Os])}var hR=[];function h4(t){return t[ks]??f4(t)}function f4(t){let e=hR.pop()??Object.create(g4);return e.lView=t,e}function p4(t){t.lView[ks]!==t&&(t.lView=null,hR.push(t))}var g4=fe(M({},lS),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{gc(t.lView)},consumerOnSignalRead(){this.lView[ks]=this}});function fR(t){return gR(t[pc])}function pR(t){return gR(t[Hn])}function gR(t){for(;t!==null&&!Jr(t);)t=t[Hn];return t}var mR=100;function yR(t,e=!0,n=0){let r=t[Gn],i=r.rendererFactory,s=!1;s||i.begin?.();try{m4(t,n)}catch(o){throw e&&dR(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function m4(t,e){lv(t,e);let n=0;for(;Uv(t);){if(n===mR)throw new V(103,!1);n++,lv(t,1)}}function y4(t,e,n,r){let i=e[Q];if((i&256)===256)return;let s=!1;!s&&e[Gn].inlineEffectRunner?.flush(),Bv(e);let o=null,a=null;!s&&_4(t)&&(a=h4(e),o=cS(a));try{rx(e),cB(t.bindingStartIndex),n!==null&&tR(t,e,n,2,r);let l=(i&3)===3;if(!s)if(l){let d=t.preOrderCheckHooks;d!==null&&Zh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Jh(e,d,0,null),S_(e,0)}if(v4(e),_R(e,0),t.contentQueries!==null&&uR(t,e),!s)if(l){let d=t.contentCheckHooks;d!==null&&Zh(e,d)}else{let d=t.contentHooks;d!==null&&Jh(e,d,1),S_(e,1)}P$(t,e);let c=t.components;c!==null&&wR(e,c,0);let u=t.viewQuery;if(u!==null&&av(2,u,r),!s)if(l){let d=t.viewCheckHooks;d!==null&&Zh(e,d)}else{let d=t.viewHooks;d!==null&&Jh(e,d,2),S_(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[b_]){for(let d of e[b_])d();e[b_]=null}s||(e[Q]&=-73)}catch(l){throw gc(e),l}finally{a!==null&&(uS(a,o),p4(a)),$v()}}function _4(t){return t.type!==2}function _R(t,e){for(let n=fR(t);n!==null;n=pR(n))for(let r=An;r<n.length;r++){let i=n[r];vR(i,e)}}function v4(t){for(let e=fR(t);e!==null;e=pR(e)){if(!(e[Q]&Lv.HasTransplantedViews))continue;let n=e[cf];for(let r=0;r<n.length;r++){let i=n[r],s=i[Vt];ZU(i)}}}function w4(t,e,n){let r=Oi(e,t);vR(r,n)}function vR(t,e){jv(t)&&lv(t,e)}function lv(t,e){let r=t[he],i=t[Q],s=t[ks],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&t_(s)),s&&(s.dirty=!1),t[Q]&=-9217,o)y4(r,t,r.template,t[zn]);else if(i&8192){_R(t,1);let a=r.components;a!==null&&wR(t,a,1)}}function wR(t,e,n){for(let r=0;r<e.length;r++)w4(t,e[r],n)}function cw(t){for(t[Gn].changeDetectionScheduler?.notify();t;){t[Q]|=64;let e=mc(t);if(qU(t)&&!e)return t;t=e}return null}var js=class{get rootNodes(){let e=this._lView,n=e[he];return mf(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[zn]}set context(e){this._lView[zn]=e}get destroyed(){return(this._lView[Q]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Vt];if(Jr(e)){let n=e[lf],r=n?n.indexOf(this):-1;r>-1&&(iv(e,r),sf(n,r))}this._attachedToViewContainer=!1}Gx(this._lView[he],this._lView)}onDestroy(e){ix(this._lView,e)}markForCheck(){cw(this._cdRefInjectingView||this._lView)}detach(){this._lView[Q]&=-129}reattach(){W_(this._lView),this._lView[Q]|=128}detectChanges(){this._lView[Q]|=1024,yR(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new V(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,Hx(this._lView[he],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new V(902,!1);this._appRef=e,W_(this._lView)}},uw=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=C4;let t=e;return t})(),E4=uw,I4=class extends E4{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=c4(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new js(i)}};function C4(){return D4(dn(),be())}function D4(t,e){return t.type&4?new I4(e,t,Vf(t,e)):null}var Lre=new RegExp(`^(\\d+)*(${LB}|${FB})*(.*)`);var T4=()=>null;function aA(t,e){return T4(t,e)}var yf=class{},cv=class{},_f=class{};function b4(t){let e=Error(`No component factory found for ${un(t)}.`);return e[S4]=t,e}var S4="ngComponent";var uv=class{resolveComponentFactory(e){throw b4(e)}},Gf=(()=>{let e=class e{};e.NULL=new uv;let t=e;return t})(),yc=class{},ri=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>A4();let t=e;return t})();function A4(){let t=be(),e=dn(),n=Oi(e.index,t);return(Ns(n)?n:t)[Je]}var x4=(()=>{let e=class e{};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),N_={};var lA=new Set;function Wf(t){lA.has(t)||(lA.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function cA(...t){}function R4(){let t=typeof Rt.requestAnimationFrame=="function",e=Rt[t?"requestAnimationFrame":"setTimeout"],n=Rt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var ie=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new at(!1),this.onMicrotaskEmpty=new at(!1),this.onStable=new at(!1),this.onError=new at(!1),typeof Zone>"u")throw new V(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=R4().nativeRequestAnimationFrame,P4(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new V(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new V(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,M4,cA,cA);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},M4={};function dw(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function N4(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Rt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,dv(t),t.isCheckStableRunning=!0,dw(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),dv(t))}function P4(t){let e=()=>{N4(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(k4(a))return n.invokeTask(i,s,o,a);try{return uA(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),dA(t)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return uA(t),n.invoke(i,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),dA(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,dv(t),dw(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function dv(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function uA(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function dA(t){t._nesting--,dw(t)}var hv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new at,this.onMicrotaskEmpty=new at,this.onStable=new at,this.onError=new at}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function k4(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function O4(t="zone.js",e){return t==="noop"?new hv:t==="zone.js"?new ie(e):t}var oa=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(oa||{}),F4={destroy(){}};function hw(t,e){!e&&UU(hw);let n=e?.injector??A(Qn);if(!u$(n))return F4;Wf("NgAfterNextRender");let r=n.get(fw),i=r.handler??=new pv,s=e?.phase??oa.MixedReadWrite,o=()=>{i.unregister(l),a()},a=n.get(Kv).onDestroy(o),l=Wn(n,()=>new fv(s,()=>{o(),t()}));return i.register(l),{destroy:o}}var fv=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=A(ie),this.errorHandler=A(gr,{optional:!0}),A(yf,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},pv=class{constructor(){this.executingCallbacks=!1,this.buckets={[oa.EarlyRead]:new Set,[oa.Write]:new Set,[oa.MixedReadWrite]:new Set,[oa.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},fw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function gv(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=V_(i,a);else if(s==2){let l=a,c=e[++o];r=V_(r,l+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var vf=class extends Gf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=xi(e);return new ma(n,this.ngModule)}};function hA(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function L4(t){let e=t.toLowerCase();return e==="svg"?WU:e==="math"?KU:null}var mv=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Af(r);let i=this.injector.get(e,N_,r);return i!==N_||n===N_?i:this.parentInjector.get(e,n,r)}},ma=class extends _f{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=hA(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return hA(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=DU(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=we(null);try{i=i||this.ngModule;let o=i instanceof Kt?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new mv(e,o):e,l=a.get(yc,null);if(l===null)throw new V(407,!1);let c=a.get(x4,null),u=a.get(fw,null),d=a.get(yf,null),h={rendererFactory:l,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:d},f=l.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?F$(f,r,this.componentDef.encapsulation,a):qx(f,p,L4(p)),m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let w=null;g!==null&&(w=Xv(g,a,!0));let S=sw(0,null,null,1,0,null,null,null,null,null,null),C=qf(null,S,null,m,null,null,h,f,a,null,w);Bv(C);let b,B;try{let H=this.componentDef,ye,it=null;H.findHostDirectiveDefs?(ye=[],it=new Map,H.findHostDirectiveDefs(H,ye,it),ye.push(H)):ye=[H];let bs=V4(C,g),ch=j4(bs,g,H,ye,C,h,f);B=nx(S,Ri),g&&$4(f,H,g,r),n!==void 0&&q4(B,this.ngContentSelectors,n),b=B4(ch,H,ye,it,C,[H4]),lw(S,C,null)}finally{$v()}return new yv(this.componentType,b,Vf(B,C),C,B)}finally{we(s)}}},yv=class extends cv{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new js(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;aw(s[he],s,i,e,n),this.previousInputValues.set(e,n);let o=Oi(this._tNode.index,s);cw(o)}}get injector(){return new Ps(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function V4(t,e){let n=t[he],r=Ri;return t[r]=e,Hf(n,r,2,"#host",null)}function j4(t,e,n,r,i,s,o){let a=i[he];U4(r,t,e,o);let l=null;e!==null&&(l=Xv(e,i[fa]));let c=s.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let d=qf(i,sR(n),null,u,i[t.index],t,s,c,null,null,l);return a.firstCreatePass&&ov(a,t,r.length-1),zf(i,d),i[t.index]=d}function U4(t,e,n,r){for(let i of t)e.mergedAttrs=dc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(gv(e,e.mergedAttrs,!0),n!==null&&Yx(r,n,e))}function B4(t,e,n,r,i,s){let o=dn(),a=i[he],l=xn(o,i);aR(a,i,o,n,null,r);for(let u=0;u<n.length;u++){let d=o.directiveStart+u,h=ga(i,a,d,o);Vs(h,i)}lR(a,i,o),l&&Vs(l,i);let c=ga(i,a,o.directiveStart+o.componentOffset,o);if(t[zn]=i[zn]=c,s!==null)for(let u of s)u(c,e);return nR(a,o,i),c}function $4(t,e,n,r){if(r)$_(t,n,["ng-version","17.3.0"]);else{let{attrs:i,classes:s}=TU(e.selectors[0]);i&&$_(t,n,i),s&&s.length>0&&Qx(t,n,s.join(" "))}}function q4(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function H4(){let t=dn();zv(be()[he],t)}var bc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=z4;let t=e;return t})();function z4(){let t=dn();return W4(t,be())}var G4=bc,ER=class extends G4{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Vf(this._hostTNode,this._hostLView)}get injector(){return new Ps(this._hostTNode,this._hostLView)}get parentInjector(){let e=Gv(this._hostTNode,this._hostLView);if(yx(e)){let n=hf(e,this._hostLView),r=df(e),i=n[he].data[r+8];return new Ps(i,n)}else return new Ps(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=fA(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-An}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=aA(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,oA(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!$U(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let l=o?e:new ma(xi(e)),c=r||this.parentInjector;if(!s&&l.ngModule==null){let g=(o?c:this.parentInjector).get(Kt,null);g&&(s=g)}let u=xi(l.componentType??{}),d=aA(this._lContainer,u?.id??null),h=d?.firstChild??null,f=l.create(c,i,h,s);return this.insertImpl(f.hostView,a,oA(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(XU(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=i[Vt],c=new ER(l,l[Kn],l[Vt]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return u4(o,i,s,r),e.attachToViewContainerRef(),MA(P_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=fA(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=iv(this._lContainer,n);r&&(sf(P_(this._lContainer),n),Gx(r[he],r))}detach(e){let n=this._adjustIndex(e,-1),r=iv(this._lContainer,n);return r&&sf(P_(this._lContainer),n)!=null?new js(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function fA(t){return t[lf]}function P_(t){return t[lf]||(t[lf]=[])}function W4(t,e){let n,r=e[t.index];return Jr(r)?n=r:(n=cR(r,e,null,t),e[t.index]=n,zf(e,n)),Q4(n,e,t,r),new ER(n,t,e)}function K4(t,e){let n=t[Je],r=n.createComment(""),i=xn(e,t),s=nw(n,i);return gf(n,s,r,D$(n,i),!1),r}var Q4=Z4,Y4=()=>!1;function X4(t,e,n){return Y4(t,e,n)}function Z4(t,e,n,r){if(t[Os])return;let i;n.type&8?i=pr(r):i=K4(e,n),t[Os]=i}function J4(t){return typeof t=="function"&&t[e_]!==void 0}function IR(t){return J4(t)&&typeof t.set=="function"}function eq(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(iq))}return s}return wf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[c+h]=f,u.splice(u.indexOf(d),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let l=Promise.all(o).then(()=>sq(s));e.push(l)}),nq(),Promise.all(e).then(()=>{})}var wf=new Map,tq=new Set;function nq(){let t=wf;return wf=new Map,t}function rq(){return wf.size===0}function iq(t){return typeof t=="string"?t:t.text()}function sq(t){tq.delete(t)}function oq(t){return Object.getPrototypeOf(t.prototype).constructor}function Rn(t){let e=oq(t.type),n=!0,r=[t];for(;e;){let i;if(Mi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new V(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Kh(t.inputs),o.inputTransforms=Kh(t.inputTransforms),o.declaredInputs=Kh(t.declaredInputs),o.outputs=Kh(t.outputs);let a=i.hostBindings;a&&dq(t,a);let l=i.viewQuery,c=i.contentQueries;if(l&&cq(t,l),c&&uq(t,c),aq(t,i),Wj(t.outputs,i.outputs),Mi(i)&&i.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Rn&&(n=!1)}}e=Object.getPrototypeOf(e)}lq(r)}function aq(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function lq(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=dc(i.hostAttrs,n=dc(n,i.hostAttrs))}}function Kh(t){return t===ua?{}:t===cn?[]:t}function cq(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function uq(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function dq(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function pw(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var Ni=class{},_c=class{};var Ef=class extends Ni{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vf(this);let i=UA(e);this._bootstrapComponents=$x(i.bootstrap),this._r3Injector=bx(e,n,[{provide:Ni,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver},...r],un(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},If=class extends _c{constructor(e){super(),this.moduleType=e}create(e){return new Ef(this.moduleType,e,[])}};function hq(t,e,n){return new Ef(t,e,n)}var _v=class extends Ni{constructor(e){super(),this.componentFactoryResolver=new vf(this),this.instance=null;let n=new hc([...e.providers,{provide:Ni,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver}],e.parent||Fv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Kf(t,e,n=null){return new _v({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var qs=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new xt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function CR(t){return pq(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function fq(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function pq(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function wa(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function gq(t){return(t.flags&32)===32}function mq(t,e,n,r,i,s,o,a,l){let c=e.consts,u=Hf(e,t,4,o||null,uf(c,a));oR(e,n,u,uf(c,l)),zv(e,u);let d=u.tView=sw(2,u,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function Qf(t,e,n,r,i,s,o,a){let l=be(),c=Qt(),u=t+Ri,d=c.firstCreatePass?mq(u,c,l,e,n,r,i,s,o):c.data[u];Cc(d,!1);let h=yq(c,l,d,t);qv()&&rw(c,l,h,d),Vs(h,l);let f=cR(h,l,h,d);return l[u]=f,zf(l,f),X4(f,d,l),Vv(d)&&rR(c,l,d),o!=null&&iR(l,d,a),Qf}var yq=_q;function _q(t,e,n,r){return Hv(!0),e[Je].createComment("")}function Sc(t,e,n,r){let i=be(),s=Ff();if(wa(i,s,e)){let o=Qt(),a=Lf();J$(a,i,t,e,n,r)}return Sc}function gw(t,e,n,r){return wa(t,Ff(),n)?e+Ec(n)+r:ni}function Qh(t,e){return t<<17|e<<2}function Us(t){return t>>17&32767}function vq(t){return(t&2)==2}function wq(t,e){return t&131071|e<<17}function vv(t){return t|2}function ya(t){return(t&131068)>>2}function k_(t,e){return t&-131069|e<<2}function Eq(t){return(t&1)===1}function wv(t){return t|1}function Iq(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Us(o),l=ya(o);t[r]=n;let c=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||Ic(d,u)>0)&&(c=!0)}else u=n;if(i)if(l!==0){let h=Us(t[a+1]);t[r+1]=Qh(h,a),h!==0&&(t[h+1]=k_(t[h+1],r)),t[a+1]=wq(t[a+1],r)}else t[r+1]=Qh(a,0),a!==0&&(t[a+1]=k_(t[a+1],r)),a=r;else t[r+1]=Qh(l,0),a===0?a=r:t[l+1]=k_(t[l+1],r),l=r;c&&(t[r+1]=vv(t[r+1])),pA(t,u,r,!0),pA(t,u,r,!1),Cq(e,u,t,r,s),o=Qh(a,l),s?e.classBindings=o:e.styleBindings=o}function Cq(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Ic(s,e)>=0&&(n[r+1]=wv(n[r+1]))}function pA(t,e,n,r){let i=t[n+1],s=e===null,o=r?Us(i):ya(i),a=!1;for(;o!==0&&(a===!1||s);){let l=t[o],c=t[o+1];Dq(l,e)&&(a=!0,t[o+1]=r?wv(c):vv(c)),o=r?Us(c):ya(c)}a&&(t[n+1]=r?vv(i):wv(i))}function Dq(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Ic(t,e)>=0:!1}var qn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Tq(t){return t.substring(qn.key,qn.keyEnd)}function bq(t){return Sq(t),DR(t,TR(t,0,qn.textEnd))}function DR(t,e){let n=qn.textEnd;return n===e?-1:(e=qn.keyEnd=Aq(t,qn.key=e,n),TR(t,e,n))}function Sq(t){qn.key=0,qn.keyEnd=0,qn.value=0,qn.valueEnd=0,qn.textEnd=t.length}function TR(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function Aq(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}function Ea(t,e,n){let r=be(),i=Ff();if(wa(r,i,e)){let s=Qt(),o=Lf();ow(s,o,r,t,e,r[Je],n,!1)}return Ea}function Ev(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";aw(t,n,s[o],o,r)}function Yf(t,e){return Rq(t,e,null,!0),Yf}function xq(t,e){for(let n=bq(e);n>=0;n=DR(e,n))Pv(t,Tq(e),!0)}function Rq(t,e,n,r){let i=be(),s=Qt(),o=lx(2);if(s.firstUpdatePass&&SR(s,t,o,r),e!==ni&&wa(i,o,e)){let a=s.data[Bs()];AR(s,a,i,i[Je],t,i[o+1]=Vq(e,n),r,o)}}function Mq(t,e,n,r){let i=Qt(),s=lx(2);i.firstUpdatePass&&SR(i,null,s,r);let o=be();if(n!==ni&&wa(o,s,n)){let a=i.data[Bs()];if(xR(a,r)&&!bR(i,s)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(n=V_(l,n||"")),Ev(i,a,o,n,r)}else Lq(i,a,o,o[Je],o[s+1],o[s+1]=Fq(t,e,n),r,s)}}function bR(t,e){return e>=t.expandoStartIndex}function SR(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Bs()],o=bR(t,n);xR(s,r)&&e===null&&!o&&(e=!1),e=Nq(i,s,e,r),Iq(i,s,e,n,o,r)}}function Nq(t,e,n,r){let i=fB(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=O_(null,t,e,n,r),n=vc(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=O_(i,t,e,n,r),s===null){let l=Pq(t,e,r);l!==void 0&&Array.isArray(l)&&(l=O_(null,t,e,l[1],r),l=vc(l,e.attrs,r),kq(t,e,r,l))}else s=Oq(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function Pq(t,e,n){let r=n?e.classBindings:e.styleBindings;if(ya(r)!==0)return t[Us(r)]}function kq(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Us(i)]=r}function Oq(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=vc(r,o,n)}return vc(r,e.attrs,n)}function O_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=vc(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function vc(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),Pv(t,o,n?!0:e[++s]))}return t===void 0?null:t}function Fq(t,e,n){if(n==null||n==="")return cn;let r=[],i=$s(n);if(Array.isArray(i))for(let s=0;s<i.length;s++)t(r,i[s],!0);else if(typeof i=="object")for(let s in i)i.hasOwnProperty(s)&&t(r,s,i[s]);else typeof i=="string"&&e(r,i);return r}function Lq(t,e,n,r,i,s,o,a){i===ni&&(i=cn);let l=0,c=0,u=0<i.length?i[0]:null,d=0<s.length?s[0]:null;for(;u!==null||d!==null;){let h=l<i.length?i[l+1]:void 0,f=c<s.length?s[c+1]:void 0,p=null,g;u===d?(l+=2,c+=2,h!==f&&(p=d,g=f)):d===null||u!==null&&u<d?(l+=2,p=u):(c+=2,p=d,g=f),p!==null&&AR(t,e,n,r,p,g,o,a),u=l<i.length?i[l]:null,d=c<s.length?s[c]:null}}function AR(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let l=t.data,c=l[a+1],u=Eq(c)?gA(l,e,n,i,ya(c),o):void 0;if(!Cf(u)){Cf(s)||vq(c)&&(s=gA(l,null,n,i,a,o));let d=tx(Bs(),n);M$(r,o,d,i,s)}}function gA(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let l=t[i],c=Array.isArray(l),u=c?l[1]:l,d=u===null,h=n[i+1];h===ni&&(h=d?cn:void 0);let f=d?D_(h,r):u===r?h:void 0;if(c&&!Cf(f)&&(f=D_(l,r)),Cf(f)&&(a=f,o))return a;let p=t[i+1];i=o?Us(p):ya(p)}if(e!==null){let l=s?e.residualClasses:e.residualStyles;l!=null&&(a=D_(l,r))}return a}function Cf(t){return t!==void 0}function Vq(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=un($s(t)))),t}function xR(t,e){return(t.flags&(e?8:16))!==0}function RR(t,e,n){let r=be(),i=gw(r,t,e,n);Mq(Pv,xq,i,!0)}function jq(t,e,n,r,i,s){let o=e.consts,a=uf(o,i),l=Hf(e,t,2,r,a);return oR(e,n,l,uf(o,s)),l.attrs!==null&&gv(l,l.attrs,!1),l.mergedAttrs!==null&&gv(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function $(t,e,n,r){let i=be(),s=Qt(),o=Ri+t,a=i[Je],l=s.firstCreatePass?jq(o,s,i,e,n,r):s.data[o],c=Uq(s,i,l,a,e,t);i[o]=c;let u=Vv(l);return Cc(l,!0),Yx(a,c,l),!gq(l)&&qv()&&rw(s,i,c,l),tB()===0&&Vs(c,i),nB(),u&&(rR(s,i,l),nR(s,l,i)),r!==null&&iR(i,l),$}function j(){let t=dn();ax()?lB():(t=t.parent,Cc(t,!1));let e=t;sB(e)&&oB(),rB();let n=Qt();return n.firstCreatePass&&(zv(n,t),YA(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&wB(e)&&Ev(n,e,be(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&EB(e)&&Ev(n,e,be(),e.stylesWithoutHost,!1),j}function Oe(t,e,n,r){return $(t,e,n,r),j(),Oe}var Uq=(t,e,n,r,i,s)=>(Hv(!0),qx(r,i,mB()));function MR(){return be()}var Df="en-US";var Bq=Df;function $q(t){typeof t=="string"&&(Bq=t.toLowerCase().replace(/_/g,"-"))}function Yt(t,e,n,r){let i=be(),s=Qt(),o=dn();return NR(s,i,i[Je],o,t,e,r),Yt}function qq(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[fc],l=i[s+2];return a.length>l?a[l]:null}typeof o=="string"&&(s+=2)}return null}function NR(t,e,n,r,i,s,o){let a=Vv(r),c=t.firstCreatePass&&i4(t),u=e[zn],d=r4(e),h=!0;if(r.type&3||o){let g=xn(r,e),m=o?o(g):g,w=d.length,S=o?b=>o(pr(b[r.index])):r.index,C=null;if(!o&&a&&(C=qq(t,e,i,r.index)),C!==null){let b=C.__ngLastListenerFn__||C;b.__ngNextListenerFn__=s,C.__ngLastListenerFn__=s,h=!1}else{s=yA(r,e,u,s,!1);let b=n.listen(m,i,s);d.push(s,b),c&&c.push(i,S,w,w+1)}}else s=yA(r,e,u,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let m=0;m<g;m+=2){let w=p[m],S=p[m+1],B=e[w][S].subscribe(s),H=d.length;d.push(s,B),c&&c.push(i,r.index,H,-(H+1))}}}function mA(t,e,n,r){let i=we(null);try{return ur(6,e,n),n(r)!==!1}catch(s){return dR(t,s),!1}finally{ur(7,e,n),we(i)}}function yA(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Oi(t.index,e):e;cw(a);let l=mA(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)l=mA(e,n,c,o)&&l,c=c.__ngNextListenerFn__;return i&&l===!1&&o.preventDefault(),l}}function Xf(t=1){return gB(t)}function mw(t,e,n){return PR(t,"",e,"",n),mw}function PR(t,e,n,r,i){let s=be(),o=gw(s,e,n,r);if(o!==ni){let a=Qt(),l=Lf();ow(a,l,s,t,o,s[Je],i,!1)}return PR}function Ee(t,e=""){let n=be(),r=Qt(),i=t+Ri,s=r.firstCreatePass?Hf(r,i,1,e,null):r.data[i],o=Hq(r,n,s,e,t);n[i]=o,qv()&&rw(r,n,o,s),Cc(s,!1)}var Hq=(t,e,n,r,i)=>(Hv(!0),h$(e[Je],r));function yw(t,e,n){let r=be(),i=gw(r,t,e,n);return i!==ni&&s4(r,Bs(),i),yw}function _t(t,e,n){IR(e)&&(e=e());let r=be(),i=Ff();if(wa(r,i,e)){let s=Qt(),o=Lf();ow(s,o,r,t,e,r[Je],n,!1)}return _t}function Mt(t,e){let n=IR(t);return n&&t.set(e),n}function vt(t,e){let n=be(),r=Qt(),i=dn();return NR(r,n,n[Je],i,t,e),vt}function zq(t,e,n){let r=Qt();if(r.firstCreatePass){let i=Mi(t);Iv(n,r.data,r.blueprint,i,!0),Iv(e,r.data,r.blueprint,i,!1)}}function Iv(t,e,n,r,i){if(t=Wt(t),Array.isArray(t))for(let s=0;s<t.length;s++)Iv(t[s],e,n,r,i);else{let s=Qt(),o=be(),a=dn(),l=ha(t)?t:Wt(t.provide),c=GA(t),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(ha(t)||!t.multi){let f=new Ls(c,i,se),p=L_(l,e,i?u:u+h,d);p===-1?(Y_(ff(a,o),s,l),F_(s,t,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=L_(l,e,u+h,d),p=L_(l,e,u,u+h),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){Y_(ff(a,o),s,l);let w=Kq(i?Wq:Gq,n.length,i,r,c);!i&&m&&(n[p].providerFactory=w),F_(s,t,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(w),o.push(w)}else{let w=kR(n[i?p:f],c,!i&&r);F_(s,t,f>-1?f:p,w)}!i&&r&&m&&n[p].componentProviders++}}}function F_(t,e,n,r){let i=ha(e),s=PU(e);if(i||s){let l=(s?Wt(e.useClass):e).prototype.ngOnDestroy;if(l){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let u=c.indexOf(n);u===-1?c.push(n,[r,l]):c[u+1].push(r,l)}else c.push(n,l)}}}function kR(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function L_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function Gq(t,e,n,r){return Cv(this.multi,[])}function Wq(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ga(n,n[he],this.providerFactory.index,r);s=a.slice(0,o),Cv(i,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Cv(i,s);return s}function Cv(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function Kq(t,e,n,r,i){let s=new Ls(t,n,se);return s.multi=[],s.index=e,s.componentProviders=0,kR(s,i,r&&!n),s}function Fi(t,e=[]){return n=>{n.providersResolver=(r,i)=>zq(r,i?i(t):t,e)}}var Qq=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=qA(!1,r.type),s=i.length>0?Kf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=k({token:e,providedIn:"environment",factory:()=>new e(E(Kt))});let t=e;return t})();function OR(t){Wf("NgStandalone"),t.getStandaloneInjector=e=>e.get(Qq).getOrCreateStandaloneInjector(t)}var Yh=null;function Yq(t){Yh!==null&&(t.defaultEncapsulation!==Yh.defaultEncapsulation||t.preserveWhitespaces!==Yh.preserveWhitespaces)||(Yh=t)}var Xr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},FR=new Xr("17.3.0"),Zf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var _w=new x(""),Ac=new x(""),Jf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,vw||(Xq(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ie.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(E(ie),E(ep),E(Ac))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),ep=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return vw?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function Xq(t){vw=t}var vw;function Hs(t){return!!t&&typeof t.then=="function"}function LR(t){return!!t&&typeof t.subscribe=="function"}var tp=new x(""),VR=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=A(tp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Hs(o))r.push(o);else if(LR(o)){let a=new Promise((l,c)=>{o.subscribe({complete:l,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),np=new x("");function Zq(){hS(()=>{throw new V(600,!1)})}function Jq(t){return t.isBoundToModule}function eH(t,e,n){try{let r=n();return Hs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function jR(t,e){return Array.isArray(e)?e.reduce(jR,t):M(M({},t),e)}var zs=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=A(Sx),this.afterRenderEffectManager=A(fw),this.externalTestViews=new Set,this.beforeRender=new Ge,this.afterTick=new Ge,this.componentTypes=[],this.components=[],this.isStable=A(qs).hasPendingTasks.pipe(F(r=>!r)),this._injector=A(Kt)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof _f;if(!this._injector.get(VR).done){let f=!s&&jA(r),p=!1;throw new V(405,p)}let a;s?a=r:a=this._injector.get(Gf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let l=Jq(a)?void 0:this._injector.get(Ni),c=i||a.selector,u=a.create(Qn.NULL,[],c,l),d=u.location.nativeElement,h=u.injector.get(_w,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),tf(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new V(101,!1);let i=we(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,we(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===mR)throw new V(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:l}of this._views)tH(a,o,l)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Dv(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Dv(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;tf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(np,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>tf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new V(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function tf(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function tH(t,e,n){!e&&!Dv(t)||nH(t,n,e)}function Dv(t){return Uv(t)}function nH(t,e,n){let r;n?(r=0,t[Q]|=1024):t[Q]&64?r=0:r=1,yR(t,e,r)}var Tv=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},rp=(()=>{let e=class e{compileModuleSync(r){return new If(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=UA(r),o=$x(s.declarations).reduce((a,l)=>{let c=xi(l);return c&&a.push(new ma(c)),a},[]);return new Tv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),rH=new x("");function iH(t,e,n){let r=new If(n);return Promise.resolve(r)}function _A(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var sH=(()=>{let e=class e{constructor(){this.zone=A(ie),this.applicationRef=A(zs)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oH(t){return[{provide:ie,useFactory:t},{provide:da,multi:!0,useFactory:()=>{let e=A(sH,{optional:!0});return()=>e.initialize()}},{provide:da,multi:!0,useFactory:()=>{let e=A(cH);return()=>{e.initialize()}}},{provide:Sx,useFactory:aH}]}function aH(){let t=A(ie),e=A(gr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function lH(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var cH=(()=>{let e=class e{constructor(){this.subscription=new Xe,this.initialized=!1,this.zone=A(ie),this.pendingTasks=A(qs)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ie.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ie.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function uH(){return typeof $localize<"u"&&$localize.locale||Df}var ww=new x("",{providedIn:"root",factory:()=>A(ww,le.Optional|le.SkipSelf)||uH()});var UR=new x(""),BR=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=O4(i?.ngZone,lH({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=hq(r.moduleType,this.injector,oH(()=>s)),a=o.injector.get(gr,null);return s.runOutsideAngular(()=>{let l=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{tf(this._modules,o),l.unsubscribe()})}),eH(a,s,()=>{let l=o.injector.get(VR);return l.runInitializers(),l.donePromise.then(()=>{let c=o.injector.get(ww,Df);return $q(c||Df),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=jR({},i);return iH(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(zs);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new V(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new V(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(UR,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(E(Qn))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),cc=null,$R=new x("");function dH(t){if(cc&&!cc.get($R,!1))throw new V(400,!1);Zq(),cc=t;let e=t.get(BR);return pH(t),e}function Ew(t,e,n=[]){let r=`Platform: ${e}`,i=new x(r);return(s=[])=>{let o=qR();if(!o||o.injector.get($R,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):dH(hH(a,r))}return fH(i)}}function hH(t=[],e){return Qn.create({name:e,providers:[{provide:Rf,useValue:"platform"},{provide:UR,useValue:new Set([()=>cc=null])},...t]})}function fH(t){let e=qR();if(!e)throw new V(401,!1);return e}function qR(){return cc?.get(BR)??null}function pH(t){t.get(Qv,null)?.forEach(n=>n())}function Iw(){return!1}var Li=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=gH;let t=e;return t})();function gH(t){return mH(dn(),be(),(t&16)===16)}function mH(t,e,n){if(Pf(t)&&!n){let r=Oi(t.index,e);return new js(r,r)}else if(t.type&47){let r=e[fr];return new js(r,e)}return null}var bv=class{constructor(){}supports(e){return CR(e)}create(e){return new Sv(e)}},yH=(t,e)=>e,Sv=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||yH}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<vA(r,i,s)?n:r,a=vA(o,i,s),l=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,u=l-i;if(c!=u){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!CR(e))throw new V(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,fq(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new Av(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Tf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Tf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Av=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},xv=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Tf=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new xv,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function vA(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function wA(){return new Cw([new bv])}var Cw=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||wA()),deps:[[e,new Mv,new _a]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new V(901,!1)}};e.\u0275prov=k({token:e,providedIn:"root",factory:wA});let t=e;return t})();var HR=Ew(null,"core",[]),zR=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(E(zs))},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({});let t=e;return t})();function Vi(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function GR(t){let e=xi(t);if(!e)return null;let n=new ma(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var YR=null;function _r(){return YR}function XR(t){YR??=t}var ip=class{};var jt=new x(""),Sw=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>A(vH),providedIn:"platform"});let t=e;return t})(),ZR=new x(""),vH=(()=>{let e=class e extends Sw{constructor(){super(),this._doc=A(jt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return _r().getBaseHref(this._doc)}onPopState(r){let i=_r().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=_r().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Aw(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function WR(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function ii(t){return t&&t[0]!=="?"?"?"+t:t}var si=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>A(xw),providedIn:"root"});let t=e;return t})(),JR=new x(""),xw=(()=>{let e=class e extends si{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??A(jt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Aw(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+ii(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Sw),E(JR,8))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),eM=(()=>{let e=class e extends si{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Aw(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Sw),E(JR,8))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Ca=(()=>{let e=class e{constructor(r){this._subject=new at,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=IH(WR(KR(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+ii(i))}normalize(r){return e.stripTrailingSlash(EH(this._basePath,KR(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+ii(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+ii(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=ii,e.joinWithSlash=Aw,e.stripTrailingSlash=WR,e.\u0275fac=function(i){return new(i||e)(E(si))},e.\u0275prov=k({token:e,factory:()=>wH(),providedIn:"root"});let t=e;return t})();function wH(){return new Ca(E(si))}function EH(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function KR(t){return t.replace(/\/index.html$/,"")}function IH(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function sp(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Dw=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},tM=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new Dw(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let l=i.get(o);i.move(l,a),QR(l,s)}});for(let s=0,o=i.length;s<o;s++){let l=i.get(s).context;l.index=s,l.count=o,l.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);QR(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(se(bc),se(uw),se(Cw))},e.\u0275dir=et({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function QR(t,e){t.context.$implicit=e.item}var nM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({});let t=e;return t})(),Rw="browser",CH="server";function DH(t){return t===Rw}function Gs(t){return t===CH}var rM=(()=>{let e=class e{};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>DH(A(lt))?new Tw(A(jt),window):new bw});let t=e;return t})(),Tw=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=TH(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function TH(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var bw=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Ia=class{};var Rc=class{},ap=class{},Ws=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),s=i.toLowerCase(),o=n.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var Pw=class{encodeKey(e){return iM(e)}encodeValue(e){return iM(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function AH(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=n.get(o)||[];l.push(a),n.set(o,l)}),n}var xH=/%(\d[a-f0-9])/gi,RH={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function iM(t){return encodeURIComponent(t).replace(xH,(e,n)=>RH[n]??e)}function op(t){return`${t}`}var ji=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Pw,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=AH(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let r=e.fromObject[n],i=Array.isArray(r)?r.map(op):[op(r)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{n.push({param:r,value:s,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(op(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(op(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var kw=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function MH(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function sM(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function oM(t){return typeof Blob<"u"&&t instanceof Blob}function aM(t){return typeof FormData<"u"&&t instanceof FormData}function NH(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var xc=class t{constructor(e,n,r,i){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(MH(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Ws,this.context??=new kw,!this.params)this.params=new ji,this.urlWithParams=n;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),l=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+l+o}}}serializeBody(){return this.body===null?null:sM(this.body)||oM(this.body)||aM(this.body)||NH(this.body)||typeof this.body=="string"?this.body:this.body instanceof ji?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||aM(this.body)?null:oM(this.body)?this.body.type||null:sM(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ji?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.body!==void 0?e.body:this.body,o=e.withCredentials!==void 0?e.withCredentials:this.withCredentials,a=e.reportProgress!==void 0?e.reportProgress:this.reportProgress,l=e.headers||this.headers,c=e.params||this.params,u=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),c)),new t(n,r,s,{params:c,headers:l,context:u,reportProgress:a,responseType:i,withCredentials:o})}},Da=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Da||{}),Mc=class{constructor(e,n=up.Ok,r="OK"){this.headers=e.headers||new Ws,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Ow=class t extends Mc{constructor(e={}){super(e),this.type=Da.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},lp=class t extends Mc{constructor(e={}){super(e),this.type=Da.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},cp=class extends Mc{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},up=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(up||{});function Nw(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var PH=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let o;if(r instanceof xc)o=r;else{let c;s.headers instanceof Ws?c=s.headers:c=new Ws(s.headers);let u;s.params&&(s.params instanceof ji?u=s.params:u=new ji({fromObject:s.params})),o=new xc(r,i,s.body!==void 0?s.body:null,{headers:c,context:s.context,params:u,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let a=L(o).pipe(Kr(c=>this.handler.handle(c)));if(r instanceof xc||s.observe==="events")return a;let l=a.pipe(gt(c=>c instanceof lp));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return l.pipe(F(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return l.pipe(F(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return l.pipe(F(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return l.pipe(F(c=>c.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new ji().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,Nw(s,i))}post(r,i,s={}){return this.request("POST",r,Nw(s,i))}put(r,i,s={}){return this.request("PUT",r,Nw(s,i))}};e.\u0275fac=function(i){return new(i||e)(E(Rc))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function dM(t,e){return e(t)}function kH(t,e){return(n,r)=>e.intercept(n,{handle:i=>t(i,r)})}function OH(t,e,n){return(r,i)=>Wn(n,()=>e(r,s=>t(s,i)))}var FH=new x(""),Fw=new x(""),LH=new x(""),VH=new x("");function jH(){let t=null;return(e,n)=>{t===null&&(t=(A(FH,{optional:!0})??[]).reduceRight(kH,dM));let r=A(qs),i=r.add();return t(e,n).pipe(bi(()=>r.remove(i)))}}var lM=(()=>{let e=class e extends Rc{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=A(qs);let s=A(VH,{optional:!0});this.backend=s??r}handle(r){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(Fw),...this.injector.get(LH,[])]));this.chain=s.reduceRight((o,a)=>OH(o,a,this.injector),dM)}let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(bi(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(E(ap),E(Kt))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();var UH=/^\)\]\}',?\n/;function BH(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var cM=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new V(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?re(i.\u0275loadImpl()):L(null)).pipe(Ce(()=>new Z(o=>{let a=i.build();if(a.open(r.method,r.urlWithParams),r.withCredentials&&(a.withCredentials=!0),r.headers.forEach((m,w)=>a.setRequestHeader(m,w.join(","))),r.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let m=r.detectContentTypeHeader();m!==null&&a.setRequestHeader("Content-Type",m)}if(r.responseType){let m=r.responseType.toLowerCase();a.responseType=m!=="json"?m:"text"}let l=r.serializeBody(),c=null,u=()=>{if(c!==null)return c;let m=a.statusText||"OK",w=new Ws(a.getAllResponseHeaders()),S=BH(a)||r.url;return c=new Ow({headers:w,status:a.status,statusText:m,url:S}),c},d=()=>{let{headers:m,status:w,statusText:S,url:C}=u(),b=null;w!==up.NoContent&&(b=typeof a.response>"u"?a.responseText:a.response),w===0&&(w=b?up.Ok:0);let B=w>=200&&w<300;if(r.responseType==="json"&&typeof b=="string"){let H=b;b=b.replace(UH,"");try{b=b!==""?JSON.parse(b):null}catch(ye){b=H,B&&(B=!1,b={error:ye,text:b})}}B?(o.next(new lp({body:b,headers:m,status:w,statusText:S,url:C||void 0})),o.complete()):o.error(new cp({error:b,headers:m,status:w,statusText:S,url:C||void 0}))},h=m=>{let{url:w}=u(),S=new cp({error:m,status:a.status||0,statusText:a.statusText||"Unknown Error",url:w||void 0});o.error(S)},f=!1,p=m=>{f||(o.next(u()),f=!0);let w={type:Da.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(w.total=m.total),r.responseType==="text"&&a.responseText&&(w.partialText=a.responseText),o.next(w)},g=m=>{let w={type:Da.UploadProgress,loaded:m.loaded};m.lengthComputable&&(w.total=m.total),o.next(w)};return a.addEventListener("load",d),a.addEventListener("error",h),a.addEventListener("timeout",h),a.addEventListener("abort",h),r.reportProgress&&(a.addEventListener("progress",p),l!==null&&a.upload&&a.upload.addEventListener("progress",g)),a.send(l),o.next({type:Da.Sent}),()=>{a.removeEventListener("error",h),a.removeEventListener("abort",h),a.removeEventListener("load",d),a.removeEventListener("timeout",h),r.reportProgress&&(a.removeEventListener("progress",p),l!==null&&a.upload&&a.upload.removeEventListener("progress",g)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(E(Ia))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),hM=new x(""),$H="XSRF-TOKEN",qH=new x("",{providedIn:"root",factory:()=>$H}),HH="X-XSRF-TOKEN",zH=new x("",{providedIn:"root",factory:()=>HH}),dp=class{},GH=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=sp(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(E(jt),E(lt),E(qH))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function WH(t,e){let n=t.url.toLowerCase();if(!A(hM)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let r=A(dp).getToken(),i=A(zH);return r!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,r)})),e(t)}var fM=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(fM||{});function KH(t,e){return{\u0275kind:t,\u0275providers:e}}function QH(...t){let e=[PH,cM,lM,{provide:Rc,useExisting:lM},{provide:ap,useExisting:cM},{provide:Fw,useValue:WH,multi:!0},{provide:hM,useValue:!0},{provide:dp,useClass:GH}];for(let n of t)e.push(...n.\u0275providers);return xf(e)}var uM=new x("");function YH(){return KH(fM.LegacyInterceptors,[{provide:uM,useFactory:jH},{provide:Fw,useExisting:uM,multi:!0}])}var pM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({providers:[QH(YH())]});let t=e;return t})();var jw=class extends ip{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Uw=class t extends jw{static makeCurrent(){XR(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=XH();return n==null?null:ZH(n)}resetBaseElement(){Nc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return sp(document.cookie,e)}},Nc=null;function XH(){return Nc=Nc||document.querySelector("base"),Nc?Nc.getAttribute("href"):null}function ZH(t){return new URL(t,document.baseURI).pathname}var Bw=class{addToWindow(e){Rt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new V(5103,!1);return s},Rt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Rt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Rt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Rt.frameworkStabilizers||(Rt.frameworkStabilizers=[]),Rt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?_r().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},JH=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),$w=new x(""),_M=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new V(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(E($w),E(ie))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),hp=class{constructor(e){this._doc=e}},Lw="ng-app-id",vM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Gs(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Lw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Lw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Lw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(E(jt),E(jf),E(Yv,8),E(lt))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Vw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Hw=/%COMP%/g,wM="%COMP%",ez=`_nghost-${wM}`,tz=`_ngcontent-${wM}`,nz=!0,rz=new x("",{providedIn:"root",factory:()=>nz});function iz(t){return tz.replace(Hw,t)}function sz(t){return ez.replace(Hw,t)}function EM(t,e){return e.map(n=>n.replace(Hw,t))}var gM=(()=>{let e=class e{constructor(r,i,s,o,a,l,c,u=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=l,this.ngZone=c,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Gs(l),this.defaultRenderer=new Pc(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===hr.ShadowDom&&(i=fe(M({},i),{encapsulation:hr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof fp?s.applyToHost(r):s instanceof kc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,l=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case hr.Emulated:o=new fp(c,u,i,this.appId,d,a,l,h);break;case hr.ShadowDom:return new qw(c,u,r,i,a,l,this.nonce,h);default:o=new kc(c,u,i,d,a,l,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(E(_M),E(vM),E(jf),E(rz),E(jt),E(lt),E(ie),E(Yv))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Pc=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Vw[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(mM(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(mM(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new V(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Vw[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Vw[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Yr.DashCase|Yr.Important)?e.style.setProperty(n,r,i&Yr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Yr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=_r().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function mM(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var qw=class extends Pc{constructor(e,n,r,i,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=EM(i.id,i.styles);for(let u of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},kc=class extends Pc{constructor(e,n,r,i,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=l?EM(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},fp=class extends kc{constructor(e,n,r,i,s,o,a,l){let c=i+"-"+r.id;super(e,n,r,s,o,a,l,c),this.contentAttr=iz(c),this.hostAttr=sz(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},oz=(()=>{let e=class e extends hp{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(E(jt))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),yM=["alt","control","meta","shift"],az={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},lz={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},cz=(()=>{let e=class e extends hp{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>_r().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),a="code."),yM.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),a+=u+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=az[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),yM.forEach(a=>{if(a!==s){let l=lz[a];l(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(E(jt))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function uz(){Uw.makeCurrent()}function dz(){return new gr}function hz(){return xx(document),document}var fz=[{provide:lt,useValue:Rw},{provide:Qv,useValue:uz,multi:!0},{provide:jt,useFactory:hz,deps:[]}],IM=Ew(HR,"browser",fz),pz=new x(""),gz=[{provide:Ac,useClass:Bw,deps:[]},{provide:_w,useClass:Jf,deps:[ie,ep,Ac]},{provide:Jf,useClass:Jf,deps:[ie,ep,Ac]}],mz=[{provide:Rf,useValue:"root"},{provide:gr,useFactory:dz,deps:[]},{provide:$w,useClass:oz,multi:!0,deps:[jt,ie,lt]},{provide:$w,useClass:cz,multi:!0,deps:[jt]},gM,vM,_M,{provide:yc,useExisting:gM},{provide:Ia,useClass:JH,deps:[]},[]],CM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:jf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(E(pz,12))},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({providers:[...mz,...gz],imports:[nM,zR]});let t=e;return t})();var DM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(E(jt))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var yz="firebase",_z="10.9.0";an(yz,_z,"app");var oi=new Xr("ANGULARFIRE2_VERSION");var vz=(t,e)=>{let n=e?[e]:oS(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Yn=class{constructor(){return vz(wz)}},wz="app-check";function zw(){}var pp=class{zone;delegate;constructor(e,n=f_){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Gw=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",zw,{},zw,zw)),n.pipe(Ze({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ui=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new pp(Zone.current)),this.insideAngular=n.run(()=>new pp(Zone.current,Gr)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(E(ie))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function bM(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Ww(t){return t.pipe(fn(bM().outsideAngular))}function Ve(t){return Ez(bM())(t)}function Ez(t){return function(n){return n=n.lift(new Gw(t.ngZone)),n.pipe(Bn(t.outsideAngular),fn(t.insideAngular))}}var Iz="firebase",Cz="10.9.0";Ye.registerVersion(Iz,Cz,"app-compat");var Dz=["ngOnDestroy"],AM=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(Dz.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let l=a?.[s];return typeof l=="function"?l.bind(a):l?.then?l.then(c=>n.run(()=>c)):n.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>o[l],apply:(a,l,c)=>o.then(u=>{let d=u?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var mp=class{constructor(e){return e}},vr=new x("angularfire2.app.options"),wr=new x("angularfire2.app.name");function ai(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=Ye.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Ye.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;Tz("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new mp(o)}var Tz=(t,...e)=>{Iw()&&typeof console<"u"&&console[t](...e)},bz={provide:mp,useFactory:ai,deps:[vr,ie,[new _a,wr]]},xM=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:vr,useValue:n},{provide:wr,useValue:r}]}}constructor(n){Ye.registerVersion("angularfire",oi.full,"core"),Ye.registerVersion("angularfire",oi.full,"app-compat"),Ye.registerVersion("angular",FR.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(lt))};static \u0275mod=ke({type:t});static \u0275inj=Pe({providers:[bz]})}return t})();function Bi(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return Sz(i,o)||(SM("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Az?" You may need to reload as Firebase is not HMR aware.":""}`),SM("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function Sz(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var Az=typeof module<"u"&&!!module.hot,SM=(t,...e)=>{Iw()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var xz=new Map,Rz={activated:!1,tokenObservers:[]},Mz={initialized:!1,enabled:!1};function Xn(t){return xz.get(t)||Object.assign({},Rz)}function kM(){return Mz}var Nz="https://content-firebaseappcheck.googleapis.com/v1";var Pz="exchangeDebugToken",RM={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},dse=24*60*60*1e3;var Qw=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return _(this,null,function*(){this.stop();try{this.pending=new yt,this.pending.promise.catch(n=>{}),yield kz(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new yt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function kz(t){return new Promise(e=>{setTimeout(e,t)})}var Oz={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},$i=new eS("appCheck","AppCheck",Oz);function OM(t){if(!Xn(t).activated)throw $i.create("use-before-activation",{appName:t.name})}function FM(r,i){return _(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(t,a)}catch(f){throw $i.create("fetch-network-error",{originalErrorMessage:f?.message})}if(l.status!==200)throw $i.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(f){throw $i.create("fetch-parse-error",{originalErrorMessage:f?.message})}let u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw $i.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(u[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function LM(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${Nz}/projects/${n}/apps/${r}:${Pz}?key=${i}`,body:{debug_token:e}}}var Fz="firebase-app-check-database",Lz=1,Yw="firebase-app-check-store";var yp=null;function Vz(){return yp||(yp=new Promise((t,e)=>{try{let n=indexedDB.open(Fz,Lz);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e($i.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Yw,{keyPath:"compositeKey"})}}}catch(n){e($i.create("storage-open",{originalErrorMessage:n?.message}))}}),yp)}function jz(t,e){return Uz(Bz(t),e)}function Uz(t,e){return _(this,null,function*(){let r=(yield Vz()).transaction(Yw,"readwrite"),s=r.objectStore(Yw).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},r.onerror=l=>{var c;a($i.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function Bz(t){return`${t.options.appId}-${t.name}`}var Xw=new Ii("@firebase/app-check");function Kw(t,e){return hh()?jz(t,e).catch(n=>{Xw.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function VM(){return kM().enabled}function jM(){return _(this,null,function*(){let t=kM();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var $z={error:"UNKNOWN_ERROR"};function qz(t){return dh.encodeString(JSON.stringify(t),!1)}function Zw(t,e=!1){return _(this,null,function*(){let n=t.app;OM(n);let r=Xn(n),i=r.token,s;if(i&&!Oc(i)&&(r.token=void 0,i=void 0),!i){let l=yield r.cachedTokenPromise;l&&(Oc(l)?i=l:yield Kw(n,void 0))}if(!e&&i&&Oc(i))return{token:i.token};let o=!1;if(VM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=FM(LM(n,yield jM()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let l=yield r.exchangeTokenPromise;return yield Kw(n,l),r.token=l,{token:l.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Xn(n).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?Xw.warn(l.message):Xw.error(l),s=l}let a;return i?s?Oc(i)?a={token:i.token,internalError:s}:a=NM(s):(a={token:i.token},r.token=i,yield Kw(n,i)):a=NM(s),o&&Wz(n,a),a})}function Hz(t){return _(this,null,function*(){let e=t.app;OM(e);let{provider:n}=Xn(e);if(VM()){let r=yield jM(),{token:i}=yield FM(LM(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function zz(t,e,n,r){let{app:i}=t,s=Xn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Oc(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),MM(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>MM(t))}function UM(t,e){let n=Xn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function MM(t){let{app:e}=t,n=Xn(e),r=n.tokenRefresher;r||(r=Gz(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Gz(t){let{app:e}=t;return new Qw(()=>_(this,null,function*(){let n=Xn(e),r;if(n.token?r=yield Zw(t,!0):r=yield Zw(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Xn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},RM.RETRIAL_MIN_WAIT,RM.RETRIAL_MAX_WAIT)}function Wz(t,e){let n=Xn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Oc(t){return t.expireTimeMillis-Date.now()>0}function NM(t){return{token:qz($z),error:t}}var Jw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Xn(this.app);for(let n of e)UM(this.app,n.next);return Promise.resolve()}};function Kz(t,e){return new Jw(t,e)}function Qz(t){return{getToken:e=>Zw(t,e),getLimitedUseToken:()=>Hz(t),addTokenListener:e=>zz(t,"INTERNAL",e),removeTokenListener:e=>UM(t.app,e)}}var Yz="@firebase/app-check",Xz="0.8.2";var Zz="app-check",PM="app-check-internal";function Jz(){Hr(new St(Zz,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Kz(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(PM).initialize()})),Hr(new St(PM,t=>{let e=t.getProvider("app-check").getImmediate();return Qz(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),an(Yz,Xz)}Jz();var eG=["localhost","0.0.0.0","127.0.0.1"],Cse=typeof window<"u"&&eG.includes(window.location.hostname);var Fc=new x("angularfire2.auth.use-emulator"),Lc=new x("angularfire2.auth.settings"),Vc=new x("angularfire2.auth.tenant-id"),jc=new x("angularfire2.auth.langugage-code"),Uc=new x("angularfire2.auth.use-device-language"),Bc=new x("angularfire.auth.persistence"),$c=(t,e,n,r,i,s,o,a)=>Bi(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let l=e.runOutsideAngular(()=>t.auth());if(n&&l.useEmulator(...n),r&&(l.tenantId=r),l.languageCode=i,s&&l.useDeviceLanguage(),o)for(let[c,u]of Object.entries(o))l.settings[c]=u;return a&&l.setPersistence(a),l},[n,r,i,s,o,a]),vp=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,l,c,u,d,h,f){let p=new Ge,g=L(void 0).pipe(fn(o.outsideAngular),Ce(()=>s.runOutsideAngular(()=>import("./chunk-WB7O6QDU.js"))),F(()=>ai(n,s,r)),F(m=>$c(m,s,a,c,u,d,l,h)),$h({bufferSize:1,refCount:!1}));if(Gs(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=L(null);else{g.pipe(bn()).subscribe();let m=g.pipe(Ce(C=>C.getRedirectResult().then(b=>b,()=>null)),Ve,$h({bufferSize:1,refCount:!1})),w=g.pipe(Ce(C=>new Z(b=>({unsubscribe:s.runOutsideAngular(()=>C.onAuthStateChanged(B=>b.next(B),B=>b.error(B),()=>b.complete()))})))),S=g.pipe(Ce(C=>new Z(b=>({unsubscribe:s.runOutsideAngular(()=>C.onIdTokenChanged(B=>b.next(B),B=>b.error(B),()=>b.complete()))}))));this.authState=m.pipe(qh(w),Bn(o.outsideAngular),fn(o.insideAngular)),this.user=m.pipe(qh(S),Bn(o.outsideAngular),fn(o.insideAngular)),this.idToken=this.user.pipe(Ce(C=>C?re(C.getIdToken()):L(null))),this.idTokenResult=this.user.pipe(Ce(C=>C?re(C.getIdTokenResult()):L(null))),this.credential=ta(m,p,this.authState.pipe(gt(C=>!C))).pipe(F(C=>C?.user?C:null),Bn(o.outsideAngular),fn(o.insideAngular))}return AM(this,g,s,{spy:{apply:(m,w,S)=>{(m.startsWith("signIn")||m.startsWith("createUser"))&&S.then(C=>p.next(C))}}})}static \u0275fac=function(r){return new(r||t)(E(vr),E(wr,8),E(lt),E(ie),E(Ui),E(Fc,8),E(Lc,8),E(Vc,8),E(jc,8),E(Uc,8),E(Bc,8),E(Yn,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var $M="@firebase/database",qM="1.0.3";var fI="";function pI(t){fI=t}var cE=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),st(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:ph(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var uE=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var EN=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new cE(e)}}catch{}return new uE},Qs=EN("localStorage"),dE=EN("sessionStorage");var Aa=new Ii("@firebase/database"),IN=function(){let t=1;return function(){return t++}}(),CN=function(t){let e=sS(t),n=new iS;n.update(e);let r=n.digest();return dh.encodeByteArray(r)},hu=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=hu.apply(null,r):typeof r=="object"?e+=st(r):e+=r,e+=" "}return e},Ys=null,HM=!0,DN=function(t,e){T(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Aa.logLevel=Tn.VERBOSE,Ys=Aa.log.bind(Aa),e&&dE.set("logging_enabled",!0)):typeof t=="function"?Ys=t:(Ys=null,dE.remove("logging_enabled"))},wt=function(...t){if(HM===!0&&(HM=!1,Ys===null&&dE.get("logging_enabled")===!0&&DN(!0)),Ys){let e=hu.apply(null,t);Ys(e)}},fu=function(t){return function(...e){wt(t,...e)}},hE=function(...t){let e="FIREBASE INTERNAL ERROR: "+hu(...t);Aa.error(e)},Cr=function(...t){let e=`FIREBASE FATAL ERROR: ${hu(...t)}`;throw Aa.error(e),new Error(e)},Ut=function(...t){let e="FIREBASE WARNING: "+hu(...t);Aa.warn(e)},tG=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ut("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Wp=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},nG=function(t){if(ar()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Gi="[MIN_NAME]",li="[MAX_NAME]",Zs=function(t,e){if(t===e)return 0;if(t===Gi||e===li)return-1;if(e===Gi||t===li)return 1;{let n=zM(t),r=zM(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},rG=function(t,e){return t===e?0:t<e?-1:1},qc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+st(e))},gI=function(t){if(typeof t!="object"||t===null)return st(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=st(e[r]),n+=":",n+=gI(t[e[r]]);return n+="}",n},TN=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Et(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var bN=function(t){T(!Wp(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,l;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let u=c.join(""),d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},iG=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},sG=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function oG(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var aG=new RegExp("^-?(0*)\\d{1,10}$"),lG=-2147483648,cG=2147483647,zM=function(t){if(aG.test(t)){let e=Number(t);if(e>=lG&&e<=cG)return e}return null},La=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Ut("Exception was thrown by user callback.",n),e},Math.floor(0))}},uG=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Wc=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var fE=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ut(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var pE=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(wt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ut(e)}},Kc=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Ep="5",SN="v",AN="s",xN="r",RN="f",MN=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,NN="ls",PN="p",gE="ac",kN="websocket",ON="long_polling";var Ip=class{constructor(e,n,r,i,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Qs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Qs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function dG(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function FN(t,e,n){T(typeof e=="string","typeof type must == string"),T(typeof n=="object","typeof params must == object");let r;if(e===kN)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===ON)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);dG(t)&&(n.ns=t.namespace);let i=[];return Et(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var mE=class{constructor(){this.counters_={}}incrementCounter(e,n=1){Dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Zb(this.counters_)}};var nE={},rE={};function mI(t){let e=t.toString();return nE[e]||(nE[e]=new mE),nE[e]}function hG(t,e){let n=t.toString();return rE[n]||(rE[n]=e()),rE[n]}var yE=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&La(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var GM="start",fG="close",pG="pLPCommand",gG="pRTLPCB",LN="id",VN="pw",jN="ser",mG="cb",yG="seg",_G="ts",vG="d",wG="dframe",UN=1870,BN=30,EG=UN-BN,IG=25e3,CG=3e4,Zc=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=fu(e),this.stats_=mI(n),this.urlFn=l=>(this.appCheckToken&&(l[gE]=this.appCheckToken),FN(n,ON,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new yE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(CG)),nG(()=>{if(this.isClosed_)return;this.scriptTagHolder=new _E((...s)=>{let[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===GM)this.id=a,this.password=l;else if(o===fG)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[GM]="t",r[jN]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[mG]=this.scriptTagHolder.uniqueCallbackIdentifier),r[SN]=Ep,this.transportSessionId&&(r[AN]=this.transportSessionId),this.lastSessionId&&(r[NN]=this.lastSessionId),this.applicationId&&(r[PN]=this.applicationId),this.appCheckToken&&(r[gE]=this.appCheckToken),typeof location<"u"&&location.hostname&&MN.test(location.hostname)&&(r[xN]=RN);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ar()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!iG()&&!sG()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=st(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Xb(n),i=TN(r,EG);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ar())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[wG]="t",r[LN]=e,r[VN]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=st(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},_E=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ar())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=IN(),window[pG+this.uniqueCallbackIdentifier]=e,window[gG+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){wt("frame writing exception"),a.stack&&wt(a.stack),wt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||wt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[LN]=this.myID,e[VN]=this.myPW,e[jN]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+BN+r.length<=UN;){let o=this.pendingSegs.shift();r=r+"&"+yG+i+"="+o.seg+"&"+_G+i+"="+o.ts+"&"+vG+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(IG)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){ar()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{wt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var DG=16384,TG=45e3,Cp=null;typeof MozWebSocket<"u"?Cp=MozWebSocket:typeof WebSocket<"u"&&(Cp=WebSocket);var ba=(()=>{class t{constructor(n,r,i,s,o,a,l){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=fu(this.connId),this.stats_=mI(r),this.connURL=t.connectionURL_(r,a,l,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[SN]=Ep,!ar()&&typeof location<"u"&&location.hostname&&MN.test(location.hostname)&&(a[xN]=RN),r&&(a[AN]=r),i&&(a[NN]=i),s&&(a[gE]=s),o&&(a[PN]=o),FN(n,kN,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Qs.set("previous_websocket_failure",!0);try{let i;if(ar()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Ep}/${fI}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Cp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Cp!==null&&!t.forceDisallow_}static previouslyFailed(){return Qs.isInMemoryStorage||Qs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Qs.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=ph(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(T(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=st(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=TN(r,DG);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(TG))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),$N=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Zc,ba]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=ba&&ba.isAvailable(),i=r&&!ba.previouslyFailed();if(n.webSocketOnly&&(r||Ut("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ba];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),bG=6e4,SG=5e3,AG=10*1024,xG=100*1024,iE="t",WM="d",RG="s",KM="r",MG="e",QM="o",YM="a",XM="n",ZM="p",NG="h",vE=class{constructor(e,n,r,i,s,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=fu("c:"+this.id+":"),this.transportManager_=new $N(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Wc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>xG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>AG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(iE in e){let n=e[iE];n===YM?this.upgradeIfSecondaryHealthy_():n===KM?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===QM&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=qc("t",e),r=qc("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ZM,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:YM,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:XM,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=qc("t",e),r=qc("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=qc(iE,e);if(WM in e){let r=e[WM];if(n===NG){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===XM){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===RG?this.onConnectionShutdown_(r):n===KM?this.onReset_(r):n===MG?hE("Server Error: "+r):n===QM?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):hE("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Ep!==r&&Ut("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Wc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(bG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Wc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(SG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ZM,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Qs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Dp=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Tp=class{constructor(e){this.allowedEvents_=e,this.listeners_={},T(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){T(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var bp=class t extends Tp{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ky()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return T(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var JM=32,eN=768,ve=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function _e(){return new ve("")}function oe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Wi(t){return t.pieces_.length-t.pieceNum_}function xe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ve(t.pieces_,e)}function yI(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function PG(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Jc(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function qN(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ve(e,0)}function je(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ve)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new ve(n,0)}function ae(t){return t.pieceNum_>=t.pieces_.length}function Xt(t,e){let n=oe(t),r=oe(e);if(n===null)return e;if(n===r)return Xt(xe(t),xe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function kG(t,e){let n=Jc(t,0),r=Jc(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Zs(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function _I(t,e){if(Wi(t)!==Wi(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Mn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Wi(t)>Wi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var wE=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Jc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=tc(this.parts_[r]);HN(this)}};function OG(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=tc(e),HN(t)}function FG(t){let e=t.parts_.pop();t.byteLength_-=tc(e),t.parts_.length>0&&(t.byteLength_-=1)}function HN(t){if(t.byteLength_>eN)throw new Error(t.errorPrefix_+"has a key path longer than "+eN+" bytes ("+t.byteLength_+").");if(t.parts_.length>JM)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+JM+") or object contains a cycle "+Ks(t))}function Ks(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var EE=class t extends Tp{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return T(e==="visible","Unknown event type: "+e),[this.visible_]}};var Hc=1e3,LG=60*5*1e3,tN=30*1e3,VG=1.3,jG=3e4,UG="server_kill",nN=3,vI=(()=>{class t extends Dp{constructor(n,r,i,s,o,a,l,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=fu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Hc,this.maxReconnectDelay_=LG,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!ar())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");EE.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&bp.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(st(o)),T(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new yt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?r.resolve(l):r.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),T(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,u=l.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(u,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&Dn(n,"w")){let i=Ei(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Ut(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||nS(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=tN)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=tS(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+st(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):hE("Unrecognized action received from server: "+st(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){T(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Hc,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Hc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>jG&&(this.reconnectDelay_=Hc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*VG)}this.onConnectStatus_(!1)}establishConnection_(){return _(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,i())},u=function(h){T(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?wt("getToken() completed but was canceled"):(wt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,l=new vE(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Ut(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(UG)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Ut(h),c())}}})}interrupt(n){wt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){wt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],gh(this.interruptReasons_)&&(this.reconnectDelay_=Hc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>gI(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new ve(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){wt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=nN&&(this.reconnectDelay_=tN,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){wt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=nN&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";ar()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+fI.replace(/\./g,"-")]=1,Ky()?n["framework.cordova"]=1:Jb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=bp.getInstance().currentlyOnline();return gh(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ce=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var xa=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ce(Gi,e),i=new ce(Gi,n);return this.compare(r,i)!==0}minPost(){return ce.MIN}};var wp,Sp=class extends xa{static get __EMPTY_NODE(){return wp}static set __EMPTY_NODE(e){wp=e}compare(e,n){return Zs(e.name,n.name)}isDefinedOn(e){throw Uo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ce.MIN}maxPost(){return new ce(li,wp)}makePost(e,n){return T(typeof e=="string","KeyIndex indexValue must always be a string."),new ce(e,wp)}toString(){return".key"}},Ir=new Sp;var Sa=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Zn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Nn.EMPTY_NODE,this.right=o??Nn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Nn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Nn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),IE=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Zn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Nn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Zn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Zn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Sa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Sa(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Sa(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Sa(this.root_,null,this.comparator_,!0,e)}};Nn.EMPTY_NODE=new IE;function BG(t,e){return Zs(t.name,e.name)}function wI(t,e){return Zs(t,e)}var CE;function $G(t){CE=t}var zN=function(t){return typeof t=="number"?"number:"+bN(t):"string:"+t},GN=function(t){if(t.isLeafNode()){let e=t.val();T(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Dn(e,".sv"),"Priority must be a string or number.")}else T(t===CE||t.isEmpty(),"priority of unexpected type.");T(t===CE||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var rN,Ra=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,T(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),GN(this.priorityNode_)}static set __childrenNodeConstructor(n){rN=n}static get __childrenNodeConstructor(){return rN}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ae(n)?this:oe(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=oe(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(T(i!==".priority"||Wi(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(xe(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+zN(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=bN(this.value_):n+=this.value_,this.lazyHash_=CN(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(T(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return T(s>=0,"Unknown leaf type: "+r),T(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),WN,KN;function qG(t){WN=t}function HG(t){KN=t}var DE=class extends xa{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Zs(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ce.MIN}maxPost(){return new ce(li,new Ra("[PRIORITY-POST]",KN))}makePost(e,n){let r=WN(e);return new ce(n,new Ra("[PRIORITY-POST]",r))}toString(){return".priority"}},Me=new DE;var zG=Math.log(2),TE=class{constructor(e){let n=s=>parseInt(Math.log(s)/zG,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Ap=function(t,e,n,r){t.sort(e);let i=function(l,c){let u=c-l,d,h;if(u===0)return null;if(u===1)return d=t[l],h=n?n(d):d,new Zn(h,d.node,Zn.BLACK,null,null);{let f=parseInt(u/2,10)+l,p=i(l,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new Zn(h,d.node,Zn.BLACK,p,g)}},s=function(l){let c=null,u=null,d=t.length,h=function(p,g){let m=d-p,w=d;d-=p;let S=i(m+1,w),C=t[m],b=n?n(C):C;f(new Zn(b,C.node,g,null,S))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){let g=l.nextBitIsOne(),m=Math.pow(2,l.count-(p+1));g?h(m,Zn.BLACK):(h(m,Zn.BLACK),h(m,Zn.RED))}return u},o=new TE(t.length),a=s(o);return new Nn(r||e,a)};var sE,Ta={},Ma=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return T(Ta&&Me,"ChildrenNode.ts has not been loaded"),sE=sE||new t({".priority":Ta},{".priority":Me}),sE}get(e){let n=Ei(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Nn?n:null}hasIndex(e){return Dn(this.indexSet_,e.toString())}addIndex(e,n){T(e!==Ir,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ce.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Ap(r,e.getCompare()):a=Ta;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let u=Object.assign({},this.indexes_);return u[l]=a,new t(u,c)}addToIndexes(e,n){let r=ec(this.indexes_,(i,s)=>{let o=Ei(this.indexSet_,s);if(T(o,"Missing index implementation for "+s),i===Ta)if(o.isDefinedOn(e.node)){let a=[],l=n.getIterator(ce.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Ap(a,o.getCompare())}else return Ta;else{let a=n.get(e.name),l=i;return a&&(l=l.remove(new ce(e.name,a))),l.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=ec(this.indexes_,i=>{if(i===Ta)return i;{let s=n.get(e.name);return s?i.remove(new ce(e.name,s)):i}});return new t(r,this.indexSet_)}};var zc,J=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&GN(this.priorityNode_),this.children_.isEmpty()&&T(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return zc||(zc=new t(new Nn(wI),null,Ma.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||zc}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?zc:r}}getChild(n){let r=oe(n);return r===null?this:this.getImmediateChild(r).getChild(xe(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(T(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ce(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?zc:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=oe(n);if(i===null)return r;{T(oe(n)!==".priority"||Wi(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(xe(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Me,(a,l)=>{r[a]=l.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let l in r)a[l]=r[l];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+zN(this.getPriority().val())+":"),this.forEachChild(Me,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":CN(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ce(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ce(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ce(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===pu?-1:0}withIndex(n){if(n===Ir||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Ir||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Me),s=r.getIterator(Me),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Ir?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),bE=class extends J{constructor(){super(new Nn(wI),J.EMPTY_NODE,Ma.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return J.EMPTY_NODE}isEmpty(){return!1}},pu=new bE;Object.defineProperties(ce,{MIN:{value:new ce(Gi,J.EMPTY_NODE)},MAX:{value:new ce(li,pu)}});Sp.__EMPTY_NODE=J.EMPTY_NODE;Ra.__childrenNodeConstructor=J;$G(pu);HG(pu);var GG=!0;function qe(t,e=null){if(t===null)return J.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),T(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Ra(n,qe(e))}if(!(t instanceof Array)&&GG){let n=[],r=!1;if(Et(t,(o,a)=>{if(o.substring(0,1)!=="."){let l=qe(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new ce(o,l)))}}),n.length===0)return J.EMPTY_NODE;let s=Ap(n,BG,o=>o.name,wI);if(r){let o=Ap(n,Me.getCompare());return new J(s,qe(e),new Ma({".priority":o},{".priority":Me}))}else return new J(s,qe(e),Ma.Default)}else{let n=J.EMPTY_NODE;return Et(t,(r,i)=>{if(Dn(t,r)&&r.substring(0,1)!=="."){let s=qe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(qe(e))}}qG(qe);var eu=class extends xa{constructor(e){super(),this.indexPath_=e,T(!ae(e)&&oe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Zs(e.name,n.name):s}makePost(e,n){let r=qe(e),i=J.EMPTY_NODE.updateChild(this.indexPath_,r);return new ce(n,i)}maxPost(){let e=J.EMPTY_NODE.updateChild(this.indexPath_,pu);return new ce(li,e)}toString(){return Jc(this.indexPath_,0).join("/")}};var SE=class extends xa{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Zs(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ce.MIN}maxPost(){return ce.MAX}makePost(e,n){let r=qe(e);return new ce(n,r)}toString(){return".value"}},EI=new SE;function QN(t){return{type:"value",snapshotNode:t}}function Na(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function tu(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function nu(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function WG(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var ru=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){T(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(tu(n,a)):T(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Na(n,r)):o.trackChildChange(nu(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Me,(i,s)=>{n.hasChild(i)||r.trackChildChange(tu(i,s))}),n.isLeafNode()||n.forEachChild(Me,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(nu(i,s,o))}else r.trackChildChange(Na(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?J.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var xp=class t{constructor(e){this.indexedFilter_=new ru(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ce(n,r))||(r=J.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=J.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(J.EMPTY_NODE);let s=this;return n.forEachChild(Me,(o,a)=>{s.matches(new ce(o,a))||(i=i.updateImmediateChild(o,J.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var AE=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new xp(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ce(n,r))||(r=J.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=J.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=J.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(J.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,J.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;T(a.numChildren()===this.limit_,"");let l=new ce(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,l);if(u&&!r.isEmpty()&&f>=0)return s?.trackChildChange(nu(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(tu(n,d));let g=a.updateImmediateChild(n,J.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Na(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:u&&o(c,l)>=0?(s!=null&&(s.trackChildChange(tu(c.name,c.node)),s.trackChildChange(Na(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,J.EMPTY_NODE)):e}};var iu=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Me}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return T(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return T(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Gi}hasEnd(){return this.endSet_}getIndexEndValue(){return T(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return T(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:li}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return T(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Me}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function KG(t){return t.loadsAllData()?new ru(t.getIndex()):t.hasLimit()?new AE(t):new xp(t)}function QG(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function YG(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function xE(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function XG(t,e,n){let r;return t.index_===Ir||n?r=xE(t,e,n):r=xE(t,e,li),r.startAfterSet_=!0,r}function RE(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function ZG(t,e,n){let r;return t.index_===Ir||n?r=RE(t,e,n):r=RE(t,e,Gi),r.endBeforeSet_=!0,r}function Kp(t,e){let n=t.copy();return n.index_=e,n}function iN(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Me?n="$priority":t.index_===EI?n="$value":t.index_===Ir?n="$key":(T(t.index_ instanceof eu,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=st(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=st(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+st(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=st(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+st(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function sN(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Me&&(e.i=t.index_.toString()),e}var ME=class t extends Dp{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=fu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(T(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let l=iN(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),Ei(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=iN(e._queryParams),r=e._path.toString(),i=new yt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+rS(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=ph(a.responseText)}catch{Ut("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Ut("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var NE=class{constructor(){this.rootNode_=J.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Rp(){return{value:null,children:new Map}}function Va(t,e,n){if(ae(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=oe(e);t.children.has(r)||t.children.set(r,Rp());let i=t.children.get(r);e=xe(e),Va(i,e,n)}}function PE(t,e){if(ae(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Me,(r,i)=>{Va(t,new ve(r),i)}),PE(t,e)}}else if(t.children.size>0){let n=oe(e);return e=xe(e),t.children.has(n)&&PE(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function kE(t,e,n){t.value!==null?n(e,t.value):JG(t,(r,i)=>{let s=new ve(e.toString()+"/"+r);kE(i,s,n)})}function JG(t,e){t.children.forEach((n,r)=>{e(r,n)})}var OE=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Et(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var oN=10*1e3,e3=30*1e3,t3=5*60*1e3,FE=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new OE(e);let r=oN+(e3-oN)*Math.random();Wc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;Et(e,(i,s)=>{s>0&&Dn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Wc(this.reportStats_.bind(this),Math.floor(Math.random()*2*t3))}};var Er=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Er||{});function II(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function CI(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function DI(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var LE=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Er.ACK_USER_WRITE,this.source=II()}operationForChild(e){if(ae(this.path)){if(this.affectedTree.value!=null)return T(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new ve(e));return new t(_e(),n,this.revert)}}else return T(oe(this.path)===e,"operationForChild called for unrelated child."),new t(xe(this.path),this.affectedTree,this.revert)}};var Mp=class t{constructor(e,n){this.source=e,this.path=n,this.type=Er.LISTEN_COMPLETE}operationForChild(e){return ae(this.path)?new t(this.source,_e()):new t(this.source,xe(this.path))}};var Pa=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Er.OVERWRITE}operationForChild(e){return ae(this.path)?new t(this.source,_e(),this.snap.getImmediateChild(e)):new t(this.source,xe(this.path),this.snap)}};var su=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Er.MERGE}operationForChild(e){if(ae(this.path)){let n=this.children.subtree(new ve(e));return n.isEmpty()?null:n.value?new Pa(this.source,_e(),n.value):new t(this.source,_e(),n)}else return T(oe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,xe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Dr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ae(e))return this.isFullyInitialized()&&!this.filtered_;let n=oe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var VE=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function n3(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(WG(o.childName,o.snapshotNode))}),Gc(t,i,"child_removed",e,r,n),Gc(t,i,"child_added",e,r,n),Gc(t,i,"child_moved",s,r,n),Gc(t,i,"child_changed",e,r,n),Gc(t,i,"value",e,r,n),i}function Gc(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,l)=>i3(t,a,l)),o.forEach(a=>{let l=r3(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function r3(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function i3(t,e,n){if(e.childName==null||n.childName==null)throw Uo("Should only compare child_ events.");let r=new ce(e.childName,e.snapshotNode),i=new ce(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Qp(t,e){return{eventCache:t,serverCache:e}}function Qc(t,e,n,r){return Qp(new Dr(e,n,r),t.serverCache)}function YN(t,e,n,r){return Qp(t.eventCache,new Dr(e,n,r))}function Np(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Xs(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var oE,s3=()=>(oE||(oE=new Nn(rG)),oE),Zt=class t{constructor(e,n=s3()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Et(e,(r,i)=>{n=n.set(new ve(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:_e(),value:this.value};if(ae(e))return null;{let r=oe(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(xe(e),n);return s!=null?{path:je(new ve(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ae(e))return this;{let n=oe(e),r=this.children.get(n);return r!==null?r.subtree(xe(e)):new t(null)}}set(e,n){if(ae(e))return new t(n,this.children);{let r=oe(e),s=(this.children.get(r)||new t(null)).set(xe(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ae(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=oe(e),r=this.children.get(n);if(r){let i=r.remove(xe(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ae(e))return this.value;{let n=oe(e),r=this.children.get(n);return r?r.get(xe(e)):null}}setTree(e,n){if(ae(e))return n;{let r=oe(e),s=(this.children.get(r)||new t(null)).setTree(xe(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(_e(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(je(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,_e(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ae(e))return null;{let s=oe(e),o=this.children.get(s);return o?o.findOnPath_(xe(e),je(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,_e(),n)}foreachOnPath_(e,n,r){if(ae(e))return this;{this.value&&r(n,this.value);let i=oe(e),s=this.children.get(i);return s?s.foreachOnPath_(xe(e),je(n,i),r):new t(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(je(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Jn=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Zt(null))}};function Yc(t,e,n){if(ae(e))return new Jn(new Zt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Xt(i,e);return s=s.updateChild(o,n),new Jn(t.writeTree_.set(i,s))}else{let i=new Zt(n),s=t.writeTree_.setTree(e,i);return new Jn(s)}}}function jE(t,e,n){let r=t;return Et(n,(i,s)=>{r=Yc(r,je(e,i),s)}),r}function aN(t,e){if(ae(e))return Jn.empty();{let n=t.writeTree_.setTree(e,new Zt(null));return new Jn(n)}}function UE(t,e){return Js(t,e)!=null}function Js(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Xt(n.path,e)):null}function lN(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Me,(r,i)=>{e.push(new ce(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ce(r,i.value))}),e}function Hi(t,e){if(ae(e))return t;{let n=Js(t,e);return n!=null?new Jn(new Zt(n)):new Jn(t.writeTree_.subtree(e))}}function BE(t){return t.writeTree_.isEmpty()}function ka(t,e){return XN(_e(),t.writeTree_,e)}function XN(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(T(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=XN(je(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(je(t,".priority"),r)),n}}function Yp(t,e){return tP(e,t)}function o3(t,e,n,r,i){T(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Yc(t.visibleWrites,e,n)),t.lastWriteId=r}function a3(t,e,n,r){T(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=jE(t.visibleWrites,e,n),t.lastWriteId=r}function l3(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function c3(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);T(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&u3(a,r.path)?i=!1:Mn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return d3(t),!0;if(r.snap)t.visibleWrites=aN(t.visibleWrites,r.path);else{let a=r.children;Et(a,l=>{t.visibleWrites=aN(t.visibleWrites,je(r.path,l))})}return!0}else return!1}function u3(t,e){if(t.snap)return Mn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Mn(je(t.path,n),e))return!0;return!1}function d3(t){t.visibleWrites=ZN(t.allWrites,h3,_e()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function h3(t){return t.visible}function ZN(t,e,n){let r=Jn.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Mn(n,o)?(a=Xt(n,o),r=Yc(r,a,s.snap)):Mn(o,n)&&(a=Xt(o,n),r=Yc(r,_e(),s.snap.getChild(a)));else if(s.children){if(Mn(n,o))a=Xt(n,o),r=jE(r,a,s.children);else if(Mn(o,n))if(a=Xt(o,n),ae(a))r=jE(r,_e(),s.children);else{let l=Ei(s.children,oe(a));if(l){let c=l.getChild(xe(a));r=Yc(r,_e(),c)}}}else throw Uo("WriteRecord should have .snap or .children")}}return r}function JN(t,e,n,r,i){if(!r&&!i){let s=Js(t.visibleWrites,e);if(s!=null)return s;{let o=Hi(t.visibleWrites,e);if(BE(o))return n;if(n==null&&!UE(o,_e()))return null;{let a=n||J.EMPTY_NODE;return ka(o,a)}}}else{let s=Hi(t.visibleWrites,e);if(!i&&BE(s))return n;if(!i&&n==null&&!UE(s,_e()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(Mn(c.path,e)||Mn(e,c.path))},a=ZN(t.allWrites,o,e),l=n||J.EMPTY_NODE;return ka(a,l)}}}function f3(t,e,n){let r=J.EMPTY_NODE,i=Js(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Me,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Hi(t.visibleWrites,e);return n.forEachChild(Me,(o,a)=>{let l=ka(Hi(s,new ve(o)),a);r=r.updateImmediateChild(o,l)}),lN(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Hi(t.visibleWrites,e);return lN(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function p3(t,e,n,r,i){T(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=je(e,n);if(UE(t.visibleWrites,s))return null;{let o=Hi(t.visibleWrites,s);return BE(o)?i.getChild(n):ka(o,i.getChild(n))}}function g3(t,e,n,r){let i=je(e,n),s=Js(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Hi(t.visibleWrites,i);return ka(o,r.getNode().getImmediateChild(n))}else return null}function m3(t,e){return Js(t.visibleWrites,e)}function y3(t,e,n,r,i,s,o){let a,l=Hi(t.visibleWrites,e),c=Js(l,_e());if(c!=null)a=c;else if(n!=null)a=ka(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&u.length<i;)d(f,r)!==0&&u.push(f),f=h.getNext();return u}else return[]}function _3(){return{visibleWrites:Jn.empty(),allWrites:[],lastWriteId:-1}}function Pp(t,e,n,r){return JN(t.writeTree,t.treePath,e,n,r)}function TI(t,e){return f3(t.writeTree,t.treePath,e)}function cN(t,e,n,r){return p3(t.writeTree,t.treePath,e,n,r)}function kp(t,e){return m3(t.writeTree,je(t.treePath,e))}function v3(t,e,n,r,i,s){return y3(t.writeTree,t.treePath,e,n,r,i,s)}function bI(t,e,n){return g3(t.writeTree,t.treePath,e,n)}function eP(t,e){return tP(je(t.treePath,e),t.writeTree)}function tP(t,e){return{treePath:t,writeTree:e}}var $E=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;T(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),T(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,nu(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,tu(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Na(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,nu(r,e.snapshotNode,i.oldSnap));else throw Uo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var qE=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},nP=new qE,ou=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Dr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return bI(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Xs(this.viewCache_),s=v3(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function w3(t){return{filter:t}}function E3(t,e){T(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),T(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function I3(t,e,n,r,i){let s=new $E,o,a;if(n.type===Er.OVERWRITE){let c=n;c.source.fromUser?o=HE(t,e,c.path,c.snap,r,i,s):(T(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ae(c.path),o=Op(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===Er.MERGE){let c=n;c.source.fromUser?o=D3(t,e,c.path,c.children,r,i,s):(T(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=zE(t,e,c.path,c.children,r,i,a,s))}else if(n.type===Er.ACK_USER_WRITE){let c=n;c.revert?o=S3(t,e,c.path,r,i,s):o=T3(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===Er.LISTEN_COMPLETE)o=b3(t,e,n.path,r,s);else throw Uo("Unknown operation type: "+n.type);let l=s.getChanges();return C3(e,o,l),{viewCache:o,changes:l}}function C3(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Np(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(QN(Np(e)))}}function rP(t,e,n,r,i,s){let o=e.eventCache;if(kp(r,n)!=null)return e;{let a,l;if(ae(n))if(T(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Xs(e),u=c instanceof J?c:J.EMPTY_NODE,d=TI(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=Pp(r,Xs(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=oe(n);if(c===".priority"){T(Wi(n)===1,"Can't have a priority with additional path components");let u=o.getNode();l=e.serverCache.getNode();let d=cN(r,n,u,l);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=xe(n),d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let h=cN(r,n,o.getNode(),l);h!=null?d=o.getNode().getImmediateChild(c).updateChild(u,h):d=o.getNode().getImmediateChild(c)}else d=bI(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,u,i,s):a=o.getNode()}}return Qc(e,a,o.isFullyInitialized()||ae(n),t.filter.filtersNodes())}}function Op(t,e,n,r,i,s,o,a){let l=e.serverCache,c,u=o?t.filter:t.filter.getIndexedFilter();if(ae(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){let f=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),f,null)}else{let f=oe(n);if(!l.isCompleteForPath(n)&&Wi(n)>1)return e;let p=xe(n),m=l.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=u.updatePriority(l.getNode(),m):c=u.updateChild(l.getNode(),f,m,p,nP,null)}let d=YN(e,c,l.isFullyInitialized()||ae(n),u.filtersNodes()),h=new ou(i,d,s);return rP(t,d,n,i,h,a)}function HE(t,e,n,r,i,s,o){let a=e.eventCache,l,c,u=new ou(i,e,s);if(ae(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Qc(e,c,!0,t.filter.filtersNodes());else{let d=oe(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),l=Qc(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=xe(n),f=a.getNode().getImmediateChild(d),p;if(ae(h))p=r;else{let g=u.getCompleteChild(d);g!=null?yI(h)===".priority"&&g.getChild(qN(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=J.EMPTY_NODE}if(f.equals(p))l=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,u,o);l=Qc(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function uN(t,e){return t.eventCache.isCompleteForChild(e)}function D3(t,e,n,r,i,s,o){let a=e;return r.foreach((l,c)=>{let u=je(n,l);uN(e,oe(u))&&(a=HE(t,a,u,c,i,s,o))}),r.foreach((l,c)=>{let u=je(n,l);uN(e,oe(u))||(a=HE(t,a,u,c,i,s,o))}),a}function dN(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function zE(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;ae(n)?c=r:c=new Zt(null).setTree(n,r);let u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=dN(t,f,h);l=Op(t,l,new ve(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=dN(t,p,h);l=Op(t,l,new ve(d),g,i,s,o,a)}}),l}function T3(t,e,n,r,i,s,o){if(kp(i,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ae(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Op(t,e,n,l.getNode().getChild(n),i,s,a,o);if(ae(n)){let c=new Zt(null);return l.getNode().forEachChild(Ir,(u,d)=>{c=c.set(new ve(u),d)}),zE(t,e,n,c,i,s,a,o)}else return e}else{let c=new Zt(null);return r.foreach((u,d)=>{let h=je(n,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),zE(t,e,n,c,i,s,a,o)}}function b3(t,e,n,r,i){let s=e.serverCache,o=YN(e,s.getNode(),s.isFullyInitialized()||ae(n),s.isFiltered());return rP(t,o,n,r,nP,i)}function S3(t,e,n,r,i,s){let o;if(kp(r,n)!=null)return e;{let a=new ou(r,e,i),l=e.eventCache.getNode(),c;if(ae(n)||oe(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Pp(r,Xs(e));else{let d=e.serverCache.getNode();T(d instanceof J,"serverChildren would be complete if leaf node"),u=TI(r,d)}u=u,c=t.filter.updateFullNode(l,u,s)}else{let u=oe(n),d=bI(r,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=t.filter.updateChild(l,u,d,xe(n),a,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,J.EMPTY_NODE,xe(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Pp(r,Xs(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||kp(r,_e())!=null,Qc(e,c,o,t.filter.filtersNodes())}}var GE=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new ru(r.getIndex()),s=KG(r);this.processor_=w3(s);let o=n.serverCache,a=n.eventCache,l=i.updateFullNode(J.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(J.EMPTY_NODE,a.getNode(),null),u=new Dr(l,o.isFullyInitialized(),i.filtersNodes()),d=new Dr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Qp(d,u),this.eventGenerator_=new VE(this.query_)}get query(){return this.query_}};function A3(t){return t.viewCache_.serverCache.getNode()}function x3(t){return Np(t.viewCache_)}function R3(t,e){let n=Xs(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ae(e)&&!n.getImmediateChild(oe(e)).isEmpty())?n.getChild(e):null}function hN(t){return t.eventRegistrations_.length===0}function M3(t,e){t.eventRegistrations_.push(e)}function fN(t,e,n){let r=[];if(n){T(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function pN(t,e,n,r){e.type===Er.MERGE&&e.source.queryId!==null&&(T(Xs(t.viewCache_),"We should always have a full cache before handling merges"),T(Np(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=I3(t.processor_,i,e,n,r);return E3(t.processor_,s.viewCache),T(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,iP(t,s.changes,s.viewCache.eventCache.getNode(),null)}function N3(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Me,(s,o)=>{r.push(Na(s,o))}),n.isFullyInitialized()&&r.push(QN(n.getNode())),iP(t,r,n.getNode(),e)}function iP(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return n3(t.eventGenerator_,e,n,i)}var Fp,Lp=class{constructor(){this.views=new Map}};function P3(t){T(!Fp,"__referenceConstructor has already been defined"),Fp=t}function k3(){return T(Fp,"Reference.ts has not been loaded"),Fp}function O3(t){return t.views.size===0}function SI(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return T(s!=null,"SyncTree gave us an op for an invalid query."),pN(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(pN(o,e,n,r));return s}}function sP(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Pp(n,i?r:null),l=!1;a?l=!0:r instanceof J?(a=TI(n,r),l=!1):(a=J.EMPTY_NODE,l=!1);let c=Qp(new Dr(a,l,!1),new Dr(r,i,!1));return new GE(e,c)}return o}function F3(t,e,n,r,i,s){let o=sP(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),M3(o,n),N3(o,n)}function L3(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=Ki(t);if(i==="default")for(let[l,c]of t.views.entries())o=o.concat(fN(c,n,r)),hN(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=t.views.get(i);l&&(o=o.concat(fN(l,n,r)),hN(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!Ki(t)&&s.push(new(k3())(e._repo,e._path)),{removed:s,events:o}}function oP(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function zi(t,e){let n=null;for(let r of t.views.values())n=n||R3(r,e);return n}function aP(t,e){if(e._queryParams.loadsAllData())return Xp(t);{let r=e._queryIdentifier;return t.views.get(r)}}function lP(t,e){return aP(t,e)!=null}function Ki(t){return Xp(t)!=null}function Xp(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Vp;function V3(t){T(!Vp,"__referenceConstructor has already been defined"),Vp=t}function j3(){return T(Vp,"Reference.ts has not been loaded"),Vp}var U3=1,jp=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Zt(null),this.pendingWriteTree_=_3(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function AI(t,e,n,r,i){return o3(t.pendingWriteTree_,e,n,r,i),i?ja(t,new Pa(II(),e,n)):[]}function B3(t,e,n,r){a3(t.pendingWriteTree_,e,n,r);let i=Zt.fromObject(n);return ja(t,new su(II(),e,i))}function qi(t,e,n=!1){let r=l3(t.pendingWriteTree_,e);if(c3(t.pendingWriteTree_,e)){let s=new Zt(null);return r.snap!=null?s=s.set(_e(),!0):Et(r.children,o=>{s=s.set(new ve(o),!0)}),ja(t,new LE(r.path,s,n))}else return[]}function gu(t,e,n){return ja(t,new Pa(CI(),e,n))}function $3(t,e,n){let r=Zt.fromObject(n);return ja(t,new su(CI(),e,r))}function q3(t,e){return ja(t,new Mp(CI(),e))}function H3(t,e,n){let r=xI(t,n);if(r){let i=RI(r),s=i.path,o=i.queryId,a=Xt(s,e),l=new Mp(DI(o),a);return MI(t,s,l)}else return[]}function Up(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||lP(o,e))){let l=L3(o,e,n,r);O3(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=l.removed;if(a=l.events,!i){let u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Ki(f));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=W3(h);for(let p=0;p<f.length;++p){let g=f[p],m=g.query,w=hP(t,g);t.listenProvider_.startListening(Xc(m),au(t,m),w.hashFn,w.onComplete)}}}!d&&c.length>0&&!r&&(u?t.listenProvider_.stopListening(Xc(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(Jp(h));t.listenProvider_.stopListening(Xc(h),f)}))}K3(t,c)}return a}function cP(t,e,n,r){let i=xI(t,r);if(i!=null){let s=RI(i),o=s.path,a=s.queryId,l=Xt(o,e),c=new Pa(DI(a),l,n);return MI(t,o,c)}else return[]}function z3(t,e,n,r){let i=xI(t,r);if(i){let s=RI(i),o=s.path,a=s.queryId,l=Xt(o,e),c=Zt.fromObject(n),u=new su(DI(a),l,c);return MI(t,o,u)}else return[]}function WE(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Xt(h,i);s=s||zi(f,p),o=o||Ki(f)});let a=t.syncPointTree_.get(i);a?(o=o||Ki(a),s=s||zi(a,_e())):(a=new Lp,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=J.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=zi(p,_e());g&&(s=s.updateImmediateChild(f,g))}));let c=lP(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=Jp(e);T(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=Q3();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let u=Yp(t.pendingWriteTree_,i),d=F3(a,e,n,u,s,l);if(!c&&!o&&!r){let h=aP(a,e);d=d.concat(Y3(t,e,h))}return d}function Zp(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let l=Xt(o,e),c=zi(a,l);if(c)return c});return JN(i,e,s,n,!0)}function G3(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{let d=Xt(c,n);r=r||zi(u,d)});let i=t.syncPointTree_.get(n);i?r=r||zi(i,_e()):(i=new Lp,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Dr(r,!0,!1):null,a=Yp(t.pendingWriteTree_,e._path),l=sP(i,e,a,s?o.getNode():J.EMPTY_NODE,s);return x3(l)}function ja(t,e){return uP(e,t.syncPointTree_,null,Yp(t.pendingWriteTree_,_e()))}function uP(t,e,n,r){if(ae(t.path))return dP(t,e,n,r);{let i=e.get(_e());n==null&&i!=null&&(n=zi(i,_e()));let s=[],o=oe(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){let c=n?n.getImmediateChild(o):null,u=eP(r,o);s=s.concat(uP(a,l,c,u))}return i&&(s=s.concat(SI(i,t,r,n))),s}}function dP(t,e,n,r){let i=e.get(_e());n==null&&i!=null&&(n=zi(i,_e()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=n?n.getImmediateChild(o):null,c=eP(r,o),u=t.operationForChild(o);u&&(s=s.concat(dP(u,a,l,c)))}),i&&(s=s.concat(SI(i,t,r,n))),s}function hP(t,e){let n=e.query,r=au(t,n);return{hashFn:()=>(A3(e)||J.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?H3(t,n._path,r):q3(t,n._path);{let s=oG(i,n);return Up(t,n,null,s)}}}}function au(t,e){let n=Jp(e);return t.queryToTagMap.get(n)}function Jp(t){return t._path.toString()+"$"+t._queryIdentifier}function xI(t,e){return t.tagToQueryMap.get(e)}function RI(t){let e=t.indexOf("$");return T(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ve(t.substr(0,e))}}function MI(t,e,n){let r=t.syncPointTree_.get(e);T(r,"Missing sync point for query tag that we're tracking");let i=Yp(t.pendingWriteTree_,e);return SI(r,n,i,null)}function W3(t){return t.fold((e,n,r)=>{if(n&&Ki(n))return[Xp(n)];{let i=[];return n&&(i=oP(n)),Et(r,(s,o)=>{i=i.concat(o)}),i}})}function Xc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(j3())(t._repo,t._path):t}function K3(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Jp(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function Q3(){return U3++}function Y3(t,e,n){let r=e._path,i=au(t,e),s=hP(t,n),o=t.listenProvider_.startListening(Xc(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)T(!Ki(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,u,d)=>{if(!ae(c)&&u&&Ki(u))return[Xp(u).query];{let h=[];return u&&(h=h.concat(oP(u).map(f=>f.query))),Et(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<l.length;++c){let u=l[c];t.listenProvider_.stopListening(Xc(u),au(t,u))}}return o}var KE=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},QE=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=je(this.path_,e);return new t(this.syncTree_,n)}node(){return Zp(this.syncTree_,this.path_)}},X3=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},gN=function(t,e,n){if(!t||typeof t!="object")return t;if(T(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Z3(t[".sv"],e,n);if(typeof t[".sv"]=="object")return J3(t[".sv"],e);T(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Z3=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:T(!1,"Unexpected server value: "+t)}},J3=function(t,e,n){t.hasOwnProperty("increment")||T(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&T(!1,"Unexpected increment value: "+r);let i=e.node();if(T(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},fP=function(t,e,n,r){return PI(e,new QE(n,t),r)},NI=function(t,e,n){return PI(t,new KE(e),n)};function PI(t,e,n){let r=t.getPriority().val(),i=gN(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=gN(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Ra(a,qe(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ra(i))),o.forEachChild(Me,(a,l)=>{let c=PI(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var lu=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function eg(t,e){let n=e instanceof ve?e:new ve(e),r=t,i=oe(n);for(;i!==null;){let s=Ei(r.node.children,i)||{children:{},childCount:0};r=new lu(i,r,s),n=xe(n),i=oe(n)}return r}function eo(t){return t.node.value}function kI(t,e){t.node.value=e,YE(t)}function pP(t){return t.node.childCount>0}function eW(t){return eo(t)===void 0&&!pP(t)}function tg(t,e){Et(t.node.children,(n,r)=>{e(new lu(n,t,r))})}function gP(t,e,n,r){n&&!r&&e(t),tg(t,i=>{gP(i,e,!0,r)}),n&&r&&e(t)}function tW(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function mu(t){return new ve(t.parent===null?t.name:mu(t.parent)+"/"+t.name)}function YE(t){t.parent!==null&&nW(t.parent,t.name,t)}function nW(t,e,n){let r=eW(n),i=Dn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,YE(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,YE(t))}var rW=/[\[\].#$\/\u0000-\u001F\u007F]/,iW=/[\[\].#$\u0000-\u001F\u007F]/,aE=10*1024*1024,ng=function(t){return typeof t=="string"&&t.length!==0&&!rW.test(t)},mP=function(t){return typeof t=="string"&&t.length!==0&&!iW.test(t)},sW=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),mP(t)},cu=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Wp(t)||t&&typeof t=="object"&&Dn(t,".sv")},Tr=function(t,e,n,r){r&&e===void 0||yu(on(t,"value"),e,n)},yu=function(t,e,n){let r=n instanceof ve?new wE(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ks(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ks(r)+" with contents = "+e.toString());if(Wp(e))throw new Error(t+"contains "+e.toString()+" "+Ks(r));if(typeof e=="string"&&e.length>aE/3&&tc(e)>aE)throw new Error(t+"contains a string greater than "+aE+" utf8 bytes "+Ks(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Et(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!ng(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ks(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);OG(r,o),yu(t,a,r),FG(r)}),i&&s)throw new Error(t+' contains ".value" child '+Ks(r)+" in addition to actual children.")}},oW=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Jc(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!ng(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(kG);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Mn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},yP=function(t,e,n,r){if(r&&e===void 0)return;let i=on(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Et(e,(o,a)=>{let l=new ve(o);if(yu(i,a,je(n,l)),yI(l)===".priority"&&!cu(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),oW(i,s)},OI=function(t,e,n){if(!(n&&e===void 0)){if(Wp(e))throw new Error(on(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!cu(e))throw new Error(on(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},_u=function(t,e,n,r){if(!(r&&n===void 0)&&!ng(n))throw new Error(on(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Ua=function(t,e,n,r){if(!(r&&n===void 0)&&!mP(n))throw new Error(on(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},aW=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ua(t,e,n,r)},pn=function(t,e){if(oe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},_P=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!ng(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!sW(n))throw new Error(on(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var XE=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function rg(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!_I(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function vP(t,e,n){rg(t,n),wP(t,r=>_I(r,e))}function gn(t,e,n){rg(t,n),wP(t,r=>Mn(r,e)||Mn(e,r))}function wP(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(lW(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function lW(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();Ys&&wt("event: "+n.toString()),La(r)}}}var EP="repo_interrupt",cW=25,ZE=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new XE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Rp(),this.transactionQueueTree_=new lu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function uW(t,e,n){if(t.stats_=mI(t.repoInfo_),t.forceRestClient_||uG())t.server_=new ME(t.repoInfo_,(r,i,s,o)=>{mN(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>yN(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{st(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new vI(t.repoInfo_,e,(r,i,s,o)=>{mN(t,r,i,s,o)},r=>{yN(t,r)},r=>{dW(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=hG(t.repoInfo_,()=>new FE(t.stats_,t.server_)),t.infoData_=new NE,t.infoSyncTree_=new jp({startListening:(r,i,s,o)=>{let a=[],l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=gu(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),FI(t,"connected",!1),t.serverSyncTree_=new jp({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,l)=>{let c=o(a,l);gn(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function IP(t){let n=t.infoData_.getNode(new ve(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function vu(t){return X3({timestamp:IP(t)})}function mN(t,e,n,r,i){t.dataUpdateCount++;let s=new ve(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let l=ec(n,c=>qe(c));o=z3(t.serverSyncTree_,s,l,i)}else{let l=qe(n);o=cP(t.serverSyncTree_,s,l,i)}else if(r){let l=ec(n,c=>qe(c));o=$3(t.serverSyncTree_,s,l)}else{let l=qe(n);o=gu(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Oa(t,s)),gn(t.eventQueue_,a,o)}function yN(t,e){FI(t,"connected",e),e===!1&&pW(t)}function dW(t,e){Et(e,(n,r)=>{FI(t,n,r)})}function FI(t,e,n){let r=new ve("/.info/"+e),i=qe(n);t.infoData_.updateSnapshot(r,i);let s=gu(t.infoSyncTree_,r,i);gn(t.eventQueue_,r,s)}function ig(t){return t.nextWriteId_++}function hW(t,e,n){let r=G3(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=qe(i).withIndex(e._queryParams.getIndex());WE(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=gu(t.serverSyncTree_,e._path,s);else{let a=au(t.serverSyncTree_,e);o=cP(t.serverSyncTree_,e._path,s,a)}return gn(t.eventQueue_,e._path,o),Up(t.serverSyncTree_,e,n,null,!0),s},i=>(Ba(t,"get for query "+st(e)+" failed: "+i),Promise.reject(new Error(i))))}function LI(t,e,n,r,i){Ba(t,"set",{path:e.toString(),value:n,priority:r});let s=vu(t),o=qe(n,r),a=Zp(t.serverSyncTree_,e),l=NI(o,a,s),c=ig(t),u=AI(t.serverSyncTree_,e,l,c,!0);rg(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Ut("set at "+e+" failed: "+h);let g=qi(t.serverSyncTree_,c,!p);gn(t.eventQueue_,e,g),Qi(t,i,h,f)});let d=jI(t,e);Oa(t,d),gn(t.eventQueue_,d,[])}function fW(t,e,n,r){Ba(t,"update",{path:e.toString(),value:n});let i=!0,s=vu(t),o={};if(Et(n,(a,l)=>{i=!1,o[a]=fP(je(e,a),qe(l),t.serverSyncTree_,s)}),i)wt("update() called with empty data.  Don't do anything."),Qi(t,r,"ok",void 0);else{let a=ig(t),l=B3(t.serverSyncTree_,e,o,a);rg(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{let d=c==="ok";d||Ut("update at "+e+" failed: "+c);let h=qi(t.serverSyncTree_,a,!d),f=h.length>0?Oa(t,e):e;gn(t.eventQueue_,f,h),Qi(t,r,c,u)}),Et(n,c=>{let u=jI(t,je(e,c));Oa(t,u)}),gn(t.eventQueue_,e,[])}}function pW(t){Ba(t,"onDisconnectEvents");let e=vu(t),n=Rp();kE(t.onDisconnect_,_e(),(i,s)=>{let o=fP(i,s,t.serverSyncTree_,e);Va(n,i,o)});let r=[];kE(n,_e(),(i,s)=>{r=r.concat(gu(t.serverSyncTree_,i,s));let o=jI(t,i);Oa(t,o)}),t.onDisconnect_=Rp(),gn(t.eventQueue_,_e(),r)}function gW(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&PE(t.onDisconnect_,e),Qi(t,n,r,i)})}function _N(t,e,n,r){let i=qe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Va(t.onDisconnect_,e,i),Qi(t,r,s,o)})}function mW(t,e,n,r,i){let s=qe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Va(t.onDisconnect_,e,s),Qi(t,i,o,a)})}function yW(t,e,n,r){if(gh(n)){wt("onDisconnect().update() called with empty data.  Don't do anything."),Qi(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Et(n,(o,a)=>{let l=qe(a);Va(t.onDisconnect_,je(e,o),l)}),Qi(t,r,i,s)})}function _W(t,e,n){let r;oe(e._path)===".info"?r=WE(t.infoSyncTree_,e,n):r=WE(t.serverSyncTree_,e,n),vP(t.eventQueue_,e._path,r)}function JE(t,e,n){let r;oe(e._path)===".info"?r=Up(t.infoSyncTree_,e,n):r=Up(t.serverSyncTree_,e,n),vP(t.eventQueue_,e._path,r)}function CP(t){t.persistentConnection_&&t.persistentConnection_.interrupt(EP)}function vW(t){t.persistentConnection_&&t.persistentConnection_.resume(EP)}function Ba(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),wt(n,...e)}function Qi(t,e,n,r){e&&La(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function wW(t,e,n,r,i,s){Ba(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:IN(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=VI(t,e,void 0);o.currentInputSnapshot=a;let l=o.update(a.val());if(l===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{yu("transaction failed: Data returned ",l,o.path),o.status=0;let c=eg(t.transactionQueueTree_,e),u=eo(c)||[];u.push(o),kI(c,u);let d;typeof l=="object"&&l!==null&&Dn(l,".priority")?(d=Ei(l,".priority"),T(cu(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Zp(t.serverSyncTree_,e)||J.EMPTY_NODE).getPriority().val();let h=vu(t),f=qe(l,d),p=NI(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=ig(t);let g=AI(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);gn(t.eventQueue_,e,g),sg(t,t.transactionQueueTree_)}}function VI(t,e,n){return Zp(t.serverSyncTree_,e,n)||J.EMPTY_NODE}function sg(t,e=t.transactionQueueTree_){if(e||og(t,e),eo(e)){let n=TP(t,e);T(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&EW(t,mu(e),n)}else pP(e)&&tg(e,n=>{sg(t,n)})}function EW(t,e,n){let r=n.map(c=>c.currentWriteId),i=VI(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let u=n[c];T(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=Xt(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{Ba(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(qi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();og(t,eg(t.transactionQueueTree_,e)),sg(t,t.transactionQueueTree_),gn(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)La(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Ut("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}Oa(t,e)}},o)}function Oa(t,e){let n=DP(t,e),r=mu(n),i=TP(t,n);return IW(t,i,r),r}function IW(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=Xt(n,l.path),u=!1,d;if(T(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,i=i.concat(qi(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=cW)u=!0,d="maxretry",i=i.concat(qi(t.serverSyncTree_,l.currentWriteId,!0));else{let h=VI(t,l.path,o);l.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){yu("transaction failed: Data returned ",f,l.path);let p=qe(f);typeof f=="object"&&f!=null&&Dn(f,".priority")||(p=p.updatePriority(h.getPriority()));let m=l.currentWriteId,w=vu(t),S=NI(p,h,w);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=S,l.currentWriteId=ig(t),o.splice(o.indexOf(m),1),i=i.concat(AI(t.serverSyncTree_,l.path,S,l.currentWriteId,l.applyLocally)),i=i.concat(qi(t.serverSyncTree_,m,!0))}else u=!0,d="nodata",i=i.concat(qi(t.serverSyncTree_,l.currentWriteId,!0))}gn(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}og(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)La(r[a]);sg(t,t.transactionQueueTree_)}function DP(t,e){let n,r=t.transactionQueueTree_;for(n=oe(e);n!==null&&eo(r)===void 0;)r=eg(r,n),e=xe(e),n=oe(e);return r}function TP(t,e){let n=[];return bP(t,e,n),n.sort((r,i)=>r.order-i.order),n}function bP(t,e,n){let r=eo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);tg(e,i=>{bP(t,i,n)})}function og(t,e){let n=eo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,kI(e,n.length>0?n:void 0)}tg(e,r=>{og(t,r)})}function jI(t,e){let n=mu(DP(t,e)),r=eg(t.transactionQueueTree_,e);return tW(r,i=>{lE(t,i)}),lE(t,r),gP(r,i=>{lE(t,i)}),n}function lE(t,e){let n=eo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(T(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(T(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(qi(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?kI(e,void 0):n.length=s+1,gn(t.eventQueue_,mu(e),i);for(let o=0;o<r.length;o++)La(r[o])}}function CW(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function DW(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ut(`Invalid query segment '${n}' in query '${t}'`)}return e}var eI=function(t,e){let n=TW(t),r=n.namespace;n.domain==="firebase.com"&&Cr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Cr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||tG();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Ip(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new ve(n.pathString)}},TW=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(i=CW(t.substring(u,d)));let h=DW(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var vN="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",bW=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=vN.charAt(n%64),n=Math.floor(n/64);T(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=vN.charAt(e[i]);return T(o.length===20,"nextPushId: Length should be 20."),o}}();var Bp=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+st(this.snapshot.exportVal())}},$p=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var uu=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return T(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var qp=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new yt;return gW(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){pn("OnDisconnect.remove",this._path);let e=new yt;return _N(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){pn("OnDisconnect.set",this._path),Tr("OnDisconnect.set",e,this._path,!1);let n=new yt;return _N(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){pn("OnDisconnect.setWithPriority",this._path),Tr("OnDisconnect.setWithPriority",e,this._path,!1),OI("OnDisconnect.setWithPriority",n,!1);let r=new yt;return mW(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){pn("OnDisconnect.update",this._path),yP("OnDisconnect.update",e,this._path,!1);let n=new yt;return yW(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Jt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ae(this._path)?null:yI(this._path)}get ref(){return new mn(this._repo,this._path)}get _queryIdentifier(){let e=sN(this._queryParams),n=gI(e);return n==="{}"?"default":n}get _queryObject(){return sN(this._queryParams)}isEqual(e){if(e=W(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=_I(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+PG(this._path)}};function ag(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Xi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ir){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Gi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==li)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Me){if(e!=null&&!cu(e)||n!=null&&!cu(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(T(t.getIndex()instanceof eu||t.getIndex()===EI,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function lg(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var mn=class t extends Jt{constructor(e,n){super(e,n,new iu,!1)}get parent(){let e=qN(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Fa=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new ve(e),r=Yi(this.ref,e);return new t(this._node.getChild(n),r,Me)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Yi(this.ref,r),Me)))}hasChild(e){let n=new ve(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function UI(t,e){return t=W(t),t._checkNotDeleted("ref"),e!==void 0?Yi(t._root,e):t._root}function BI(t,e){t=W(t),t._checkNotDeleted("refFromURL");let n=eI(e,t._repo.repoInfo_.nodeAdmin);_P("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Cr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),UI(t,n.path.toString())}function Yi(t,e){return t=W(t),oe(t._path)===null?aW("child","path",e,!1):Ua("child","path",e,!1),new mn(t._repo,je(t._path,e))}function SP(t,e){t=W(t),pn("push",t._path),Tr("push",e,t._path,!0);let n=IP(t._repo),r=bW(n),i=Yi(t,r),s=Yi(t,r),o;return e!=null?o=cg(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function AP(t){return pn("remove",t._path),cg(t,null)}function cg(t,e){t=W(t),pn("set",t._path),Tr("set",e,t._path,!1);let n=new yt;return LI(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function xP(t,e){t=W(t),pn("setPriority",t._path),OI("setPriority",e,!1);let n=new yt;return LI(t._repo,je(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function RP(t,e,n){if(pn("setWithPriority",t._path),Tr("setWithPriority",e,t._path,!1),OI("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new yt;return LI(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function MP(t,e){yP("update",e,t._path,!1);let n=new yt;return fW(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function NP(t){t=W(t);let e=new uu(()=>{}),n=new du(e);return hW(t._repo,t,n).then(r=>new Fa(r,new mn(t._repo,t._path),t._queryParams.getIndex()))}var du=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Bp("value",this,new Fa(e.snapshotNode,new mn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new $p(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Hp=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new $p(this,e,n):null}createEvent(e,n){T(e.childName!=null,"Child events should have a childName.");let r=Yi(new mn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Bp(e.type,this,new Fa(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function wu(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let l=n,c=(u,d)=>{JE(t._repo,t,a),l(u,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new uu(n,s||void 0),a=e==="value"?new du(o):new Hp(e,o);return _W(t._repo,t,a),()=>JE(t._repo,t,a)}function ug(t,e,n,r){return wu(t,"value",e,n,r)}function $I(t,e,n,r){return wu(t,"child_added",e,n,r)}function qI(t,e,n,r){return wu(t,"child_changed",e,n,r)}function HI(t,e,n,r){return wu(t,"child_moved",e,n,r)}function zI(t,e,n,r){return wu(t,"child_removed",e,n,r)}function GI(t,e,n){let r=null,i=n?new uu(n):null;e==="value"?r=new du(i):e&&(r=new Hp(e,i)),JE(t._repo,t,r)}var yn=class{},zp=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Tr("endAt",this._value,e._path,!0);let n=RE(e._queryParams,this._value,this._key);if(lg(n),Xi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function PP(t,e){return _u("endAt","key",e,!0),new zp(t,e)}var tI=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Tr("endBefore",this._value,e._path,!1);let n=ZG(e._queryParams,this._value,this._key);if(lg(n),Xi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function kP(t,e){return _u("endBefore","key",e,!0),new tI(t,e)}var Gp=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Tr("startAt",this._value,e._path,!0);let n=xE(e._queryParams,this._value,this._key);if(lg(n),Xi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function OP(t=null,e){return _u("startAt","key",e,!0),new Gp(t,e)}var nI=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Tr("startAfter",this._value,e._path,!1);let n=XG(e._queryParams,this._value,this._key);if(lg(n),Xi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function FP(t,e){return _u("startAfter","key",e,!0),new nI(t,e)}var rI=class extends yn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Jt(e._repo,e._path,QG(e._queryParams,this._limit),e._orderByCalled)}};function LP(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new rI(t)}var iI=class extends yn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Jt(e._repo,e._path,YG(e._queryParams,this._limit),e._orderByCalled)}};function VP(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new iI(t)}var sI=class extends yn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){ag(e,"orderByChild");let n=new ve(this._path);if(ae(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new eu(n),i=Kp(e._queryParams,r);return Xi(i),new Jt(e._repo,e._path,i,!0)}};function jP(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Ua("orderByChild","path",t,!1),new sI(t)}var oI=class extends yn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){ag(e,"orderByKey");let n=Kp(e._queryParams,Ir);return Xi(n),new Jt(e._repo,e._path,n,!0)}};function UP(){return new oI}var aI=class extends yn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){ag(e,"orderByPriority");let n=Kp(e._queryParams,Me);return Xi(n),new Jt(e._repo,e._path,n,!0)}};function BP(){return new aI}var lI=class extends yn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){ag(e,"orderByValue");let n=Kp(e._queryParams,EI);return Xi(n),new Jt(e._repo,e._path,n,!0)}};function $P(){return new lI}var cI=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Tr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new zp(this._value,this._key)._apply(new Gp(this._value,this._key)._apply(e))}};function qP(t,e){return _u("equalTo","key",e,!0),new cI(t,e)}function Pn(t,...e){let n=W(t);for(let r of e)n=r._apply(n);return n}P3(mn);V3(mn);var SW="FIREBASE_DATABASE_EMULATOR_HOST",uI={},AW=!1;function xW(t,e,n,r){t.repoInfo_=new Ip(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function WI(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Cr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),wt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=eI(s,i),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[SW]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=eI(s,i),a=o.repoInfo):l=!o.repoInfo.secure;let u=i&&l?new Kc(Kc.OWNER):new pE(t.name,t.options,e);_P("Invalid Firebase Database URL",o),ae(o.path)||Cr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=MW(a,t,u,new fE(t.name,n));return new dI(d,t)}function RW(t,e){let n=uI[e];(!n||n[t.key]!==t)&&Cr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),CP(t),delete n[t.key]}function MW(t,e,n,r){let i=uI[e.name];i||(i={},uI[e.name]=i);let s=i[t.toURLString()];return s&&Cr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ZE(t,AW,n,r),i[t.toURLString()]=s,s}var dI=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(uW(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new mn(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(RW(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Cr("Cannot call "+e+" on a deleted database.")}};function HP(){$N.IS_TRANSPORT_INITIALIZED&&Ut("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function zP(){HP(),Zc.forceDisallow()}function GP(){HP(),ba.forceDisallow(),Zc.forceAllow()}function WP(t,e,n,r={}){t=W(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Cr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Cr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Kc(Kc.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Bo(r.mockUserToken,t.app.options.projectId);s=new Kc(o)}xW(i,e,n,s)}function KP(t){t=W(t),t._checkNotDeleted("goOffline"),CP(t._repo)}function QP(t){t=W(t),t._checkNotDeleted("goOnline"),vW(t._repo)}function YP(t,e){DN(t,e)}function NW(t){pI($o),Hr(new St("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return WI(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),an($M,qM,t),an($M,qM,"esm2017")}var PW={".sv":"timestamp"};function XP(){return PW}function ZP(t){return{".sv":{increment:t}}}var hI=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function JP(t,e,n){var r;if(t=W(t),pn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new yt,o=(l,c,u)=>{let d=null;l?s.reject(l):(d=new Fa(u,new mn(t._repo,t._path),Me),s.resolve(new hI(c,d)))},a=ug(t,()=>{});return wW(t._repo,t._path,e,o,a,i),s.promise}vI.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};vI.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};NW();var kW="@firebase/database-compat",OW="1.0.3";var FW=new Ii("@firebase/database-compat"),ek=function(t){let e="FIREBASE WARNING: "+t;FW.warn(e)};var LW=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(on(t,e)+"must be a boolean.")},VW=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(on(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var KI=class{constructor(e){this._delegate=e}cancel(e){z("OnDisconnect.cancel",0,1,arguments.length),pt("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){z("OnDisconnect.remove",0,1,arguments.length),pt("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){z("OnDisconnect.set",1,2,arguments.length),pt("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("OnDisconnect.setWithPriority",2,3,arguments.length),pt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(z("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ek("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}pt("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var QI=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return z("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var to=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return z("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return z("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return z("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return z("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return z("DataSnapshot.child",0,1,arguments.length),e=String(e),Ua("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return z("DataSnapshot.hasChild",1,1,arguments.length),Ua("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return z("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return z("DataSnapshot.forEach",1,1,arguments.length),pt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return z("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return z("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return z("DataSnapshot.ref",0,0,arguments.length),new ci(this._database,this._delegate.ref)}get ref(){return this.getRef()}},dg=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;z("Query.on",2,4,arguments.length),pt("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,u)=>{n.call(o.context,new to(this.database,c),u)};a.userCallback=n,a.context=o.context;let l=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return ug(this._delegate,a,l),n;case"child_added":return $I(this._delegate,a,l),n;case"child_removed":return zI(this._delegate,a,l),n;case"child_changed":return qI(this._delegate,a,l),n;case"child_moved":return HI(this._delegate,a,l),n;default:throw new Error(on("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(z("Query.off",0,3,arguments.length),VW("Query.off",e,!0),pt("Query.off","callback",n,!0),Xy("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,GI(this._delegate,e,i)}else GI(this._delegate,e)}get(){return NP(this._delegate).then(e=>new to(this.database,e))}once(e,n,r,i){z("Query.once",1,4,arguments.length),pt("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new yt,a=(c,u)=>{let d=new to(this.database,c);n&&n.call(s.context,d,u),o.resolve(d)};a.userCallback=n,a.context=s.context;let l=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":ug(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":$I(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":zI(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":qI(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":HI(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(on("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return z("Query.limitToFirst",1,1,arguments.length),new t(this.database,Pn(this._delegate,LP(e)))}limitToLast(e){return z("Query.limitToLast",1,1,arguments.length),new t(this.database,Pn(this._delegate,VP(e)))}orderByChild(e){return z("Query.orderByChild",1,1,arguments.length),new t(this.database,Pn(this._delegate,jP(e)))}orderByKey(){return z("Query.orderByKey",0,0,arguments.length),new t(this.database,Pn(this._delegate,UP()))}orderByPriority(){return z("Query.orderByPriority",0,0,arguments.length),new t(this.database,Pn(this._delegate,BP()))}orderByValue(){return z("Query.orderByValue",0,0,arguments.length),new t(this.database,Pn(this._delegate,$P()))}startAt(e=null,n){return z("Query.startAt",0,2,arguments.length),new t(this.database,Pn(this._delegate,OP(e,n)))}startAfter(e=null,n){return z("Query.startAfter",0,2,arguments.length),new t(this.database,Pn(this._delegate,FP(e,n)))}endAt(e=null,n){return z("Query.endAt",0,2,arguments.length),new t(this.database,Pn(this._delegate,PP(e,n)))}endBefore(e=null,n){return z("Query.endBefore",0,2,arguments.length),new t(this.database,Pn(this._delegate,kP(e,n)))}equalTo(e,n){return z("Query.equalTo",1,2,arguments.length),new t(this.database,Pn(this._delegate,qP(e,n)))}toString(){return z("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return z("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(z("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,pt(e,"cancel",i.cancel,!0),i.context=r,Xy(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(on(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ci(this.database,new mn(this._delegate._repo,this._delegate._path))}},ci=class t extends dg{constructor(e,n){super(e,new Jt(n._repo,n._path,new iu,!1)),this.database=e,this._delegate=n}getKey(){return z("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return z("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Yi(this._delegate,e))}getParent(){z("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return z("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){z("Reference.set",1,2,arguments.length),pt("Reference.set","onComplete",n,!0);let r=cg(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(z("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ek("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}pn("Reference.update",this._delegate._path),pt("Reference.update","onComplete",n,!0);let r=MP(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("Reference.setWithPriority",2,3,arguments.length),pt("Reference.setWithPriority","onComplete",r,!0);let i=RP(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){z("Reference.remove",0,1,arguments.length),pt("Reference.remove","onComplete",e,!0);let n=AP(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){z("Reference.transaction",1,3,arguments.length),pt("Reference.transaction","transactionUpdate",e,!1),pt("Reference.transaction","onComplete",n,!0),LW("Reference.transaction","applyLocally",r,!0);let i=JP(this._delegate,e,{applyLocally:r}).then(s=>new QI(s.committed,new to(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){z("Reference.setPriority",1,2,arguments.length),pt("Reference.setPriority","onComplete",n,!0);let r=xP(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){z("Reference.push",0,2,arguments.length),pt("Reference.push","onComplete",n,!0);let r=SP(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return pn("Reference.onDisconnect",this._delegate._path),new KI(new qp(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var no=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:zP,forceLongPolling:GP}}useEmulator(e,n,r={}){WP(this._delegate,e,n,r)}ref(e){if(z("database.ref",0,1,arguments.length),e instanceof ci){let n=BI(this._delegate,e.toString());return new ci(this,n)}else{let n=UI(this._delegate,e);return new ci(this,n)}}refFromURL(e){z("database.refFromURL",1,1,arguments.length);let r=BI(this._delegate,e);return new ci(this,r)}goOffline(){return z("database.goOffline",0,0,arguments.length),KP(this._delegate)}goOnline(){return z("database.goOnline",0,0,arguments.length),QP(this._delegate)}};no.ServerValue={TIMESTAMP:XP(),increment:t=>ZP(t)};function jW({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){pI(n);let a=new Zy("database-standalone"),l=new mh("auth-internal",a);l.setComponent(new St("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new mh("app-check-internal",a),c.setComponent(new St("app-check-internal",()=>i,"PRIVATE"))),{instance:new no(WI(t,l,c,e,o),t),namespace:s}}var UW=Object.freeze({__proto__:null,initStandalone:jW});var BW=no.ServerValue;function $W(t){t.INTERNAL.registerComponent(new St("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new no(i,r)},"PUBLIC").setServiceProps({Reference:ci,Query:dg,Database:no,DataSnapshot:to,enableLogging:YP,INTERNAL:UW,ServerValue:BW}).setMultipleInstances(!0)),t.registerVersion(kW,OW)}$W(Ye);function Eu(t,e,n="on",r=Gr){return new Z(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(F(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),ac())}function qW(t){return typeof t=="string"}function HW(t){return typeof t.exportVal=="function"}function sk(t){return t==null}function ok(t){return typeof t.set=="function"}function tk(t,e){return ok(e)?e:t.ref(e)}function ak(t,e){if(qW(t))return e.stringCase();if(ok(t))return e.firebaseCase();if(HW(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function lk(t){return(sk(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function ck(t,e,n){e=lk(e);let r=e.map(i=>Eu(t,i,"on",n));return ta(...r)}function zW(t,e,n){let r=ck(t,e).pipe(cr((i,s)=>[...i,s],[]));return WW(t,r,n)}function GW(t,e){return Eu(t,"value","on",e).pipe(F(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function WW(t,e,n){return GW(t,n).pipe(C_(e),F(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(l=>l.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),E_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),F(i=>i.actions))}function nk(t,e){return function(r,i){return ak(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function KW(t){return function(n){return n?ak(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function QW(t,e,n){return Eu(t,"value","once",n).pipe(Ce(r=>{let i=[L(r)];return e.forEach(s=>i.push(Eu(t,s,"on",n))),ta(...i).pipe(cr(XW,[]))}),sc())}function uk(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function YW(t,e){if(sk(e))return 0;{let n=uk(t,e);return n===-1?t.length:n+1}}function XW(t,e){let{payload:n,prevKey:r,key:i}=e,s=uk(t,i),o=YW(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(l=>{let c={payload:l,type:"value",prevKey:a,key:l.key};return a=l.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(l=>l.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function rk(t,e,n){return e=lk(e),QW(t,e,n)}function ZW(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:nk(r,"update"),set:nk(r,"set"),push:i=>r.push(i),remove:KW(r),snapshotChanges(i){return rk(t,i,n).pipe(Ve)},stateChanges(i){return ck(t,i,n).pipe(Ve)},auditTrail(i){return zW(t,i,n).pipe(Ve)},valueChanges(i,s){return rk(t,i,n).pipe(F(a=>a.map(l=>s&&s.idField?fe(M({},l.payload.val()),{[s.idField]:l.key}):l.payload.val())),Ve)}}}function ik(t,e){return function(){return Eu(t,"value","on",e)}}function JW(t,e){return{query:t,snapshotChanges(){return ik(t,e.schedulers.outsideAngular)().pipe(Ve)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return ik(t,e.schedulers.outsideAngular)().pipe(Ve,F(r=>r.payload.exists()?r.payload.val():null))}}}var e5=new x("angularfire2.realtimeDatabaseURL"),t5=new x("angularfire2.database.use-emulator"),n5=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,l,c,u,d,h,f,p,g,m){this.schedulers=a;let w=l,S=ai(n,o,r);c&&$c(S,o,u,h,f,p,d,g),this.database=Bi(`${S.name}.database.${i}`,"AngularFireDatabase",S.name,()=>{let C=o.runOutsideAngular(()=>S.database(i||void 0));return w&&C.useEmulator(...w),C},[w])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>tk(this.database,n)),s=i;return r&&(s=r(i)),ZW(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>tk(this.database,n));return JW(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(E(vr),E(wr,8),E(e5,8),E(lt),E(ie),E(Ui),E(t5,8),E(vp,8),E(Fc,8),E(Lc,8),E(Vc,8),E(jc,8),E(Uc,8),E(Bc,8),E(Yn,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),dk=(()=>{class t{constructor(){Ye.registerVersion("angularfire",oi.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=ke({type:t});static \u0275inj=Pe({providers:[n5]})}return t})();var wk="firebasestorage.googleapis.com",Ek="storageBucket",r5=2*60*1e3,i5=10*60*1e3,s5=1e3;var He=class t extends fh{constructor(e,n,r=0){super(YI(e),`Firebase Storage: ${n} (${YI(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return YI(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ue=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Ue||{});function YI(t){return"storage/"+t}function iC(){let t="An unknown error occurred, please check the error payload for server response.";return new He(Ue.UNKNOWN,t)}function o5(t){return new He(Ue.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function a5(t){return new He(Ue.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function l5(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new He(Ue.UNAUTHENTICATED,t)}function c5(){return new He(Ue.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function u5(t){return new He(Ue.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Ik(){return new He(Ue.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Ck(){return new He(Ue.CANCELED,"User canceled the upload/download.")}function d5(t){return new He(Ue.INVALID_URL,"Invalid URL '"+t+"'.")}function h5(t){return new He(Ue.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function f5(){return new He(Ue.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ek+"' property when initializing the app?")}function Dk(){return new He(Ue.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function p5(){return new He(Ue.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function g5(){return new He(Ue.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function m5(t){return new He(Ue.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ro(t){return new He(Ue.INVALID_ARGUMENT,t)}function Tk(){return new He(Ue.APP_DELETED,"The Firebase app was deleted.")}function sC(t){return new He(Ue.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Cu(t,e){return new He(Ue.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Iu(t){throw new He(Ue.INTERNAL_ERROR,"Internal error: "+t)}var en=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw h5(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(b){b.path.charAt(b.path.length-1)==="/"&&(b.path_=b.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(b){b.path_=decodeURIComponent(b.path)}let u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",f=new RegExp(`^https?://${d}/${u}/b/${i}/o${h}`,"i"),p={bucket:1,path:3},g=n===wk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",w=new RegExp(`^https?://${g}/${i}/${m}`,"i"),C=[{regex:a,indices:l,postModify:s},{regex:f,indices:p,postModify:c},{regex:w,indices:{bucket:1,path:2},postModify:c}];for(let b=0;b<C.length;b++){let B=C[b],H=B.regex.exec(e);if(H){let ye=H[B.indices.bucket],it=H[B.indices.path];it||(it=""),r=new t(ye,it),B.postModify(r);break}}if(r==null)throw d5(e);return r}},ZI=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function y5(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...m){c||(c=!0,e.apply(null,m))}function d(m){i=setTimeout(()=>{i=null,t(f,l())},m)}function h(){s&&clearTimeout(s)}function f(m,...w){if(c){h();return}if(m){h(),u.call(null,m,...w);return}if(l()||o){h(),u.call(null,m,...w);return}r<64&&(r*=2);let C;a===1?(a=2,C=0):C=(r+Math.random())*1e3,d(C)}let p=!1;function g(m){p||(p=!0,h(),!c&&(i!==null?(m||(a=2),clearTimeout(i),d(0)):m||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function _5(t){t(!1)}function v5(t){return t!==void 0}function w5(t){return typeof t=="function"}function E5(t){return typeof t=="object"&&!Array.isArray(t)}function pg(t){return typeof t=="string"||t instanceof String}function hk(t){return oC()&&t instanceof Blob}function oC(){return typeof Blob<"u"}function JI(t,e,n,r){if(r<e)throw ro(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ro(`Invalid value for '${t}'. Expected ${n} or less.`)}function Zi(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function bk(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Ha=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(Ha||{});function Sk(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var eC=class{constructor(e,n,r,i,s,o,a,l,c,u,d,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new qa(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Ha.NO_ERROR,l=s.getStatus();if(!a||Sk(l,this.additionalRetryCodes_)&&this.retry){let u=s.getErrorCode()===Ha.ABORT;r(!1,new qa(!1,null,u));return}let c=this.successCodes_.indexOf(l)!==-1;r(!0,new qa(c,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let l=this.callback_(a,a.getResponse());v5(l)?s(l):s()}catch(l){o(l)}else if(a!==null){let l=iC();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){let l=this.appDelete_?Tk():Ck();o(l)}else{let l=Ik();o(l)}};this.canceled_?n(!1,new qa(!1,null,!0)):this.backoffId_=y5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&_5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},qa=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function I5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function C5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function D5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function T5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function b5(t,e,n,r,i,s,o=!0){let a=bk(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return D5(c,e),I5(c,n),C5(c,s),T5(c,r),new eC(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function S5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function A5(...t){let e=S5();if(e!==void 0){let n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(oC())return new Blob(t);throw new He(Ue.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function x5(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function R5(t){if(typeof atob>"u")throw m5("base-64");return atob(t)}var _n={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Du=class{constructor(e,n){this.data=e,this.contentType=n||null}};function aC(t,e){switch(t){case _n.RAW:return new Du(Ak(e));case _n.BASE64:case _n.BASE64URL:return new Du(xk(t,e));case _n.DATA_URL:return new Du(N5(e),P5(e))}throw iC()}function Ak(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function M5(t){let e;try{e=decodeURIComponent(t)}catch{throw Cu(_n.DATA_URL,"Malformed data URL.")}return Ak(e)}function xk(t,e){switch(t){case _n.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Cu(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case _n.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Cu(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=R5(e)}catch(i){throw i.message.includes("polyfill")?i:Cu(t,"Invalid character found")}let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var fg=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw Cu(_n.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=n[1]||null;r!=null&&(this.base64=k5(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function N5(t){let e=new fg(t);return e.base64?xk(_n.BASE64,e.rest):M5(e.rest)}function P5(t){return new fg(t).contentType}function k5(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var za=class t{constructor(e,n){let r=0,i="";hk(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(hk(this.data_)){let r=this.data_,i=x5(r,e,n);return i===null?null:new t(i)}else{let r=new Uint8Array(this.data_.buffer,e,n-e);return new t(r,!0)}}static getBlob(...e){if(oC()){let n=e.map(r=>r instanceof t?r.data_:r);return new t(A5.apply(null,n))}else{let n=e.map(o=>pg(o)?aC(_n.RAW,o).data:o.data_),r=0;n.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new t(i,!0)}}uploadData(){return this.data_}};function lC(t){let e;try{e=JSON.parse(t)}catch{return null}return E5(e)?e:null}function O5(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function F5(t,e){let n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function Rk(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function L5(t,e){return e}var Pt=class{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||L5}},hg=null;function V5(t){return!pg(t)||t.length<2?t:Rk(t)}function gg(){if(hg)return hg;let t=[];t.push(new Pt("bucket")),t.push(new Pt("generation")),t.push(new Pt("metageneration")),t.push(new Pt("name","fullPath",!0));function e(s,o){return V5(o)}let n=new Pt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}let i=new Pt("size");return i.xform=r,t.push(i),t.push(new Pt("timeCreated")),t.push(new Pt("updated")),t.push(new Pt("md5Hash",null,!0)),t.push(new Pt("cacheControl",null,!0)),t.push(new Pt("contentDisposition",null,!0)),t.push(new Pt("contentEncoding",null,!0)),t.push(new Pt("contentLanguage",null,!0)),t.push(new Pt("contentType",null,!0)),t.push(new Pt("metadata","customMetadata",!0)),hg=t,hg}function j5(t,e){function n(){let r=t.bucket,i=t.fullPath,s=new en(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function U5(t,e,n){let r={};r.type="file";let i=n.length;for(let s=0;s<i;s++){let o=n[s];r[o.local]=o.xform(r,e[o.server])}return j5(r,t),r}function Mk(t,e,n){let r=lC(e);return r===null?null:U5(t,r,n)}function B5(t,e,n,r){let i=lC(e);if(i===null||!pg(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(c=>{let u=t.bucket,d=t.fullPath,h="/b/"+o(u)+"/o/"+o(d),f=Zi(h,n,r),p=bk({alt:"media",token:c});return f+p})[0]}function cC(t,e){let n={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var fk="prefixes",pk="items";function $5(t,e,n){let r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[fk])for(let i of n[fk]){let s=i.replace(/\/$/,""),o=t._makeStorageReference(new en(e,s));r.prefixes.push(o)}if(n[pk])for(let i of n[pk]){let s=t._makeStorageReference(new en(e,i.name));r.items.push(s)}return r}function q5(t,e,n){let r=lC(n);return r===null?null:$5(t,e,r)}var er=class{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Sr(t){if(!t)throw iC()}function mg(t,e){function n(r,i){let s=Mk(t,i,e);return Sr(s!==null),s}return n}function H5(t,e){function n(r,i){let s=q5(t,e,i);return Sr(s!==null),s}return n}function z5(t,e){function n(r,i){let s=Mk(t,i,e);return Sr(s!==null),B5(s,i,t.host,t._protocol)}return n}function Ka(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=c5():i=l5():n.getStatus()===402?i=a5(t.bucket):n.getStatus()===403?i=u5(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function yg(t){let e=Ka(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=o5(t.path)),s.serverResponse=i.serverResponse,s}return n}function Nk(t,e,n){let r=e.fullServerUrl(),i=Zi(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new er(i,s,mg(t,n),o);return a.errorHandler=yg(e),a}function G5(t,e,n,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=Zi(o,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new er(a,l,H5(t,e.bucket),c);return u.urlParams=s,u.errorHandler=Ka(e),u}function W5(t,e,n){let r=e.fullServerUrl(),i=Zi(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new er(i,s,z5(t,n),o);return a.errorHandler=yg(e),a}function K5(t,e,n,r){let i=e.fullServerUrl(),s=Zi(i,t.host,t._protocol),o="PATCH",a=cC(n,r),l={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime,u=new er(s,o,mg(t,r),c);return u.headers=l,u.body=a,u.errorHandler=yg(e),u}function Q5(t,e){let n=e.fullServerUrl(),r=Zi(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,c){}let a=new er(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=yg(e),a}function Y5(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Pk(t,e,n){let r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=Y5(null,e)),r}function X5(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let C="";for(let b=0;b<2;b++)C=C+Math.random().toString().slice(2);return C}let l=a();o["Content-Type"]="multipart/related; boundary="+l;let c=Pk(e,r,i),u=cC(c,n),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",f=za.getBlob(d,r,h);if(f===null)throw Dk();let p={name:c.fullPath},g=Zi(s,t.host,t._protocol),m="POST",w=t.maxUploadRetryTime,S=new er(g,m,mg(t,n),w);return S.urlParams=p,S.headers=o,S.body=f.uploadData(),S.errorHandler=Ka(e),S}var Ga=class{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}};function uC(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Sr(!1)}return Sr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function Z5(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o=Pk(e,r,i),a={name:o.fullPath},l=Zi(s,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},d=cC(o,n),h=t.maxUploadRetryTime;function f(g){uC(g);let m;try{m=g.getResponseHeader("X-Goog-Upload-URL")}catch{Sr(!1)}return Sr(pg(m)),m}let p=new er(l,c,f,h);return p.urlParams=a,p.headers=u,p.body=d,p.errorHandler=Ka(e),p}function J5(t,e,n,r){let i={"X-Goog-Upload-Command":"query"};function s(c){let u=uC(c,["active","final"]),d=null;try{d=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Sr(!1)}d||Sr(!1);let h=Number(d);return Sr(!isNaN(h)),new Ga(h,r.size(),u==="final")}let o="POST",a=t.maxUploadRetryTime,l=new er(n,o,s,a);return l.headers=i,l.errorHandler=Ka(e),l}var gk=256*1024;function e9(t,e,n,r,i,s,o,a){let l=new Ga(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw p5();let c=l.total-l.current,u=c;i>0&&(u=Math.min(u,i));let d=l.current,h=d+u,f="";u===0?f="finalize":c===u?f="upload, finalize":f="upload";let p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${l.current}`},g=r.slice(d,h);if(g===null)throw Dk();function m(b,B){let H=uC(b,["active","final"]),ye=l.current+u,it=r.size(),bs;return H==="final"?bs=mg(e,s)(b,B):bs=null,new Ga(ye,it,H==="final",bs)}let w="POST",S=e.maxUploadRetryTime,C=new er(n,w,m,S);return C.headers=p,C.body=g.uploadData(),C.progressCallback=a||null,C.errorHandler=Ka(t),C}var kk={STATE_CHANGED:"state_changed"},Bt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function XI(t){switch(t){case"running":case"pausing":case"canceling":return Bt.RUNNING;case"paused":return Bt.PAUSED;case"success":return Bt.SUCCESS;case"canceled":return Bt.CANCELED;case"error":return Bt.ERROR;default:return Bt.ERROR}}var tC=class{constructor(e,n,r){if(w5(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function $a(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}var mk=null,nC=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ha.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ha.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ha.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Iu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Iu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Iu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Iu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Iu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},rC=class extends nC{initXhr(){this.xhr_.responseType="text"}};function br(){return mk?mk():new rC}var Tu=class{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=gg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Ue.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(Sk(i.status,[]))if(s)i=Ik();else{this.sleepTime=Math.max(this.sleepTime*2,s5),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Ue.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{let r=Z5(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,br,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((n,r)=>{let i=J5(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,br,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=gk*this._chunkMultiplier,n=new Ga(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=e9(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}let a=this._ref.storage._makeRequest(o,br,i,s,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){gk*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{let r=Nk(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,br,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{let r=X5(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,br,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=Ck(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=XI(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){let s=new tC(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(XI(this._state)){case Bt.SUCCESS:$a(this._resolve.bind(null,this.snapshot))();break;case Bt.CANCELED:case Bt.ERROR:let n=this._reject;$a(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(XI(this._state)){case Bt.RUNNING:case Bt.PAUSED:e.next&&$a(e.next.bind(e,this.snapshot))();break;case Bt.SUCCESS:e.complete&&$a(e.complete.bind(e))();break;case Bt.CANCELED:case Bt.ERROR:e.error&&$a(e.error.bind(e,this._error))();break;default:e.error&&$a(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Wa=class t{constructor(e,n){this._service=e,n instanceof en?this._location=n:this._location=en.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new en(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Rk(this._location.path)}get storage(){return this._service}get parent(){let e=O5(this._location.path);if(e===null)return null;let n=new en(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw sC(e)}};function t9(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Tu(t,new za(e),n)}function n9(t){let e={prefixes:[],items:[]};return Ok(t,e).then(()=>e)}function Ok(t,e,n){return _(this,null,function*(){let i=yield Fk(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield Ok(t,e,i.nextPageToken))})}function Fk(t,e){e!=null&&typeof e.maxResults=="number"&&JI("options.maxResults",1,1e3,e.maxResults);let n=e||{},r=G5(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,br)}function r9(t){t._throwIfRoot("getMetadata");let e=Nk(t.storage,t._location,gg());return t.storage.makeRequestWithTokens(e,br)}function i9(t,e){t._throwIfRoot("updateMetadata");let n=K5(t.storage,t._location,e,gg());return t.storage.makeRequestWithTokens(n,br)}function s9(t){t._throwIfRoot("getDownloadURL");let e=W5(t.storage,t._location,gg());return t.storage.makeRequestWithTokens(e,br).then(n=>{if(n===null)throw g5();return n})}function o9(t){t._throwIfRoot("deleteObject");let e=Q5(t.storage,t._location);return t.storage.makeRequestWithTokens(e,br)}function Lk(t,e){let n=F5(t._location.path,e),r=new en(t._location.bucket,n);return new Wa(t.storage,r)}function a9(t){return/^[A-Za-z]+:\/\//.test(t)}function l9(t,e){return new Wa(t,e)}function Vk(t,e){if(t instanceof bu){let n=t;if(n._bucket==null)throw f5();let r=new Wa(n,n._bucket);return e!=null?Vk(r,e):r}else return e!==void 0?Lk(t,e):t}function c9(t,e){if(e&&a9(e)){if(t instanceof bu)return l9(t,e);throw ro("To use ref(service, url), the first argument must be a Storage instance.")}else return Vk(t,e)}function yk(t,e){let n=e?.[Ek];return n==null?null:en.makeFromBucketSpec(n,t)}function u9(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Bo(i,t.app.options.projectId))}var bu=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=wk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=r5,this._maxUploadRetryTime=i5,this._requests=new Set,i!=null?this._bucket=en.makeFromBucketSpec(i,this._host):this._bucket=yk(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=en.makeFromBucketSpec(this._url,e):this._bucket=yk(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){JI("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){JI("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return _(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return _(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Wa(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new ZI(Tk());{let o=b5(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return _(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},_k="@firebase/storage",vk="0.12.2";var d9="storage";function jk(t,e,n){return t=W(t),t9(t,e,n)}function Uk(t){return t=W(t),r9(t)}function Bk(t,e){return t=W(t),i9(t,e)}function $k(t,e){return t=W(t),Fk(t,e)}function qk(t){return t=W(t),n9(t)}function Hk(t){return t=W(t),s9(t)}function zk(t){return t=W(t),o9(t)}function dC(t,e){return t=W(t),c9(t,e)}function Gk(t,e){return Lk(t,e)}function Wk(t,e,n,r={}){u9(t,e,n,r)}function h9(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new bu(n,r,i,e,$o)}function f9(){Hr(new St(d9,h9,"PUBLIC").setMultipleInstances(!0)),an(_k,vk,""),an(_k,vk,"esm2017")}f9();var Qa=class{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var _g=class{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Qa(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new Qa(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new Qa(o,this,this._ref)):s={next:n.next?o=>n.next(new Qa(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},vg=class{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new io(e,this._service))}get items(){return this._delegate.items.map(e=>new io(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var io=class t{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let n=Gk(this._delegate,e);return new t(n,this.storage)}get root(){return new t(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new t(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new _g(jk(this._delegate,e,n),this)}putString(e,n=_n.RAW,r){this._throwIfRoot("putString");let i=aC(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new _g(new Tu(this._delegate,new za(i.data,!0),s),this)}listAll(){return qk(this._delegate).then(e=>new vg(e,this.storage))}list(e){return $k(this._delegate,e||void 0).then(n=>new vg(n,this.storage))}getMetadata(){return Uk(this._delegate)}updateMetadata(e){return Bk(this._delegate,e)}getDownloadURL(){return Hk(this._delegate)}delete(){return this._throwIfRoot("delete"),zk(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw sC(e)}};var wg=class{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Kk(e))throw ro("ref() expected a child path but got a URL, use refFromURL instead.");return new io(dC(this._delegate,e),this)}refFromURL(e){if(!Kk(e))throw ro("refFromURL() expected a full URL but got a child path, use ref() instead.");try{en.makeFromUrl(e,this._delegate.host)}catch{throw ro("refFromUrl() expected a valid full URL but got an invalid one.")}return new io(dC(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){Wk(this._delegate,e,n,r)}};function Kk(t){return/^[A-Za-z]+:\/\//.test(t)}var p9="@firebase/storage-compat",g9="0.3.5";var m9="storage-compat";function y9(t,{instanceIdentifier:e}){let n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new wg(n,r)}function _9(t){let e={TaskState:Bt,TaskEvent:kk,StringFormat:_n,Storage:wg,Reference:io};t.INTERNAL.registerComponent(new St(m9,y9,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(p9,g9)}_9(Ye);function v9(t){return new Z(e=>{let n=o=>e.next(o),r=o=>e.error(o),i=()=>e.complete();n(t.snapshot);let s=t.on("state_changed",n);return t.then(o=>{n(o),i()},o=>{n(t.snapshot),r(o)}),function(){s()}}).pipe(y_(0))}function Qk(t){let e=v9(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(F(n=>n.bytesTransferred/n.totalBytes*100))}}function Eg(t){return{getDownloadURL:()=>L(void 0).pipe(Ww,Ce(()=>t.getDownloadURL()),Ve),getMetadata:()=>L(void 0).pipe(Ww,Ce(()=>t.getMetadata()),Ve),delete:()=>re(t.delete()),child:e=>Eg(t.child(e)),updateMetadata:e=>re(t.updateMetadata(e)),put:(e,n)=>{let r=t.put(e,n);return Qk(r)},putString:(e,n,r)=>{let i=t.putString(e,n,r);return Qk(i)},list:e=>re(t.list(e)),listAll:()=>re(t.listAll())}}var w9=new x("angularfire2.storageBucket"),E9=new x("angularfire2.storage.maxUploadRetryTime"),I9=new x("angularfire2.storage.maxOperationRetryTime"),C9=new x("angularfire2.storage.use-emulator"),D9=(()=>{class t{storage;constructor(n,r,i,s,o,a,l,c,u,d){let h=ai(n,o,r);this.storage=Bi(`${h.name}.storage.${i}`,"AngularFireStorage",h.name,()=>{let f=o.runOutsideAngular(()=>h.storage(i||void 0)),p=u;return p&&f.useEmulator(...p),l&&f.setMaxUploadRetryTime(l),c&&f.setMaxOperationRetryTime(c),f},[l,c])}ref(n){return Eg(this.storage.ref(n))}refFromURL(n){return Eg(this.storage.refFromURL(n))}upload(n,r,i){let s=this.storage.ref(n);return Eg(s).put(r,i)}static \u0275fac=function(r){return new(r||t)(E(vr),E(wr,8),E(w9,8),E(lt),E(ie),E(Ui),E(E9,8),E(I9,8),E(C9,8),E(Yn,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var T9=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=ke({type:t});static \u0275inj=Pe({})}return t})(),Yk=(()=>{class t{constructor(){Ye.registerVersion("angularfire",oi.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=ke({type:t});static \u0275inj=Pe({providers:[D9],imports:[T9]})}return t})();var Xk={production:!1,firebaseConfig:{apiKey:"AIzaSyANRjC_04UQZRSeFwolwg5_JlvtPTd8AGQ",authDomain:"clientes-57199.firebaseapp.com",projectId:"clientes-57199",storageBucket:"clientes-57199.appspot.com",messagingSenderId:"855641413726",appId:"1:855641413726:web:51496e63bdf81a26087ccf"}};var ne="primary",Bu=Symbol("RouteTitle"),mC=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function el(t){return new mC(t)}function b9(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function S9(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Ar(t[n],e[n]))return!1;return!0}function Ar(t,e){let n=t?yC(t):void 0,r=e?yC(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!oO(t[i],e[i]))return!1;return!0}function yC(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function oO(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function aO(t){return t.length>0?t[t.length-1]:null}function rs(t){return g_(t)?t:Hs(t)?re(Promise.resolve(t)):L(t)}var A9={exact:cO,subset:uO},lO={exact:x9,subset:R9,ignored:()=>!0};function Zk(t,e,n){return A9[n.paths](t.root,e.root,n.matrixParams)&&lO[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function x9(t,e){return Ar(t,e)}function cO(t,e,n){if(!oo(t.segments,e.segments)||!Dg(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!cO(t.children[r],e.children[r],n))return!1;return!0}function R9(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>oO(t[n],e[n]))}function uO(t,e,n){return dO(t,e,e.segments,n)}function dO(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!oo(i,n)||e.hasChildren()||!Dg(i,n,r))}else if(t.segments.length===n.length){if(!oo(t.segments,n)||!Dg(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!uO(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!oo(t.segments,i)||!Dg(t.segments,i,r)||!t.children[ne]?!1:dO(t.children[ne],e,s,r)}}function Dg(t,e,n){return e.every((r,i)=>lO[n](t[i].parameters,r.parameters))}var Ji=class{constructor(e=new Ie([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=el(this.queryParams),this._queryParamMap}toString(){return P9.serialize(this)}},Ie=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Tg(this)}},so=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=el(this.parameters),this._parameterMap}toString(){return fO(this)}};function M9(t,e){return oo(t,e)&&t.every((n,r)=>Ar(n.parameters,e[r].parameters))}function oo(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function N9(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ne&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ne&&(n=n.concat(e(i,r)))}),n}var $u=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>new Pu,providedIn:"root"});let t=e;return t})(),Pu=class{parse(e){let n=new vC(e);return new Ji(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Su(e.root,!0)}`,r=F9(e.queryParams),i=typeof e.fragment=="string"?`#${k9(e.fragment)}`:"";return`${n}${r}${i}`}},P9=new Pu;function Tg(t){return t.segments.map(e=>fO(e)).join("/")}function Su(t,e){if(!t.hasChildren())return Tg(t);if(e){let n=t.children[ne]?Su(t.children[ne],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==ne&&r.push(`${i}:${Su(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=N9(t,(r,i)=>i===ne?[Su(t.children[ne],!1)]:[`${i}:${Su(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ne]!=null?`${Tg(t)}/${n[0]}`:`${Tg(t)}/(${n.join("//")})`}}function hO(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ig(t){return hO(t).replace(/%3B/gi,";")}function k9(t){return encodeURI(t)}function _C(t){return hO(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function bg(t){return decodeURIComponent(t)}function Jk(t){return bg(t.replace(/\+/g,"%20"))}function fO(t){return`${_C(t.path)}${O9(t.parameters)}`}function O9(t){return Object.entries(t).map(([e,n])=>`;${_C(e)}=${_C(n)}`).join("")}function F9(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Ig(n)}=${Ig(i)}`).join("&"):`${Ig(n)}=${Ig(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var L9=/^[^\/()?;#]+/;function hC(t){let e=t.match(L9);return e?e[0]:""}var V9=/^[^\/()?;=#]+/;function j9(t){let e=t.match(V9);return e?e[0]:""}var U9=/^[^=?&#]+/;function B9(t){let e=t.match(U9);return e?e[0]:""}var $9=/^[^&#]+/;function q9(t){let e=t.match($9);return e?e[0]:""}var vC=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ie([],{}):new Ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ne]=new Ie(e,n)),r}parseSegment(){let e=hC(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new V(4009,!1);return this.capture(e),new so(bg(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=j9(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=hC(this.remaining);i&&(r=i,this.capture(r))}e[bg(n)]=bg(r)}parseQueryParam(e){let n=B9(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=q9(this.remaining);o&&(r=o,this.capture(r))}let i=Jk(n),s=Jk(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=hC(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new V(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ne);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[ne]:new Ie([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new V(4011,!1)}};function pO(t){return t.segments.length>0?new Ie([],{[ne]:t}):t}function gO(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=gO(i);if(r===ne&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ie(t.segments,e);return H9(n)}function H9(t){if(t.numberOfChildren===1&&t.children[ne]){let e=t.children[ne];return new Ie(t.segments.concat(e.segments),e.children)}return t}function tl(t){return t instanceof Ji}function z9(t,e,n=null,r=null){let i=mO(t);return yO(i,e,n,r)}function mO(t){let e;function n(s){let o={};for(let l of s.children){let c=n(l);o[l.outlet]=c}let a=new Ie(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=pO(r);return e??i}function yO(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return fC(i,i,i,n,r);let s=G9(e);if(s.toRoot())return fC(i,i,new Ie([],{}),n,r);let o=W9(s,i,t),a=o.processChildren?Ru(o.segmentGroup,o.index,s.commands):vO(o.segmentGroup,o.index,s.commands);return fC(i,o.segmentGroup,a,n,r)}function Sg(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function ku(t){return typeof t=="object"&&t!=null&&t.outlets}function fC(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let o;t===e?o=n:o=_O(t,e,n);let a=pO(gO(o));return new Ji(a,s,i)}function _O(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=_O(s,e,n)}),new Ie(t.segments,r)}var Ag=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Sg(r[0]))throw new V(4003,!1);let i=r.find(ku);if(i&&i!==aO(r))throw new V(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function G9(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Ag(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Ag(n,e,r)}var Za=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function W9(t,e,n){if(t.isAbsolute)return new Za(e,!0,0);if(!n)return new Za(e,!1,NaN);if(n.parent===null)return new Za(n,!0,0);let r=Sg(t.commands[0])?0:1,i=n.segments.length-1+r;return K9(n,i,t.numberOfDoubleDots)}function K9(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new V(4005,!1);i=r.segments.length}return new Za(r,!1,i-s)}function Q9(t){return ku(t[0])?t[0].outlets:{[ne]:t}}function vO(t,e,n){if(t??=new Ie([],{}),t.segments.length===0&&t.hasChildren())return Ru(t,e,n);let r=Y9(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ie(t.segments.slice(0,r.pathIndex),{});return s.children[ne]=new Ie(t.segments.slice(r.pathIndex),t.children),Ru(s,0,i)}else return r.match&&i.length===0?new Ie(t.segments,{}):r.match&&!t.hasChildren()?wC(t,e,n):r.match?Ru(t,0,i):wC(t,e,n)}function Ru(t,e,n){if(n.length===0)return new Ie(t.segments,{});{let r=Q9(n),i={};if(Object.keys(r).some(s=>s!==ne)&&t.children[ne]&&t.numberOfChildren===1&&t.children[ne].segments.length===0){let s=Ru(t.children[ne],e,n);return new Ie(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=vO(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ie(t.segments,i)}}function Y9(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(ku(a))break;let l=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!tO(l,c,o))return s;r+=2}else{if(!tO(l,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function wC(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(ku(s)){let l=X9(s.outlets);return new Ie(r,l)}if(i===0&&Sg(n[0])){let l=t.segments[e];r.push(new so(l.path,eO(n[0]))),i++;continue}let o=ku(s)?s.outlets[ne]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Sg(a)?(r.push(new so(o,eO(a))),i+=2):(r.push(new so(o,{})),i++)}return new Ie(r,{})}function X9(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=wC(new Ie([],{}),0,r))}),e}function eO(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function tO(t,e,n){return t==n.path&&Ar(e,n.parameters)}var Mu="imperative",It=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(It||{}),kn=class{constructor(e,n){this.id=e,this.url=n}},nl=class extends kn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=It.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},xr=class extends kn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=It.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},wn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(wn||{}),xg=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(xg||{}),es=class extends kn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=It.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ts=class extends kn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=It.NavigationSkipped}},Ou=class extends kn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=It.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Rg=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},EC=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},IC=class extends kn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=It.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},CC=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},DC=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=It.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},TC=class{constructor(e){this.route=e,this.type=It.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},bC=class{constructor(e){this.route=e,this.type=It.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},SC=class{constructor(e){this.snapshot=e,this.type=It.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},AC=class{constructor(e){this.snapshot=e,this.type=It.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xC=class{constructor(e){this.snapshot=e,this.type=It.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},RC=class{constructor(e){this.snapshot=e,this.type=It.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Mg=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=It.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Fu=class{},Lu=class{constructor(e){this.url=e}};var MC=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new qu,this.attachRef=null}},qu=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new MC,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ng=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=NC(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=NC(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=PC(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return PC(e,this._root).map(n=>n.value)}};function NC(t,e){if(t===e.value)return e;for(let n of e.children){let r=NC(t,n);if(r)return r}return null}function PC(t,e){if(t===e.value)return[e];for(let n of e.children){let r=PC(t,n);if(r.length)return r.unshift(e),r}return[]}var vn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Xa(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Pg=class extends Ng{constructor(e,n){super(e),this.snapshot=n,qC(this,e)}toString(){return this.snapshot.toString()}};function wO(t){let e=Z9(t),n=new xt([new so("",{})]),r=new xt({}),i=new xt({}),s=new xt({}),o=new xt(""),a=new ao(n,r,s,o,i,ne,t,e.root);return a.snapshot=e.root,new Pg(new vn(a,[]),e)}function Z9(t){let e={},n={},r={},i="",s=new Vu([],e,r,i,n,ne,t,null,{});return new kg("",new vn(s,[]))}var ao=class{constructor(e,n,r,i,s,o,a,l){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(F(c=>c[Bu]))??L(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(F(e=>el(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(F(e=>el(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function $C(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:M(M({},e.params),t.params),data:M(M({},e.data),t.data),resolve:M(M(M(M({},t.data),e.data),i?.data),t._resolvedData)}:r={params:M({},t.params),data:M({},t.data),resolve:M(M({},t.data),t._resolvedData??{})},i&&IO(i)&&(r.resolve[Bu]=i.title),r}var Vu=class{get title(){return this.data?.[Bu]}constructor(e,n,r,i,s,o,a,l,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=el(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=el(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},kg=class extends Ng{constructor(e,n){super(n),this.url=e,qC(this,n)}toString(){return EO(this._root)}};function qC(t,e){e.value._routerState=t,e.children.forEach(n=>qC(t,n))}function EO(t){let e=t.children.length>0?` { ${t.children.map(EO).join(", ")} } `:"";return`${t.value}${e}`}function pC(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Ar(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Ar(e.params,n.params)||t.paramsSubject.next(n.params),S9(e.url,n.url)||t.urlSubject.next(n.url),Ar(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function kC(t,e){let n=Ar(t.params,e.params)&&M9(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||kC(t.parent,e.parent))}function IO(t){return typeof t.title=="string"||t.title===null}var HC=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ne,this.activateEvents=new at,this.deactivateEvents=new at,this.attachEvents=new at,this.detachEvents=new at,this.parentContexts=A(qu),this.location=A(bc),this.changeDetector=A(Li),this.environmentInjector=A(Kt),this.inputBinder=A(jg,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new V(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new V(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new V(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new V(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new OC(r,l,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=et({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ki]});let t=e;return t})(),OC=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===ao?this.route:e===qu?this.childContexts:this.parent.get(e,n)}},jg=new x(""),nO=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=ic([i.queryParams,i.params,i.data]).pipe(Ce(([o,a,l],c)=>(l=M(M(M({},o),a),l),c===0?L(l):Promise.resolve(l)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=GR(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:l}of a.inputs)r.activatedComponentRef.setInput(l,o[l])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function J9(t,e,n){let r=ju(t,e._root,n?n._root:void 0);return new Pg(r,e)}function ju(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=e8(t,e,n);return new vn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>ju(t,a)),o}}let r=t8(e.value),i=e.children.map(s=>ju(t,s));return new vn(r,i)}}function e8(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return ju(t,r,i);return ju(t,r)})}function t8(t){return new ao(new xt(t.url),new xt(t.params),new xt(t.queryParams),new xt(t.fragment),new xt(t.data),t.outlet,t.component,t)}var CO="ngNavigationCancelingError";function DO(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=tl(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=TO(!1,wn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function TO(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[CO]=!0,n.cancellationCode=e,n}function n8(t){return bO(t)&&tl(t.url)}function bO(t){return!!t&&t[CO]}var r8=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Pi({type:e,selectors:[["ng-component"]],standalone:!0,features:[OR],decls:1,vars:0,template:function(i,s){i&1&&Oe(0,"router-outlet")},dependencies:[HC],encapsulation:2});let t=e;return t})();function i8(t,e){return t.providers&&!t._injector&&(t._injector=Kf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function zC(t){let e=t.children&&t.children.map(zC),n=e?fe(M({},t),{children:e}):M({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ne&&(n.component=r8),n}function Rr(t){return t.outlet||ne}function s8(t,e){let n=t.filter(r=>Rr(r)===e);return n.push(...t.filter(r=>Rr(r)!==e)),n}function Hu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var o8=(t,e,n,r)=>F(i=>(new FC(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),FC=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),pC(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Xa(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Xa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Xa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Xa(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new RC(s.value.snapshot))}),e.children.length&&this.forwardEvent(new AC(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(pC(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),pC(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Hu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Og=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ja=class{constructor(e,n){this.component=e,this.route=n}};function a8(t,e,n){let r=t._root,i=e?e._root:null;return Au(r,i,n,[r.value])}function l8(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function il(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!DA(t)?t:e.get(t):r}function Au(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Xa(e);return t.children.forEach(o=>{c8(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Nu(a,n.getContext(o),i)),i}function c8(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=u8(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new Og(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Au(t,e,a?a.children:null,r,i):Au(t,e,n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ja(a.outlet.component,o))}else o&&Nu(e,a,i),i.canActivateChecks.push(new Og(r)),s.component?Au(t,null,a?a.children:null,r,i):Au(t,null,n,r,i);return i}function u8(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!oo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!oo(t.url,e.url)||!Ar(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!kC(t,e)||!Ar(t.queryParams,e.queryParams);case"paramsChange":default:return!kC(t,e)}}function Nu(t,e,n){let r=Xa(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Nu(o,e.children.getContext(s),n):Nu(o,null,n):Nu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Ja(e.outlet.component,i)):n.canDeactivateChecks.push(new Ja(null,i)):n.canDeactivateChecks.push(new Ja(null,i))}function zu(t){return typeof t=="function"}function d8(t){return typeof t=="boolean"}function h8(t){return t&&zu(t.canLoad)}function f8(t){return t&&zu(t.canActivate)}function p8(t){return t&&zu(t.canActivateChild)}function g8(t){return t&&zu(t.canDeactivate)}function m8(t){return t&&zu(t.canMatch)}function SO(t){return t instanceof Wr||t?.name==="EmptyError"}var Cg=Symbol("INITIAL_VALUE");function rl(){return Ce(t=>ic(t.map(e=>e.pipe(Qr(1),Ms(Cg)))).pipe(F(e=>{for(let n of e)if(n!==!0){if(n===Cg)return Cg;if(n===!1||n instanceof Ji)return n}return!0}),gt(e=>e!==Cg),Qr(1)))}function y8(t,e){return ot(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?L(fe(M({},n),{guardsResult:!0})):_8(o,r,i,t).pipe(ot(a=>a&&d8(a)?v8(r,s,t,e):L(a)),F(a=>fe(M({},n),{guardsResult:a})))})}function _8(t,e,n,r){return re(t).pipe(ot(i=>D8(i.component,i.route,n,e,r)),bn(i=>i!==!0,!0))}function v8(t,e,n,r){return re(e).pipe(Kr(i=>ea(E8(i.route.parent,r),w8(i.route,r),C8(t,i.path,n),I8(t,i.route,n))),bn(i=>i!==!0,!0))}function w8(t,e){return t!==null&&e&&e(new xC(t)),L(!0)}function E8(t,e){return t!==null&&e&&e(new SC(t)),L(!0)}function I8(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return L(!0);let i=r.map(s=>Uh(()=>{let o=Hu(e)??n,a=il(s,o),l=f8(a)?a.canActivate(e,t):Wn(o,()=>a(e,t));return rs(l).pipe(bn())}));return L(i).pipe(rl())}function C8(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>l8(o)).filter(o=>o!==null).map(o=>Uh(()=>{let a=o.guards.map(l=>{let c=Hu(o.node)??n,u=il(l,c),d=p8(u)?u.canActivateChild(r,t):Wn(c,()=>u(r,t));return rs(d).pipe(bn())});return L(a).pipe(rl())}));return L(s).pipe(rl())}function D8(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return L(!0);let o=s.map(a=>{let l=Hu(e)??i,c=il(a,l),u=g8(c)?c.canDeactivate(t,e,n,r):Wn(l,()=>c(t,e,n,r));return rs(u).pipe(bn())});return L(o).pipe(rl())}function T8(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return L(!0);let s=i.map(o=>{let a=il(o,t),l=h8(a)?a.canLoad(e,n):Wn(t,()=>a(e,n));return rs(l)});return L(s).pipe(rl(),AO(r))}function AO(t){return c_(Ze(e=>{if(tl(e))throw DO(t,e)}),F(e=>e===!0))}function b8(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return L(!0);let s=i.map(o=>{let a=il(o,t),l=m8(a)?a.canMatch(e,n):Wn(t,()=>a(e,n));return rs(l)});return L(s).pipe(rl(),AO(r))}var Uu=class{constructor(e){this.segmentGroup=e||null}},Fg=class extends Error{constructor(e){super(),this.urlTree=e}};function Ya(t){return Jo(new Uu(t))}function S8(t){return Jo(new V(4e3,!1))}function A8(t){return Jo(TO(!1,wn.GuardRejected))}var LC=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return L(r);if(i.numberOfChildren>1||!i.children[ne])return S8(e.redirectTo);i=i.children[ne]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Fg(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Ji(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,r,i)}),new Ie(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new V(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},VC={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function x8(t,e,n,r,i){let s=GC(t,e,n);return s.matched?(r=i8(e,r),b8(r,e,n,i).pipe(F(o=>o===!0?s:M({},VC)))):L(s)}function GC(t,e,n){if(e.path==="**")return R8(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?M({},VC):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||b9)(n,t,e);if(!i)return M({},VC);let s={};Object.entries(i.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let o=i.consumed.length>0?M(M({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function R8(t){return{matched:!0,parameters:t.length>0?aO(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function rO(t,e,n,r){return n.length>0&&P8(t,n,r)?{segmentGroup:new Ie(e,N8(r,new Ie(n,t.children))),slicedSegments:[]}:n.length===0&&k8(t,n,r)?{segmentGroup:new Ie(t.segments,M8(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ie(t.segments,t.children),slicedSegments:n}}function M8(t,e,n,r){let i={};for(let s of n)if(Ug(t,e,s)&&!r[Rr(s)]){let o=new Ie([],{});i[Rr(s)]=o}return M(M({},r),i)}function N8(t,e){let n={};n[ne]=e;for(let r of t)if(r.path===""&&Rr(r)!==ne){let i=new Ie([],{});n[Rr(r)]=i}return n}function P8(t,e,n){return n.some(r=>Ug(t,e,r)&&Rr(r)!==ne)}function k8(t,e,n){return n.some(r=>Ug(t,e,r))}function Ug(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function O8(t,e,n,r){return Rr(t)!==r&&(r===ne||!Ug(e,n,t))?!1:GC(e,t,n).matched}function F8(t,e,n){return e.length===0&&!t.children[n]}var jC=class{};function L8(t,e,n,r,i,s,o="emptyOnly"){return new UC(t,e,n,r,i,o,s).recognize()}var V8=31,UC=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new LC(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new V(4002,`'${e.segmentGroup}'`)}recognize(){let e=rO(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(F(n=>{let r=new Vu([],Object.freeze({}),Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,{},ne,this.rootComponentType,null,{}),i=new vn(r,n),s=new kg("",i),o=z9(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ne).pipe(Di(r=>{if(r instanceof Fg)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Uu?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=$C(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(F(s=>s instanceof vn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return re(i).pipe(Kr(s=>{let o=r.children[s],a=s8(n,s);return this.processSegmentGroup(e,a,o,s)}),cr((s,o)=>(s.push(...o),s)),Ti(null),v_(),ot(s=>{if(s===null)return Ya(r);let o=xO(s);return j8(o),L(o)}))}processSegment(e,n,r,i,s,o){return re(n).pipe(Kr(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Di(l=>{if(l instanceof Uu)return L(null);throw l}))),bn(a=>!!a),Di(a=>{if(SO(a))return F8(r,i,s)?L(new jC):Ya(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return O8(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Ya(i):Ya(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:l,positionalParamSegments:c,remainingSegments:u}=GC(n,i,s);if(!a)return Ya(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>V8&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(ot(h=>this.processSegment(e,r,n,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=x8(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Ce(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ce(({routes:l})=>{let c=r._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new Vu(u,h,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,B8(r),Rr(r),r.component??r._loadedComponent??null,r,$8(r)),{segmentGroup:p,slicedSegments:g}=rO(n,u,d,l);if(g.length===0&&p.hasChildren())return this.processChildren(c,l,p).pipe(F(w=>w===null?null:new vn(f,w)));if(l.length===0&&g.length===0)return L(new vn(f,[]));let m=Rr(r)===s;return this.processSegment(c,l,p,g,m?ne:s,!0).pipe(F(w=>new vn(f,w instanceof vn?[w]:[])))}))):Ya(n)))}getChildConfig(e,n,r){return n.children?L({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?L({routes:n._loadedRoutes,injector:n._loadedInjector}):T8(e,n,r,this.urlSerializer).pipe(ot(i=>i?this.configLoader.loadChildren(e,n).pipe(Ze(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):A8(n))):L({routes:[],injector:e})}};function j8(t){t.sort((e,n)=>e.value.outlet===ne?-1:n.value.outlet===ne?1:e.value.outlet.localeCompare(n.value.outlet))}function U8(t){let e=t.value.routeConfig;return e&&e.path===""}function xO(t){let e=[],n=new Set;for(let r of t){if(!U8(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=xO(r.children);e.push(new vn(r.value,i))}return e.filter(r=>!n.has(r))}function B8(t){return t.data||{}}function $8(t){return t.resolve||{}}function q8(t,e,n,r,i,s){return ot(o=>L8(t,e,n,r,o.extractedUrl,i,s).pipe(F(({state:a,tree:l})=>fe(M({},o),{targetSnapshot:a,urlAfterRedirects:l}))))}function H8(t,e){return ot(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return L(n);let s=new Set(i.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let c of RO(l))o.add(c);let a=0;return re(o).pipe(Kr(l=>s.has(l)?z8(l,r,t,e):(l.data=$C(l,l.parent,t).resolve,L(void 0))),Ze(()=>a++),na(1),ot(l=>a===o.size?L(n):Gt))})}function RO(t){let e=t.children.map(n=>RO(n)).flat();return[t,...e]}function z8(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!IO(i)&&(s[Bu]=i.title),G8(s,t,e,r).pipe(F(o=>(t._resolvedData=o,t.data=$C(t,t.parent,n).resolve,null)))}function G8(t,e,n,r){let i=yC(t);if(i.length===0)return L({});let s={};return re(i).pipe(ot(o=>W8(t[o],e,n,r).pipe(bn(),Ze(a=>{s[o]=a}))),na(1),__(s),Di(o=>SO(o)?Gt:Jo(o)))}function W8(t,e,n,r){let i=Hu(e)??r,s=il(t,i),o=s.resolve?s.resolve(e,n):Wn(i,()=>s(e,n));return rs(o)}function gC(t){return Ce(e=>{let n=t(e);return n?re(n).pipe(F(()=>e)):L(e)})}var MO=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ne);return i}getResolvedTitleForRoute(r){return r.data[Bu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>A(K8),providedIn:"root"});let t=e;return t})(),K8=(()=>{let e=class e extends MO{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(E(DM))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Gu=new x("",{providedIn:"root",factory:()=>({})}),Lg=new x(""),WC=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=A(rp)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return L(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=rs(r.loadComponent()).pipe(F(NO),Ze(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),bi(()=>{this.componentLoaders.delete(r)})),s=new Ko(i,()=>new Ge).pipe(Wo());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return L({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=Q8(i,this.compiler,r,this.onLoadEndListener).pipe(bi(()=>{this.childrenLoaders.delete(i)})),a=new Ko(o,()=>new Ge).pipe(Wo());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Q8(t,e,n,r){return rs(t.loadChildren()).pipe(F(NO),ot(i=>i instanceof _c||Array.isArray(i)?L(i):re(e.compileModuleAsync(i))),F(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Lg,[],{optional:!0,self:!0}).flat()),{routes:o.map(zC),injector:s}}))}function Y8(t){return t&&typeof t=="object"&&"default"in t}function NO(t){return Y8(t)?t.default:t}var KC=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>A(X8),providedIn:"root"});let t=e;return t})(),X8=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),PO=new x(""),kO=new x("");function Z8(t,e,n){let r=t.get(kO),i=t.get(jt);return t.get(ie).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),J8(t))),{onViewTransitionCreated:l}=r;return l&&Wn(t,()=>l({transition:a,from:e,to:n})),o})}function J8(t){return new Promise(e=>{hw(e,{injector:t})})}var QC=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ge,this.transitionAbortSubject=new Ge,this.configLoader=A(WC),this.environmentInjector=A(Kt),this.urlSerializer=A($u),this.rootContexts=A(qu),this.location=A(Ca),this.inputBindingEnabled=A(jg,{optional:!0})!==null,this.titleStrategy=A(MO),this.options=A(Gu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=A(KC),this.createViewTransition=A(PO,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>L(void 0),this.rootComponentType=null;let r=s=>this.events.next(new TC(s)),i=s=>this.events.next(new bC(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(fe(M(M({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new xt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Mu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(gt(o=>o.id!==0),F(o=>fe(M({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ce(o=>{let a=!1,l=!1;return L(o).pipe(Ce(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",wn.SupersededByNewNavigation),Gt;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?fe(M({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new ts(c.id,this.urlSerializer.serialize(c.rawUrl),h,xg.IgnoredSameUrlNavigation)),c.resolve(null),Gt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return L(c).pipe(Ce(h=>{let f=this.transitions?.getValue();return this.events.next(new nl(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Gt:Promise.resolve(h)}),q8(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Ze(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=fe(M({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Rg(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:m}=c,w=new nl(h,this.urlSerializer.serialize(f),p,g);this.events.next(w);let S=wO(this.rootComponentType).snapshot;return this.currentTransition=o=fe(M({},c),{targetSnapshot:S,urlAfterRedirects:f,extras:fe(M({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,L(o)}else{let h="";return this.events.next(new ts(c.id,this.urlSerializer.serialize(c.extractedUrl),h,xg.IgnoredByUrlHandlingStrategy)),c.resolve(null),Gt}}),Ze(c=>{let u=new EC(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),F(c=>(this.currentTransition=o=fe(M({},c),{guards:a8(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),y8(this.environmentInjector,c=>this.events.next(c)),Ze(c=>{if(o.guardsResult=c.guardsResult,tl(c.guardsResult))throw DO(this.urlSerializer,c.guardsResult);let u=new IC(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),gt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",wn.GuardRejected),!1)),gC(c=>{if(c.guards.canActivateChecks.length)return L(c).pipe(Ze(u=>{let d=new CC(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Ce(u=>{let d=!1;return L(u).pipe(H8(this.paramsInheritanceStrategy,this.environmentInjector),Ze({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",wn.NoDataFromResolver)}}))}),Ze(u=>{let d=new DC(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),gC(c=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Ze(f=>{d.component=f}),F(()=>{})));for(let f of d.children)h.push(...u(f));return h};return ic(u(c.targetSnapshot.root)).pipe(Ti(null),Qr(1))}),gC(()=>this.afterPreactivation()),Ce(()=>{let{currentSnapshot:c,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return d?re(d).pipe(F(()=>o)):L(o)}),F(c=>{let u=J9(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=fe(M({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),Ze(()=>{this.events.next(new Fu)}),o8(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Qr(1),Ze({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new xr(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),I_(this.transitionAbortSubject.pipe(Ze(c=>{throw c}))),bi(()=>{!a&&!l&&this.cancelNavigationTransition(o,"",wn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Di(c=>{if(l=!0,bO(c))this.events.next(new es(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),n8(c)?this.events.next(new Lu(c.url)):o.resolve(!1);else{this.events.next(new Ou(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return Gt}))}))}cancelNavigationTransition(r,i,s){let o=new es(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function e6(t){return t!==Mu}var t6=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>A(n6),providedIn:"root"});let t=e;return t})(),BC=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},n6=(()=>{let e=class e extends BC{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ei(e)))(s||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),OO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>A(r6),providedIn:"root"});let t=e;return t})(),r6=(()=>{let e=class e extends OO{constructor(){super(...arguments),this.location=A(Ca),this.urlSerializer=A($u),this.options=A(Gu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=A(KC),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ji,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=wO(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof nl)this.stateMemento=this.createStateMemento();else if(r instanceof ts)this.rawUrlTree=i.initialUrl;else if(r instanceof Rg){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Fu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof es&&(r.code===wn.GuardRejected||r.code===wn.NoDataFromResolver)?this.restoreHistory(i):r instanceof Ou?this.restoreHistory(i,!0):r instanceof xr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=M(M({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=M(M({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ei(e)))(s||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),xu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(xu||{});function FO(t,e){t.events.pipe(gt(n=>n instanceof xr||n instanceof es||n instanceof Ou||n instanceof ts),F(n=>n instanceof xr||n instanceof ts?xu.COMPLETE:(n instanceof es?n.code===wn.Redirect||n.code===wn.SupersededByNewNavigation:!1)?xu.REDIRECTING:xu.FAILED),gt(n=>n!==xu.REDIRECTING),Qr(1)).subscribe(()=>{e()})}function i6(t){throw t}var s6={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},o6={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ns=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=A(Zf),this.stateManager=A(OO),this.options=A(Gu,{optional:!0})||{},this.pendingTasks=A(qs),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=A(QC),this.urlSerializer=A($u),this.location=A(Ca),this.urlHandlingStrategy=A(KC),this._events=new Ge,this.errorHandler=this.options.errorHandler||i6,this.navigated=!1,this.routeReuseStrategy=A(t6),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=A(Lg,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!A(jg,{optional:!0}),this.eventsSubscription=new Xe,this.isNgZoneEnabled=A(ie)instanceof ie&&ie.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof es&&i.code!==wn.Redirect&&i.code!==wn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof xr)this.navigated=!0;else if(i instanceof Lu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),l={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||e6(s.source)};this.scheduleNavigation(a,Mu,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}l6(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Mu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=M({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(zC),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:l,preserveFragment:c}=i,u=c?this.currentUrlTree.fragment:a,d=null;switch(l){case"merge":d=M(M({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=mO(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return yO(h,r,d,u??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=tl(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Mu,null,i)}navigate(r,i={skipLocationChange:!1}){return a6(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=M({},s6):i===!1?s=M({},o6):s=i,tl(r))return Zk(this.currentUrlTree,r,s);let o=this.parseUrl(r);return Zk(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let l,c,u;a?(l=a.resolve,c=a.reject,u=a.promise):u=new Promise((h,f)=>{l=h,c=f});let d=this.pendingTasks.add();return FO(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function a6(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new V(4008,!1)}function l6(t){return!(t instanceof Fu)&&!(t instanceof Lu)}var LO=(()=>{let e=class e{constructor(r,i,s,o,a,l){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=l,this.href=null,this.commands=null,this.onChanges=new Ge,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(u=>{u instanceof xr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let l=this.urlTree;if(l===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:Ux(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(se(ns),se(ao),Wv("tabindex"),se(ri),se(yr),se(si))},e.\u0275dir=et({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Yt("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Sc("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Lt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Vi],skipLocationChange:[Lt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Vi],replaceUrl:[Lt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Vi],routerLink:"routerLink"},standalone:!0,features:[pw,ki]});let t=e;return t})();var Vg=class{};var c6=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(gt(r=>r instanceof xr),Kr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Kf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,l=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(l,o.children??o._loadedRoutes))}return re(s).pipe(Ci())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=L(null);let o=s.pipe(ot(a=>a===null?L(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return re([o,a]).pipe(Ci())}else return o})}};e.\u0275fac=function(i){return new(i||e)(E(ns),E(rp),E(Kt),E(Vg),E(WC))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),VO=new x(""),u6=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof nl?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof xr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof ts&&r.code===xg.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Mg&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Mg(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Zx()},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function d6(t){return t.routerState.root}function Wu(t,e){return{\u0275kind:t,\u0275providers:e}}function h6(){let t=A(Qn);return e=>{let n=t.get(zs);if(e!==n.components[0])return;let r=t.get(ns),i=t.get(jO);t.get(YC)===1&&r.initialNavigation(),t.get(UO,null,le.Optional)?.setUpPreloading(),t.get(VO,null,le.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var jO=new x("",{factory:()=>new Ge}),YC=new x("",{providedIn:"root",factory:()=>1});function f6(){return Wu(2,[{provide:YC,useValue:0},{provide:tp,multi:!0,deps:[Qn],useFactory:e=>{let n=e.get(ZR,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(ns),s=e.get(jO);FO(i,()=>{r(!0)}),e.get(QC).afterPreactivation=()=>(r(!0),s.closed?L(void 0):s),i.initialNavigation()}))}}])}function p6(){return Wu(3,[{provide:tp,multi:!0,useFactory:()=>{let e=A(ns);return()=>{e.setUpLocationChangeListener()}}},{provide:YC,useValue:2}])}var UO=new x("");function g6(t){return Wu(0,[{provide:UO,useExisting:c6},{provide:Vg,useExisting:t}])}function m6(){return Wu(8,[nO,{provide:jg,useExisting:nO}])}function y6(t){let e=[{provide:PO,useValue:Z8},{provide:kO,useValue:M({skipNextTransition:!!t?.skipInitialTransition},t)}];return Wu(9,e)}var iO=new x("ROUTER_FORROOT_GUARD"),_6=[Ca,{provide:$u,useClass:Pu},ns,qu,{provide:ao,useFactory:d6,deps:[ns]},WC,[]],XC=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[_6,[],{provide:Lg,multi:!0,useValue:r},{provide:iO,useFactory:I6,deps:[[ns,new _a,new Mv]]},{provide:Gu,useValue:i||{}},i?.useHash?w6():E6(),v6(),i?.preloadingStrategy?g6(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?C6(i):[],i?.bindToComponentInputs?m6().\u0275providers:[],i?.enableViewTransitions?y6().\u0275providers:[],D6()]}}static forChild(r){return{ngModule:e,providers:[{provide:Lg,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(E(iO,8))},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({});let t=e;return t})();function v6(){return{provide:VO,useFactory:()=>{let t=A(rM),e=A(ie),n=A(Gu),r=A(QC),i=A($u);return n.scrollOffset&&t.setOffset(n.scrollOffset),new u6(i,r,t,e,n)}}}function w6(){return{provide:si,useClass:eM}}function E6(){return{provide:si,useClass:xw}}function I6(t){return"guarded"}function C6(t){return[t.initialNavigation==="disabled"?p6().\u0275providers:[],t.initialNavigation==="enabledBlocking"?f6().\u0275providers:[]]}var sO=new x("");function D6(){return[{provide:sO,useFactory:h6},{provide:np,multi:!0,useExisting:sO}]}var is=class{};var T6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nr={},P,v0=v0||{},X=T6||self;function em(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function ad(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function b6(t){return Object.prototype.hasOwnProperty.call(t,ZC)&&t[ZC]||(t[ZC]=++S6)}var ZC="closure_uid_"+(1e9*Math.random()>>>0),S6=0;function A6(t,e,n){return t.call.apply(t.bind,arguments)}function x6(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function $t(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?$t=A6:$t=x6,$t.apply(null,arguments)}function Bg(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Dt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ss(){this.s=this.s,this.o=this.o}var R6=0;ss.prototype.s=!1;ss.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),R6!=0)&&b6(this)};ss.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var e1=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function w0(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function $O(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(em(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function qt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}qt.prototype.h=function(){this.defaultPrevented=!0};var M6=function(){if(!X.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};X.addEventListener("test",n,e),X.removeEventListener("test",n,e)}catch{}return t}();function Ju(t){return/^[\s\xa0]*$/.test(t)}function tm(){var t=X.navigator;return t&&(t=t.userAgent)?t:""}function Mr(t){return tm().indexOf(t)!=-1}function E0(t){return E0[" "](t),t}E0[" "]=function(){};function N6(t,e){var n=wK;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var P6=Mr("Opera"),ll=Mr("Trident")||Mr("MSIE"),t1=Mr("Edge"),r0=t1||ll,n1=Mr("Gecko")&&!(tm().toLowerCase().indexOf("webkit")!=-1&&!Mr("Edge"))&&!(Mr("Trident")||Mr("MSIE"))&&!Mr("Edge"),k6=tm().toLowerCase().indexOf("webkit")!=-1&&!Mr("Edge");function r1(){var t=X.document;return t?t.documentMode:void 0}var i0;e:{if($g="",qg=function(){var t=tm();if(n1)return/rv:([^\);]+)(\)|;)/.exec(t);if(t1)return/Edge\/([\d\.]+)/.exec(t);if(ll)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(k6)return/WebKit\/(\S+)/.exec(t);if(P6)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),qg&&($g=qg?qg[1]:""),ll&&(Hg=r1(),Hg!=null&&Hg>parseFloat($g))){i0=String(Hg);break e}i0=$g}var $g,qg,Hg,s0;X.document&&ll?(JC=r1(),s0=JC||parseInt(i0,10)||void 0):s0=void 0;var JC,O6=s0;function ed(t,e){if(qt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(n1){e:{try{E0(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:F6[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ed.$.h.call(this)}}Dt(ed,qt);var F6={2:"touch",3:"pen",4:"mouse"};ed.prototype.h=function(){ed.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ld="closure_listenable_"+(1e6*Math.random()|0),L6=0;function V6(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++L6,this.fa=this.ia=!1}function nm(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function I0(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function j6(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function i1(t){let e={};for(let n in t)e[n]=t[n];return e}var qO="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function s1(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<qO.length;s++)n=qO[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rm(t){this.src=t,this.g={},this.h=0}rm.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=a0(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new V6(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function o0(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=e1(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(nm(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function a0(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var C0="closure_lm_"+(1e6*Math.random()|0),e0={};function o1(t,e,n,r,i){if(r&&r.once)return l1(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)o1(t,e[s],n,r,i);return null}return n=b0(n),t&&t[ld]?t.O(e,n,ad(r)?!!r.capture:!!r,i):a1(t,e,n,!1,r,i)}function a1(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=ad(i)?!!i.capture:!!i,a=T0(t);if(a||(t[C0]=a=new rm(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=U6(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)M6||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(u1(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function U6(){function t(n){return e.call(t.src,t.listener,n)}let e=B6;return t}function l1(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)l1(t,e[s],n,r,i);return null}return n=b0(n),t&&t[ld]?t.P(e,n,ad(r)?!!r.capture:!!r,i):a1(t,e,n,!0,r,i)}function c1(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)c1(t,e[s],n,r,i);else r=ad(r)?!!r.capture:!!r,n=b0(n),t&&t[ld]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=a0(s,n,r,i),-1<n&&(nm(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=T0(t))&&(e=t.g[e.toString()],t=-1,e&&(t=a0(e,n,r,i)),(n=-1<t?e[t]:null)&&D0(n))}function D0(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[ld])o0(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(u1(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=T0(e))?(o0(n,t),n.h==0&&(n.src=null,e[C0]=null)):nm(t)}}}function u1(t){return t in e0?e0[t]:e0[t]="on"+t}function B6(t,e){if(t.fa)t=!0;else{e=new ed(e,this);var n=t.listener,r=t.la||t.src;t.ia&&D0(t),t=n.call(r,e)}return t}function T0(t){return t=t[C0],t instanceof rm?t:null}var t0="__closure_events_fn_"+(1e9*Math.random()>>>0);function b0(t){return typeof t=="function"?t:(t[t0]||(t[t0]=function(e){return t.handleEvent(e)}),t[t0])}function Ct(){ss.call(this),this.i=new rm(this),this.S=this,this.J=null}Dt(Ct,ss);Ct.prototype[ld]=!0;Ct.prototype.removeEventListener=function(t,e,n,r){c1(this,t,e,n,r)};function Ot(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new qt(e,t);else if(e instanceof qt)e.target=e.target||t;else{var i=e;e=new qt(r,t),s1(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=zg(o,r,!0,e)&&i}if(o=e.g=t,i=zg(o,r,!0,e)&&i,i=zg(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=zg(o,r,!1,e)&&i}Ct.prototype.N=function(){if(Ct.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)nm(n[r]);delete t.g[e],t.h--}}this.J=null};Ct.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Ct.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function zg(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&o0(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var S0=X.JSON.stringify,l0=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function $6(){var t=A0;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var c0=class{constructor(){this.h=this.g=null}add(e,n){let r=d1.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},d1=new l0(()=>new u0,t=>t.reset()),u0=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function q6(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function H6(t){X.setTimeout(()=>{throw t},0)}var td,nd=!1,A0=new c0,h1=()=>{let t=X.Promise.resolve(void 0);td=()=>{t.then(z6)}},z6=()=>{for(var t;t=$6();){try{t.h.call(t.g)}catch(n){H6(n)}var e=d1;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}nd=!1};function im(t,e){Ct.call(this),this.h=t||1,this.g=e||X,this.j=$t(this.qb,this),this.l=Date.now()}Dt(im,Ct);P=im.prototype;P.ga=!1;P.T=null;P.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ot(this,"tick"),this.ga&&(x0(this),this.start()))}};P.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function x0(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}P.N=function(){im.$.N.call(this),x0(this),delete this.g};function R0(t,e,n){if(typeof t=="function")n&&(t=$t(t,n));else if(t&&typeof t.handleEvent=="function")t=$t(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:X.setTimeout(t,e||0)}function f1(t){t.g=R0(()=>{t.g=null,t.i&&(t.i=!1,f1(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var d0=class extends ss{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:f1(this)}N(){super.N(),this.g&&(X.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function rd(t){ss.call(this),this.h=t,this.g={}}Dt(rd,ss);var HO=[];function p1(t,e,n,r){Array.isArray(n)||(n&&(HO[0]=n.toString()),n=HO);for(var i=0;i<n.length;i++){var s=o1(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function g1(t){I0(t.g,function(e,n){this.g.hasOwnProperty(n)&&D0(e)},t),t.g={}}rd.prototype.N=function(){rd.$.N.call(this),g1(this)};rd.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function sm(){this.g=!0}sm.prototype.Ea=function(){this.g=!1};function G6(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&d[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function W6(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function ol(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Q6(t,n)+(r?" "+r:"")})}function K6(t,e){t.info(function(){return"TIMEOUT: "+e})}sm.prototype.info=function(){};function Q6(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return S0(n)}catch{return e}}var ho={},zO=null;function om(){return zO=zO||new Ct}ho.Ta="serverreachability";function m1(t){qt.call(this,ho.Ta,t)}Dt(m1,qt);function id(t){let e=om();Ot(e,new m1(e))}ho.STAT_EVENT="statevent";function y1(t,e){qt.call(this,ho.STAT_EVENT,t),this.stat=e}Dt(y1,qt);function tn(t){let e=om();Ot(e,new y1(e,t))}ho.Ua="timingevent";function _1(t,e){qt.call(this,ho.Ua,t),this.size=e}Dt(_1,qt);function cd(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return X.setTimeout(function(){t()},e)}var am={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},v1={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function M0(){}M0.prototype.h=null;function GO(t){return t.h||(t.h=t.i())}function w1(){}var ud={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function N0(){qt.call(this,"d")}Dt(N0,qt);function P0(){qt.call(this,"c")}Dt(P0,qt);var h0;function lm(){}Dt(lm,M0);lm.prototype.g=function(){return new XMLHttpRequest};lm.prototype.i=function(){return{}};h0=new lm;function dd(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new rd(this),this.P=Y6,t=r0?125:void 0,this.V=new im(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new E1}function E1(){this.i=null,this.g="",this.h=!1}var Y6=45e3,I1={},f0={};P=dd.prototype;P.setTimeout=function(t){this.P=t};function p0(t,e,n){t.L=1,t.A=um(di(e)),t.u=n,t.S=!0,C1(t,null)}function C1(t,e){t.G=Date.now(),hd(t),t.B=di(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),M1(n.i,"t",r),t.o=0,n=t.l.J,t.h=new E1,t.g=Z1(t.l,n?e:null,!t.u),0<t.O&&(t.M=new d0($t(t.Pa,t,t.g),t.O)),p1(t.U,t.g,"readystatechange",t.nb),e=t.I?i1(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),id(),G6(t.j,t.v,t.B,t.m,t.W,t.u)}P.nb=function(t){t=t.target;let e=this.M;e&&Nr(t)==3?e.l():this.Pa(t)};P.Pa=function(t){try{if(t==this.g)e:{let u=Nr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>u)&&(u!=3||r0||this.g&&(this.h.h||this.g.ja()||YO(this.g)))){this.J||u!=4||e==7||(e==8||0>=d?id(3):id(2)),cm(this);var n=this.g.da();this.ca=n;t:if(D1(this)){var r=YO(this.g);t="";var i=r.length,s=Nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){lo(this),Zu(this);var o="";break t}this.h.i=new X.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,W6(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ju(a)){var c=a;break t}}c=null}if(n=c)ol(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,g0(this,n);else{this.i=!1,this.s=3,tn(12),lo(this),Zu(this);break e}}this.S?(T1(this,u,o),r0&&this.i&&u==3&&(p1(this.U,this.V,"tick",this.mb),this.V.start())):(ol(this.j,this.m,o,null),g0(this,o)),u==4&&lo(this),this.i&&!this.J&&(u==4?K1(this.l,this):(this.i=!1,hd(this)))}else yK(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,tn(12)):(this.s=0,tn(13)),lo(this),Zu(this)}}}catch{}finally{}};function D1(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function T1(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=X6(t,n),i==f0){e==4&&(t.s=4,tn(14),r=!1),ol(t.j,t.m,null,"[Incomplete Response]");break}else if(i==I1){t.s=4,tn(15),ol(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else ol(t.j,t.m,i,null),g0(t,i);D1(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,tn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),j0(e),e.M=!0,tn(11))):(ol(t.j,t.m,n,"[Invalid Chunked Response]"),lo(t),Zu(t))}P.mb=function(){if(this.g){var t=Nr(this.g),e=this.g.ja();this.o<e.length&&(cm(this),T1(this,t,e),this.i&&t!=4&&hd(this))}};function X6(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?f0:(n=Number(e.substring(n,r)),isNaN(n)?I1:(r+=1,r+n>e.length?f0:(e=e.slice(r,r+n),t.o=r+n,e)))}P.cancel=function(){this.J=!0,lo(this)};function hd(t){t.Y=Date.now()+t.P,b1(t,t.P)}function b1(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=cd($t(t.lb,t),e)}function cm(t){t.C&&(X.clearTimeout(t.C),t.C=null)}P.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(K6(this.j,this.B),this.L!=2&&(id(),tn(17)),lo(this),this.s=2,Zu(this)):b1(this,this.Y-t)};function Zu(t){t.l.H==0||t.J||K1(t.l,t)}function lo(t){cm(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,x0(t.V),g1(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function g0(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||m0(n.i,t))){if(!t.K&&m0(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Yg(n),fm(n);else break e;V0(n),tn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=cd($t(n.ib,n),6e3));if(1>=k1(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else co(n,11)}else if((t.K||n.g==t)&&Yg(n),!Ju(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let u=c[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(k0(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Fe(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=X1(r,r.J?r.pa:null,r.Y),o.K){O1(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.C&&(cm(a),hd(a)),r.g=o}else G1(r);0<n.j.length&&pm(n)}else c[0]!="stop"&&c[0]!="close"||co(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?co(n,7):L0(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}id(4)}catch{}}function Z6(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(em(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function J6(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(em(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function S1(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(em(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=J6(t),r=Z6(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var A1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eK(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function uo(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof uo){this.h=t.h,Kg(this,t.j),this.s=t.s,this.g=t.g,Qg(this,t.m),this.l=t.l;var e=t.i,n=new sd;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),WO(this,n),this.o=t.o}else t&&(e=String(t).match(A1))?(this.h=!1,Kg(this,e[1]||"",!0),this.s=Yu(e[2]||""),this.g=Yu(e[3]||"",!0),Qg(this,e[4]),this.l=Yu(e[5]||"",!0),WO(this,e[6]||"",!0),this.o=Yu(e[7]||"")):(this.h=!1,this.i=new sd(null,this.h))}uo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Xu(e,KO,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Xu(e,KO,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Xu(n,n.charAt(0)=="/"?rK:nK,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Xu(n,sK)),t.join("")};function di(t){return new uo(t)}function Kg(t,e,n){t.j=n?Yu(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Qg(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function WO(t,e,n){e instanceof sd?(t.i=e,oK(t.i,t.h)):(n||(e=Xu(e,iK)),t.i=new sd(e,t.h))}function Fe(t,e,n){t.i.set(e,n)}function um(t){return Fe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Yu(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Xu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,tK),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tK(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var KO=/[#\/\?@]/g,nK=/[#\?:]/g,rK=/[#\?]/g,iK=/[#\?@]/g,sK=/#/g;function sd(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function os(t){t.g||(t.g=new Map,t.h=0,t.i&&eK(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}P=sd.prototype;P.add=function(t,e){os(this),this.i=null,t=cl(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function x1(t,e){os(t),e=cl(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function R1(t,e){return os(t),e=cl(t,e),t.g.has(e)}P.forEach=function(t,e){os(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};P.ta=function(){os(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};P.Z=function(t){os(this);let e=[];if(typeof t=="string")R1(this,t)&&(e=e.concat(this.g.get(cl(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};P.set=function(t,e){return os(this),this.i=null,t=cl(this,t),R1(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};P.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function M1(t,e,n){x1(t,e),0<n.length&&(t.i=null,t.g.set(cl(t,e),w0(n)),t.h+=n.length)}P.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function cl(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function oK(t,e){e&&!t.j&&(os(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(x1(this,r),M1(this,i,n))},t)),t.j=e}var aK=class{constructor(t,e){this.g=t,this.map=e}};function N1(t){this.l=t||lK,X.PerformanceNavigationTiming?(t=X.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(X.g&&X.g.Ka&&X.g.Ka()&&X.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var lK=10;function P1(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function k1(t){return t.h?1:t.g?t.g.size:0}function m0(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function k0(t,e){t.g?t.g.add(e):t.h=e}function O1(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}N1.prototype.cancel=function(){if(this.i=F1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function F1(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return w0(t.i)}var cK=class{stringify(t){return X.JSON.stringify(t,void 0)}parse(t){return X.JSON.parse(t,void 0)}};function uK(){this.g=new cK}function dK(t,e,n){let r=n||"";try{S1(t,function(i,s){let o=i;ad(i)&&(o=S0(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function hK(t,e){let n=new sm;if(X.Image){let r=new Image;r.onload=Bg(Gg,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Bg(Gg,n,r,"TestLoadImage: error",!1,e),r.onabort=Bg(Gg,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Bg(Gg,n,r,"TestLoadImage: timeout",!1,e),X.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Gg(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function fd(t){this.l=t.ec||null,this.j=t.ob||!1}Dt(fd,M0);fd.prototype.g=function(){return new dm(this.l,this.j)};fd.prototype.i=function(t){return function(){return t}}({});function dm(t,e){Ct.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=O0,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Dt(dm,Ct);var O0=0;P=dm.prototype;P.open=function(t,e){if(this.readyState!=O0)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,od(this)};P.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||X).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,pd(this)),this.readyState=O0};P.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,od(this)),this.g&&(this.readyState=3,od(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof X.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;L1(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function L1(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}P.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?pd(this):od(this),this.readyState==3&&L1(this)}};P.Za=function(t){this.g&&(this.response=this.responseText=t,pd(this))};P.Ya=function(t){this.g&&(this.response=t,pd(this))};P.ka=function(){this.g&&pd(this)};function pd(t){t.readyState=4,t.l=null,t.j=null,t.A=null,od(t)}P.setRequestHeader=function(t,e){this.v.append(t,e)};P.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};P.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function od(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(dm.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var fK=X.JSON.parse;function We(t){Ct.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=V1,this.L=this.M=!1}Dt(We,Ct);var V1="",pK=/^https?$/i,gK=["POST","PUT"];P=We.prototype;P.Oa=function(t){this.M=t};P.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():h0.g(),this.C=this.u?GO(this.u):GO(h0),this.g.onreadystatechange=$t(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){QO(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=X.FormData&&t instanceof X.FormData,!(0<=e1(gK,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{B1(this),0<this.B&&((this.L=mK(this.g))?(this.g.timeout=this.B,this.g.ontimeout=$t(this.ua,this)):this.A=R0(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){QO(this,s)}};function mK(t){return ll&&typeof t.timeout=="number"&&t.ontimeout!==void 0}P.ua=function(){typeof v0<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ot(this,"timeout"),this.abort(8))};function QO(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,j1(t),hm(t)}function j1(t){t.F||(t.F=!0,Ot(t,"complete"),Ot(t,"error"))}P.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ot(this,"complete"),Ot(this,"abort"),hm(this))};P.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),hm(this,!0)),We.$.N.call(this)};P.La=function(){this.s||(this.G||this.v||this.l?U1(this):this.kb())};P.kb=function(){U1(this)};function U1(t){if(t.h&&typeof v0<"u"&&(!t.C[1]||Nr(t)!=4||t.da()!=2)){if(t.v&&Nr(t)==4)R0(t.La,0,t);else if(Ot(t,"readystatechange"),Nr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(A1)[1]||null;!i&&X.self&&X.self.location&&(i=X.self.location.protocol.slice(0,-1)),r=!pK.test(i?i.toLowerCase():"")}n=r}if(n)Ot(t,"complete"),Ot(t,"success");else{t.m=6;try{var s=2<Nr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",j1(t)}}finally{hm(t)}}}}function hm(t,e){if(t.g){B1(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Ot(t,"ready");try{n.onreadystatechange=r}catch{}}}function B1(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(X.clearTimeout(t.A),t.A=null)}P.isActive=function(){return!!this.g};function Nr(t){return t.g?t.g.readyState:0}P.da=function(){try{return 2<Nr(this)?this.g.status:-1}catch{return-1}};P.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};P.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),fK(e)}};function YO(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case V1:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function yK(t){let e={};t=(t.g&&2<=Nr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Ju(t[r]))continue;var n=q6(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}j6(e,function(r){return r.join(", ")})}P.Ia=function(){return this.m};P.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function $1(t){let e="";return I0(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function F0(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=$1(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Fe(t,e,n))}function Ku(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function q1(t){this.Ga=0,this.j=[],this.l=new sm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ku("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ku("baseRetryDelayMs",5e3,t),this.hb=Ku("retryDelaySeedMs",1e4,t),this.eb=Ku("forwardChannelMaxRetries",2,t),this.xa=Ku("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new N1(t&&t.concurrentRequestLimit),this.Ja=new uK,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}P=q1.prototype;P.ra=8;P.H=1;function L0(t){if(H1(t),t.H==3){var e=t.W++,n=di(t.I);if(Fe(n,"SID",t.K),Fe(n,"RID",e),Fe(n,"TYPE","terminate"),gd(t,n),e=new dd(t,t.l,e),e.L=2,e.A=um(di(n)),n=!1,X.navigator&&X.navigator.sendBeacon)try{n=X.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&X.Image&&(new Image().src=e.A,n=!0),n||(e.g=Z1(e.l,null),e.g.ha(e.A)),e.G=Date.now(),hd(e)}Y1(t)}function fm(t){t.g&&(j0(t),t.g.cancel(),t.g=null)}function H1(t){fm(t),t.u&&(X.clearTimeout(t.u),t.u=null),Yg(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&X.clearTimeout(t.m),t.m=null)}function pm(t){if(!P1(t.i)&&!t.m){t.m=!0;var e=t.Na;td||h1(),nd||(td(),nd=!0),A0.add(e,t),t.C=0}}function _K(t,e){return k1(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=cd($t(t.Na,t,e),Q1(t,t.C)),t.C++,!0)}P.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new dd(this,this.l,t),s=this.s;if(this.U&&(s?(s=i1(s),s1(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=z1(this,i,e),n=di(this.I),Fe(n,"RID",t),Fe(n,"CVER",22),this.F&&Fe(n,"X-HTTP-Session-Id",this.F),gd(this,n),s&&(this.O?e="headers="+encodeURIComponent(String($1(s)))+"&"+e:this.o&&F0(n,this.o,s)),k0(this.i,i),this.bb&&Fe(n,"TYPE","init"),this.P?(Fe(n,"$req",e),Fe(n,"SID","null"),i.aa=!0,p0(i,n,null)):p0(i,n,e),this.H=2}}else this.H==3&&(t?XO(this,t):this.j.length==0||P1(this.i)||XO(this))};function XO(t,e){var n;e?n=e.m:n=t.W++;let r=di(t.I);Fe(r,"SID",t.K),Fe(r,"RID",n),Fe(r,"AID",t.V),gd(t,r),t.o&&t.s&&F0(r,t.o,t.s),n=new dd(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=z1(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),k0(t.i,n),p0(n,r,e)}function gd(t,e){t.na&&I0(t.na,function(n,r){Fe(e,r,n)}),t.h&&S1({},function(n,r){Fe(e,r,n)})}function z1(t,e,n){n=Math.min(t.j.length,n);var r=t.h?$t(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let c=i[l].g,u=i[l].map;if(c-=s,0>c)s=Math.max(0,i[l].g-100),a=!1;else try{dK(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function G1(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;td||h1(),nd||(td(),nd=!0),A0.add(e,t),t.A=0}}function V0(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=cd($t(t.Ma,t),Q1(t,t.A)),t.A++,!0)}P.Ma=function(){if(this.u=null,W1(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=cd($t(this.jb,this),t)}};P.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,tn(10),fm(this),W1(this))};function j0(t){t.B!=null&&(X.clearTimeout(t.B),t.B=null)}function W1(t){t.g=new dd(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=di(t.wa);Fe(e,"RID","rpc"),Fe(e,"SID",t.K),Fe(e,"AID",t.V),Fe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Fe(e,"TO",t.qa),Fe(e,"TYPE","xmlhttp"),gd(t,e),t.o&&t.s&&F0(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=um(di(e)),n.u=null,n.S=!0,C1(n,t)}P.ib=function(){this.v!=null&&(this.v=null,fm(this),V0(this),tn(19))};function Yg(t){t.v!=null&&(X.clearTimeout(t.v),t.v=null)}function K1(t,e){var n=null;if(t.g==e){Yg(t),j0(t),t.g=null;var r=2}else if(m0(t.i,e))n=e.F,O1(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=om(),Ot(r,new _1(r,n)),pm(t)}else G1(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&_K(t,e)||r==2&&V0(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:co(t,5);break;case 4:co(t,10);break;case 3:co(t,6);break;default:co(t,2)}}}function Q1(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function co(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=$t(t.pb,t);n||(n=new uo("//www.google.com/images/cleardot.gif"),X.location&&X.location.protocol=="http"||Kg(n,"https"),um(n)),hK(n.toString(),r)}else tn(2);t.H=0,t.h&&t.h.za(e),Y1(t),H1(t)}P.pb=function(t){t?(this.l.info("Successfully pinged google.com"),tn(2)):(this.l.info("Failed to ping google.com"),tn(1))};function Y1(t){if(t.H=0,t.ma=[],t.h){let e=F1(t.i);(e.length!=0||t.j.length!=0)&&($O(t.ma,e),$O(t.ma,t.j),t.i.i.length=0,w0(t.j),t.j.length=0),t.h.ya()}}function X1(t,e,n){var r=n instanceof uo?di(n):new uo(n);if(r.g!="")e&&(r.g=e+"."+r.g),Qg(r,r.m);else{var i=X.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new uo(null);r&&Kg(s,r),e&&(s.g=e),i&&Qg(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Fe(r,n,e),Fe(r,"VER",t.ra),gd(t,r),r}function Z1(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new We(new fd({ob:n})):new We(t.va),e.Oa(t.J),e}P.isActive=function(){return!!this.h&&this.h.isActive(this)};function J1(){}P=J1.prototype;P.Ba=function(){};P.Aa=function(){};P.za=function(){};P.ya=function(){};P.isActive=function(){return!0};P.Va=function(){};function Xg(){if(ll&&!(10<=Number(O6)))throw Error("Environmental error: no available transport.")}Xg.prototype.g=function(t,e){return new En(t,e)};function En(t,e){Ct.call(this),this.g=new q1(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Ju(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ju(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ul(this)}Dt(En,Ct);En.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;tn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=X1(t,null,t.Y),pm(t)};En.prototype.close=function(){L0(this.g)};En.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=S0(t),t=n);e.j.push(new aK(e.fb++,t)),e.H==3&&pm(e)};En.prototype.N=function(){this.g.h=null,delete this.j,L0(this.g),delete this.g,En.$.N.call(this)};function eF(t){N0.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Dt(eF,N0);function tF(){P0.call(this),this.status=1}Dt(tF,P0);function ul(t){this.g=t}Dt(ul,J1);ul.prototype.Ba=function(){Ot(this.g,"a")};ul.prototype.Aa=function(t){Ot(this.g,new eF(t))};ul.prototype.za=function(t){Ot(this.g,new tF)};ul.prototype.ya=function(){Ot(this.g,"b")};function vK(){this.blockSize=-1}function tr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Dt(tr,vK);tr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function n0(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}tr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)n0(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){n0(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){n0(this,r),i=0;break}}this.h=i,this.i+=e};tr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function De(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var wK={};function U0(t){return-128<=t&&128>t?N6(t,function(e){return new De([e|0],0>e?-1:0)}):new De([t|0],0>t?-1:0)}function Pr(t){if(isNaN(t)||!isFinite(t))return al;if(0>t)return kt(Pr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=y0;return new De(e,0)}function nF(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return kt(nF(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Pr(Math.pow(e,8)),r=al,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Pr(Math.pow(e,s)),r=r.R(s).add(Pr(o))):(r=r.R(n),r=r.add(Pr(o)))}return r}var y0=4294967296,al=U0(0),_0=U0(1),ZO=U0(16777216);P=De.prototype;P.ea=function(){if(On(this))return-kt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:y0+r)*e,e*=y0}return t};P.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(ui(this))return"0";if(On(this))return"-"+kt(this).toString(t);for(var e=Pr(Math.pow(t,6)),n=this,r="";;){var i=Jg(n,e).g;n=Zg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,ui(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};P.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function ui(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function On(t){return t.h==-1}P.X=function(t){return t=Zg(this,t),On(t)?-1:ui(t)?0:1};function kt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new De(n,~t.h).add(_0)}P.abs=function(){return On(this)?kt(this):this};P.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new De(n,n[n.length-1]&-2147483648?-1:0)};function Zg(t,e){return t.add(kt(e))}P.R=function(t){if(ui(this)||ui(t))return al;if(On(this))return On(t)?kt(this).R(kt(t)):kt(kt(this).R(t));if(On(t))return kt(this.R(kt(t)));if(0>this.X(ZO)&&0>t.X(ZO))return Pr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,Wg(n,2*r+2*i),n[2*r+2*i+1]+=s*l,Wg(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Wg(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Wg(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new De(n,0)};function Wg(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Qu(t,e){this.g=t,this.h=e}function Jg(t,e){if(ui(e))throw Error("division by zero");if(ui(t))return new Qu(al,al);if(On(t))return e=Jg(kt(t),e),new Qu(kt(e.g),kt(e.h));if(On(e))return e=Jg(t,kt(e)),new Qu(kt(e.g),e.h);if(30<t.g.length){if(On(t)||On(e))throw Error("slowDivide_ only works with positive integers.");for(var n=_0,r=e;0>=r.X(t);)n=JO(n),r=JO(r);var i=sl(n,1),s=sl(r,1);for(r=sl(r,2),n=sl(n,2);!ui(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=sl(r,1),n=sl(n,1)}return e=Zg(t,i.R(e)),new Qu(i,e)}for(i=al;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Pr(n),o=s.R(e);On(o)||0<o.X(t);)n-=r,s=Pr(n),o=s.R(e);ui(s)&&(s=_0),i=i.add(s),t=Zg(t,o)}return new Qu(i,t)}P.gb=function(t){return Jg(this,t).h};P.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new De(n,this.h&t.h)};P.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new De(n,this.h|t.h)};P.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new De(n,this.h^t.h)};function JO(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new De(n,t.h)}function sl(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new De(i,t.h)}Xg.prototype.createWebChannel=Xg.prototype.g;En.prototype.send=En.prototype.u;En.prototype.open=En.prototype.m;En.prototype.close=En.prototype.close;am.NO_ERROR=0;am.TIMEOUT=8;am.HTTP_ERROR=6;v1.COMPLETE="complete";w1.EventType=ud;ud.OPEN="a";ud.CLOSE="b";ud.ERROR="c";ud.MESSAGE="d";Ct.prototype.listen=Ct.prototype.O;We.prototype.listenOnce=We.prototype.P;We.prototype.getLastError=We.prototype.Sa;We.prototype.getLastErrorCode=We.prototype.Ia;We.prototype.getStatus=We.prototype.da;We.prototype.getResponseJson=We.prototype.Wa;We.prototype.getResponseText=We.prototype.ja;We.prototype.send=We.prototype.ha;We.prototype.setWithCredentials=We.prototype.Oa;tr.prototype.digest=tr.prototype.l;tr.prototype.reset=tr.prototype.reset;tr.prototype.update=tr.prototype.j;De.prototype.add=De.prototype.add;De.prototype.multiply=De.prototype.R;De.prototype.modulo=De.prototype.gb;De.prototype.compare=De.prototype.X;De.prototype.toNumber=De.prototype.ea;De.prototype.toString=De.prototype.toString;De.prototype.getBits=De.prototype.D;De.fromNumber=Pr;De.fromString=nF;var rF=nr.createWebChannelTransport=function(){return new Xg},iF=nr.getStatEventTarget=function(){return om()},gm=nr.ErrorCode=am,sF=nr.EventType=v1,oF=nr.Event=ho,B0=nr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},iae=nr.FetchXmlHttpFactory=fd,md=nr.WebChannel=w1,aF=nr.XhrIo=We,lF=nr.Md5=tr,fo=nr.Integer=De;var cF="@firebase/firestore";var dt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};dt.UNAUTHENTICATED=new dt(null),dt.GOOGLE_CREDENTIALS=new dt("google-credentials-uid"),dt.FIRST_PARTY=new dt("first-party-uid"),dt.MOCK_USER=new dt("mock-user");var Bl="10.9.0";var fs=new Ii("@firebase/firestore");function gl(){return fs.logLevel}function cL(t){fs.setLogLevel(t)}function D(t,...e){if(fs.logLevel<=Tn.DEBUG){let n=e.map(HT);fs.debug(`Firestore (${Bl}): ${t}`,...n)}}function tt(t,...e){if(fs.logLevel<=Tn.ERROR){let n=e.map(HT);fs.error(`Firestore (${Bl}): ${t}`,...n)}}function Ln(t,...e){if(fs.logLevel<=Tn.WARN){let n=e.map(HT);fs.warn(`Firestore (${Bl}): ${t}`,...n)}}function HT(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function O(t="Unexpected state"){let e=`FIRESTORE (${Bl}) INTERNAL ASSERTION FAILED: `+t;throw tt(e),new Error(e)}function U(t,e){t||O()}function uL(t,e){t||O()}function N(t,e){return t}var v={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=class extends fh{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ht=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var bm=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},G0=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(dt.UNAUTHENTICATED))}shutdown(){}},W0=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},K0=class{constructor(e){this.t=e,this.currentUser=dt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve(),s=new ht;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ht,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>_(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},a=l=>{D("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(D("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ht)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(D("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(U(typeof r.accessToken=="string"),new bm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return U(e===null||typeof e=="string"),new dt(e)}},Q0=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=dt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Y0=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Q0(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(dt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},X0=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Z0=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&D("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,D("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{D("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):D("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(U(typeof n.token=="string"),this.R=n.token,new X0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function EK(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Sm=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=EK(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function ee(t,e){return t<e?-1:t>e?1:0}function Dl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function dL(t){return t+"\0"}var ze=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new ze(0,0))}static max(){return new t(new ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Am=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&O(),r===void 0?r=e.length-n:r>e.length-n&&O(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ge=class t extends Am{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new I(v.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},IK=/^[_a-zA-Z][_a-zA-Z0-9]*$/,nt=class t extends Am{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return IK.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new I(v.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new I(v.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new I(v.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new I(v.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var R=class t{constructor(e){this.path=e}static fromPath(e){return new t(ge.fromString(e))}static fromName(e){return new t(ge.fromString(e).popFirst(5))}static empty(){return new t(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ge(e.slice()))}};var Tl=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function J0(t){return t.fields.find(e=>e.kind===2)}function go(t){return t.fields.filter(e=>e.kind!==2)}Tl.UNKNOWN_ID=-1;var El=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Ad=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Vn.min())}};function hL(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new ze(n+1,0):new ze(n,r));return new Vn(i,R.empty(),e)}function fL(t){return new Vn(t.readTime,t.key,-1)}var Vn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(q.min(),R.empty(),-1)}static max(){return new t(q.max(),R.empty(),-1)}};function zT(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=R.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}var pL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",xm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Cs(t){return _(this,null,function*(){if(t.code!==v.FAILED_PRECONDITION||t.message!==pL)throw t;D("LocalStore","Unexpectedly lost primary lease")})}var y=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&O(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let l=0;l<s;l++){let c=l;n(e[c]).next(u=>{o[c]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Rm=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ht,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Eo(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=GT(r.target.error);this.V.reject(new Eo(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Eo(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(D("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new tD(n)}},pi=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Jl())===12.2&&tt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return D("SimpleDb","Removing database:",e),mo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!hh())return!1;if(t.C())return!0;let e=Jl(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return _(this,null,function*(){return this.db||(D("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Eo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new I(v.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new I(v.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Eo(e,o))},i.onupgradeneeded=s=>{D("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{D("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db})}B(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return _(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Rm.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),y.reject(c))).toPromise();return l.catch(()=>{}),yield a.m,l}catch(a){let l=a,c=l.name!=="FirebaseError"&&o<3;if(D("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}},eD=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return mo(this.k.delete())}},Eo=class extends I{constructor(e,n){super(v.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Ds(t){return t.name==="IndexedDbTransactionError"}var tD=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(D("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(D("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),mo(r)}add(e){return D("SimpleDb","ADD",this.store.name,e,e),mo(this.store.add(e))}get(e){return mo(this.store.get(e)).next(n=>(n===void 0&&(n=null),D("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return D("SimpleDb","DELETE",this.store.name,e),mo(this.store.delete(e))}count(){return D("SimpleDb","COUNT",this.store.name),mo(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new y((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,l)=>{o.push(l)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new y((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){D("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new y((r,i)=>{n.onerror=s=>{let o=GT(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new y((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let l=new eD(a),c=n(a.primaryKey,a.value,l);if(c instanceof y){let u=c.catch(d=>(l.done(),y.reject(d)));r.push(u)}l.isDone?i():l.$===null?a.continue():a.continue(l.$)}}).next(()=>y.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function mo(t){return new y((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=GT(r.target.error);n(i)}})}var uF=!1;function GT(t){let e=pi.S(Jl());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new I("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return uF||(uF=!0,setTimeout(()=>{throw r},0)),r}}return t}var nD=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){D("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>_(this,null,function*(){this.task=null;try{D("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Ds(n)?D("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Cs(n)}yield this.ee(6e4)}))}},rD=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return _(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return y.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return D("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(D("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=fL(s);zT(o,r)>0&&(r=o)}),new Vn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var In=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Yd(t){return t==null}function xd(t){return t===0&&1/t==-1/0}function gL(t){return typeof t=="number"&&Number.isInteger(t)&&!xd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function nn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=dF(e)),e=CK(t.get(n),e);return dF(e)}function CK(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function dF(t){return t+""}function kr(t){let e=t.length;if(U(e>=2),e===2)return U(t.charAt(0)===""&&t.charAt(1)===""),ge.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&O(),t.charAt(o+1)){case"":let a=t.substring(s,o),l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:O()}s=o+2}return new ge(r)}var hF=["userId","batchId"];function wm(t,e){return[t,nn(e)]}function mL(t,e,n){return[t,nn(e),n]}var DK={},TK=["prefixPath","collectionGroup","readTime","documentId"],bK=["prefixPath","collectionGroup","documentId"],SK=["collectionGroup","readTime","prefixPath","documentId"],AK=["canonicalId","targetId"],xK=["targetId","path"],RK=["path","targetId"],MK=["collectionId","parent"],NK=["indexId","uid"],PK=["uid","sequenceNumber"],kK=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],OK=["indexId","uid","orderedDocumentKey"],FK=["userId","collectionPath","documentId"],LK=["userId","collectionPath","largestBatchId"],VK=["userId","collectionGroup","largestBatchId"],yL=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],jK=[...yL,"documentOverlays"],_L=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],vL=_L,UK=[...vL,"indexConfiguration","indexState","indexEntries"];var Rd=class extends xm{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function bt(t,e){let n=N(t);return pi.M(n.ae,e)}function fF(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Po(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function wL(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Le=class t{constructor(e,n){this.comparator=e,this.root=n||Fr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wl(this.root,e,this.comparator,!1)}getReverseIterator(){return new wl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wl(this.root,e,this.comparator,!0)}},wl=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Fr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw O();let e=this.left.check();if(e!==this.right.check())throw O();return e+(this.isRed()?0:1)}};Fr.EMPTY=null,Fr.RED=!0,Fr.BLACK=!1;Fr.EMPTY=new class{constructor(){this.size=0}get key(){throw O()}get value(){throw O()}get color(){throw O()}get left(){throw O()}get right(){throw O()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Fr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Re=class t{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Mm(this.data.getIterator())}getIteratorFrom(e){return new Mm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Mm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function dl(t){return t.hasNext()?t.getNext():void 0}var Cn=class t{constructor(e){this.fields=e,e.sort(nt.comparator)}static empty(){return new t([])}unionWith(e){let n=new Re(nt.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Dl(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Nm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function EL(){return typeof atob<"u"}var Tt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Nm("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Tt.EMPTY_BYTE_STRING=new Tt("");var BK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ps(t){if(U(!!t),typeof t=="string"){let e=0,n=BK.exec(t);if(U(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(t.seconds),nanos:Ke(t.nanos)}}function Ke(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function gs(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}function Iy(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function WT(t){let e=t.mapValue.fields.__previous_value__;return Iy(e)?WT(e):e}function Md(t){let e=ps(t.mapValue.fields.__local_write_time__.timestampValue);return new ze(e.seconds,e.nanos)}var iD=class{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}},ms=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var ds={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Em={nullValue:"NULL_VALUE"};function Io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Iy(t)?4:IL(t)?9007199254740991:10:O()}function jr(t,e){if(t===e)return!0;let n=Io(t);if(n!==Io(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Md(t).isEqual(Md(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=ps(i.timestampValue),a=ps(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return gs(i.bytesValue).isEqual(gs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ke(i.geoPointValue.latitude)===Ke(s.geoPointValue.latitude)&&Ke(i.geoPointValue.longitude)===Ke(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ke(i.integerValue)===Ke(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ke(i.doubleValue),a=Ke(s.doubleValue);return o===a?xd(o)===xd(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Dl(t.arrayValue.values||[],e.arrayValue.values||[],jr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(fF(o)!==fF(a))return!1;for(let l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!jr(o[l],a[l])))return!1;return!0}(t,e);default:return O()}}function Nd(t,e){return(t.values||[]).find(n=>jr(n,e))!==void 0}function ys(t,e){if(t===e)return 0;let n=Io(t),r=Io(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ke(s.integerValue||s.doubleValue),l=Ke(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return pF(t.timestampValue,e.timestampValue);case 4:return pF(Md(t),Md(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(s,o){let a=gs(s),l=gs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){let u=ee(a[c],l[c]);if(u!==0)return u}return ee(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ee(Ke(s.latitude),Ke(o.latitude));return a!==0?a:ee(Ke(s.longitude),Ke(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){let u=ys(a[c],l[c]);if(u)return u}return ee(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===ds.mapValue&&o===ds.mapValue)return 0;if(s===ds.mapValue)return 1;if(o===ds.mapValue)return-1;let a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){let h=ee(l[d],u[d]);if(h!==0)return h;let f=ys(a[l[d]],c[u[d]]);if(f!==0)return f}return ee(l.length,u.length)}(t.mapValue,e.mapValue);default:throw O()}}function pF(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);let n=ps(t),r=ps(e),i=ee(n.seconds,r.seconds);return i!==0?i:ee(n.nanos,r.nanos)}function bl(t){return sD(t)}function sD(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=ps(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return gs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return R.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=sD(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${sD(n.fields[o])}`;return i+"}"}(t.mapValue):O()}function Co(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function oD(t){return!!t&&"integerValue"in t}function Pd(t){return!!t&&"arrayValue"in t}function gF(t){return!!t&&"nullValue"in t}function mF(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Im(t){return!!t&&"mapValue"in t}function Cd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Po(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Cd(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cd(t.arrayValue.values[n]);return e}return Object.assign({},t)}function IL(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function $K(t){return"nullValue"in t?Em:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Co(ms.empty(),R.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:O()}function qK(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Co(ms.empty(),R.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?ds:O()}function yF(t,e){let n=ys(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function _F(t,e){let n=ys(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var zt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Im(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cd(n)}setAll(e){let n=nt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Cd(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Im(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return jr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Im(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Po(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Cd(this.value))}};function CL(t){let e=[];return Po(t.fields,(n,r)=>{let i=new nt([n]);if(Im(r)){let s=CL(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Cn(e)}var ft=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,q.min(),q.min(),q.min(),zt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,q.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,q.min(),q.min(),zt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,q.min(),q.min(),zt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ur=class{constructor(e,n){this.position=e,this.inclusive=n}};function vF(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=R.comparator(R.fromName(o.referenceValue),n.key):r=ys(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function wF(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!jr(t.position[n],e.position[n]))return!1;return!0}var Do=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function HK(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Pm=class{},de=class t extends Pm{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new cD(e,n,r):n==="array-contains"?new hD(e,r):n==="in"?new km(e,r):n==="not-in"?new fD(e,r):n==="array-contains-any"?new pD(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new uD(e,r):new dD(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ys(n,this.value)):n!==null&&Io(this.value)===Io(n)&&this.matchesComparison(ys(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return O()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Te=class t extends Pm{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Sl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Sl(t){return t.op==="and"}function aD(t){return t.op==="or"}function KT(t){return DL(t)&&Sl(t)}function DL(t){for(let e of t.filters)if(e instanceof Te)return!1;return!0}function lD(t){if(t instanceof de)return t.field.canonicalString()+t.op.toString()+bl(t.value);if(KT(t))return t.filters.map(e=>lD(e)).join(",");{let e=t.filters.map(n=>lD(n)).join(",");return`${t.op}(${e})`}}function TL(t,e){return t instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&jr(r.value,i.value)}(t,e):t instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&TL(o,i.filters[a]),!0):!1}(t,e):void O()}function bL(t,e){let n=t.filters.concat(e);return Te.create(n,t.op)}function SL(t){return t instanceof de?function(n){return`${n.field.canonicalString()} ${n.op} ${bl(n.value)}`}(t):t instanceof Te?function(n){return n.op.toString()+" {"+n.getFilters().map(SL).join(" ,")+"}"}(t):"Filter"}var cD=class extends de{constructor(e,n,r){super(e,n,r),this.key=R.fromName(r.referenceValue)}matches(e){let n=R.comparator(e.key,this.key);return this.matchesComparison(n)}},uD=class extends de{constructor(e,n){super(e,"in",n),this.keys=AL("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},dD=class extends de{constructor(e,n){super(e,"not-in",n),this.keys=AL("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function AL(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>R.fromName(r.referenceValue))}var hD=class extends de{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Pd(n)&&Nd(n.arrayValue,this.value)}},km=class extends de{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Nd(this.value.arrayValue,n)}},fD=class extends de{constructor(e,n){super(e,"not-in",n)}matches(e){if(Nd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Nd(this.value.arrayValue,n)}},pD=class extends de{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Pd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Nd(this.value.arrayValue,r))}};var gD=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function mD(t,e=null,n=[],r=[],i=null,s=null,o=null){return new gD(t,e,n,r,i,s,o)}function To(t){let e=N(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>lD(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Yd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>bl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>bl(r)).join(",")),e.ce=n}return e.ce}function Xd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!HK(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TL(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wF(t.startAt,e.startAt)&&wF(t.endAt,e.endAt)}function Om(t){return R.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Fm(t,e){return t.filters.filter(n=>n instanceof de&&n.field.isEqual(e))}function EF(t,e,n){let r=Em,i=!0;for(let s of Fm(t,e)){let o=Em,a=!0;switch(s.op){case"<":case"<=":o=$K(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Em}yF({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];yF({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function IF(t,e,n){let r=ds,i=!0;for(let s of Fm(t,e)){let o=ds,a=!0;switch(s.op){case">=":case">":o=qK(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ds}_F({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];_F({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var rr=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function xL(t,e,n,r,i,s,o,a){return new rr(t,e,n,r,i,s,o,a)}function $l(t){return new rr(t)}function CF(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function QT(t){return t.collectionGroup!==null}function Il(t){let e=N(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Re(nt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new Do(s,r))}),n.has(nt.keyField().canonicalString())||e.le.push(new Do(nt.keyField(),r))}return e.le}function rn(t){let e=N(t);return e.he||(e.he=zK(e,Il(t))),e.he}function zK(t,e){if(t.limitType==="F")return mD(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Do(i.field,s)});let n=t.endAt?new Ur(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ur(t.startAt.position,t.startAt.inclusive):null;return mD(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function yD(t,e){let n=t.filters.concat([e]);return new rr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Lm(t,e,n){return new rr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zd(t,e){return Xd(rn(t),rn(e))&&t.limitType===e.limitType}function RL(t){return`${To(rn(t))}|lt:${t.limitType}`}function ml(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>SL(i)).join(", ")}]`),Yd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>bl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>bl(i)).join(",")),`Target(${r})`}(rn(t))}; limitType=${t.limitType})`}function Jd(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):R.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Il(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){let c=vF(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Il(r),i)||r.endAt&&!function(o,a,l){let c=vF(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Il(r),i))}(t,e)}function ML(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function NL(t){return(e,n)=>{let r=!1;for(let i of Il(t)){let s=GK(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function GK(t,e,n){let r=t.field.isKeyField()?R.comparator(e.key,n.key):function(s,o,a){let l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ys(l,c):O()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return O()}}var Br=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Po(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return wL(this.inner)}size(){return this.innerSize}};var WK=new Le(R.comparator);function hn(){return WK}var PL=new Le(R.comparator);function Ed(...t){let e=PL;for(let n of t)e=e.insert(n.key,n);return e}function kL(t){let e=PL;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Or(){return Dd()}function OL(){return Dd()}function Dd(){return new Br(t=>t.toString(),(t,e)=>t.isEqual(e))}var KK=new Le(R.comparator),QK=new Re(R.comparator);function te(...t){let e=QK;for(let n of t)e=e.add(n);return e}var YK=new Re(ee);function YT(){return YK}function FL(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xd(e)?"-0":e}}function LL(t){return{integerValue:""+t}}function VL(t,e){return gL(e)?LL(e):FL(t,e)}var Al=class{constructor(){this._=void 0}};function XK(t,e,n){return t instanceof _s?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Iy(s)&&(s=WT(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof gi?UL(t,e):t instanceof mi?BL(t,e):function(i,s){let o=jL(i,s),a=DF(o)+DF(i.Ie);return oD(o)&&oD(i.Ie)?LL(a):FL(i.serializer,a)}(t,e)}function ZK(t,e,n){return t instanceof gi?UL(t,e):t instanceof mi?BL(t,e):n}function jL(t,e){return t instanceof vs?function(r){return oD(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var _s=class extends Al{},gi=class extends Al{constructor(e){super(),this.elements=e}};function UL(t,e){let n=$L(e);for(let r of t.elements)n.some(i=>jr(i,r))||n.push(r);return{arrayValue:{values:n}}}var mi=class extends Al{constructor(e){super(),this.elements=e}};function BL(t,e){let n=$L(e);for(let r of t.elements)n=n.filter(i=>!jr(i,r));return{arrayValue:{values:n}}}var vs=class extends Al{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function DF(t){return Ke(t.integerValue||t.doubleValue)}function $L(t){return Pd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var bo=class{constructor(e,n){this.field=e,this.transform=n}};function JK(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof gi&&i instanceof gi||r instanceof mi&&i instanceof mi?Dl(r.elements,i.elements,jr):r instanceof vs&&i instanceof vs?jr(r.Ie,i.Ie):r instanceof _s&&i instanceof _s}(t.transform,e.transform)}var _D=class{constructor(e,n){this.version=e,this.transformResults=n}},Qe=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Cm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var xl=class{};function qL(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Es(t.key,Qe.none()):new ws(t.key,t.data,Qe.none());{let n=t.data,r=zt.empty(),i=new Re(nt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ir(t.key,r,new Cn(i.toArray()),Qe.none())}}function eQ(t,e,n){t instanceof ws?function(i,s,o){let a=i.value.clone(),l=bF(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ir?function(i,s,o){if(!Cm(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=bF(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(HL(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Td(t,e,n,r){return t instanceof ws?function(s,o,a,l){if(!Cm(s.precondition,o))return a;let c=s.value.clone(),u=SF(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ir?function(s,o,a,l){if(!Cm(s.precondition,o))return a;let c=SF(s.fieldTransforms,l,o),u=o.data;return u.setAll(HL(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Cm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function tQ(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=jL(r.transform,i||null);s!=null&&(n===null&&(n=zt.empty()),n.set(r.field,s))}return n||null}function TF(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Dl(r,i,(s,o)=>JK(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var ws=class extends xl{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ir=class extends xl{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function HL(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function bF(t,e,n){let r=new Map;U(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,ZK(o,a,n[i]))}return r}function SF(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,XK(s,o,e))}return r}var Es=class extends xl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},kd=class extends xl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Od=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&eQ(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Td(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Td(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=OL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let l=qL(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),te())}isEqual(e){return this.batchId===e.batchId&&Dl(this.mutations,e.mutations,(n,r)=>TF(n,r))&&Dl(this.baseMutations,e.baseMutations,(n,r)=>TF(n,r))}},vD=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){U(e.mutations.length===r.length);let i=function(){return KK}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Fd=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var wD=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var ct,pe;function zL(t){switch(t){default:return O();case v.CANCELLED:case v.UNKNOWN:case v.DEADLINE_EXCEEDED:case v.RESOURCE_EXHAUSTED:case v.INTERNAL:case v.UNAVAILABLE:case v.UNAUTHENTICATED:return!1;case v.INVALID_ARGUMENT:case v.NOT_FOUND:case v.ALREADY_EXISTS:case v.PERMISSION_DENIED:case v.FAILED_PRECONDITION:case v.ABORTED:case v.OUT_OF_RANGE:case v.UNIMPLEMENTED:case v.DATA_LOSS:return!0}}function GL(t){if(t===void 0)return tt("GRPC error has no .code"),v.UNKNOWN;switch(t){case ct.OK:return v.OK;case ct.CANCELLED:return v.CANCELLED;case ct.UNKNOWN:return v.UNKNOWN;case ct.DEADLINE_EXCEEDED:return v.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return v.RESOURCE_EXHAUSTED;case ct.INTERNAL:return v.INTERNAL;case ct.UNAVAILABLE:return v.UNAVAILABLE;case ct.UNAUTHENTICATED:return v.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return v.INVALID_ARGUMENT;case ct.NOT_FOUND:return v.NOT_FOUND;case ct.ALREADY_EXISTS:return v.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return v.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return v.FAILED_PRECONDITION;case ct.ABORTED:return v.ABORTED;case ct.OUT_OF_RANGE:return v.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return v.UNIMPLEMENTED;case ct.DATA_LOSS:return v.DATA_LOSS;default:return O()}}(pe=ct||(ct={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";var AF=null;function WL(){return new TextEncoder}var nQ=new fo([4294967295,4294967295],0);function xF(t){let e=WL().encode(t),n=new lF;return n.update(e),new Uint8Array(n.digest())}function RF(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new fo([n,r],0),new fo([i,s],0)]}var ED=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new wo(`Invalid padding: ${n}`);if(r<0)throw new wo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new wo(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=fo.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(fo.fromNumber(r)));return i.compare(nQ)===1&&(i=new fo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=xF(e),[r,i]=RF(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=xF(e),[r,i]=RF(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},wo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ld=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Vd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(q.min(),i,new Le(ee),hn(),te())}},Vd=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,te(),te(),te())}};var Cl=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Vm=class{constructor(e,n){this.targetId=e,this.fe=n}},jm=class{constructor(e,n,r=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Um=class{constructor(){this.ge=0,this.pe=NF(),this.ye=Tt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=te(),n=te(),r=te();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:O()}}),new Vd(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=NF()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,U(this.ge>=0)}Le(){this.Se=!0,this.we=!0}},ID=class{constructor(e){this.Be=e,this.ke=new Map,this.qe=hn(),this.Qe=MF(),this.Ke=new Le(ee)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:O()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Om(s))if(r===0){let o=new R(s.path);this.We(n,o,ft.newNoDocument(o,q.min()))}else U(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(n);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}AF?.tt(function(u,d,h,f,p){var g,m,w,S,C,b;let B={localCacheCount:u,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},H=d.unchangedNames;return H&&(B.bloomFilter={applied:p===0,hashCount:(g=H?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(S=(w=(m=H?.bits)===null||m===void 0?void 0:m.bitmap)===null||w===void 0?void 0:w.length)!==null&&S!==void 0?S:0,padding:(b=(C=H?.bits)===null||C===void 0?void 0:C.padding)!==null&&b!==void 0?b:0,mightContain:ye=>{var it;return(it=f?.mightContain(ye))!==null&&it!==void 0&&it}}),B}(o,e.fe,this.Be.nt(),a,l))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=gs(r).toUint8Array()}catch(l){if(l instanceof Nm)return Ln("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new ED(o,i,s)}catch(l){return Ln(l instanceof wo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Be.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Be.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Om(a.target)){let l=new R(a.target.path);this.qe.get(l)!==null||this.st(o,l)||this.We(o,l,ft.newNoDocument(l,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=te();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{let c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Ld(e,n,this.Ke,this.qe,r);return this.qe=hn(),this.Qe=MF(),this.Ke=new Le(ee),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Um,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Re(ee),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||D("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Be._t(e)}He(e){this.ke.set(e,new Um),this.Be.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Be.getRemoteKeysForTarget(e).has(n)}};function MF(){return new Le(R.comparator)}function NF(){return new Le(R.comparator)}var rQ={asc:"ASCENDING",desc:"DESCENDING"},iQ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sQ={and:"AND",or:"OR"},CD=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function DD(t,e){return t.useProto3Json||Yd(e)?e:{value:e}}function Rl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function KL(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function oQ(t,e){return Rl(t,e.toTimestamp())}function rt(t){return U(!!t),q.fromTimestamp(function(n){let r=ps(n);return new ze(r.seconds,r.nanos)}(t))}function XT(t,e){return TD(t,e).canonicalString()}function TD(t,e){let n=function(i){return new ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function QL(t){let e=ge.fromString(t);return U(sV(e)),e}function jd(t,e){return XT(t.databaseId,e.path)}function Lr(t,e){let n=QL(e);if(n.get(1)!==t.databaseId.projectId)throw new I(v.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new I(v.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new R(ZL(n))}function YL(t,e){return XT(t.databaseId,e)}function XL(t){let e=QL(t);return e.length===4?ge.emptyPath():ZL(e)}function bD(t){return new ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ZL(t){return U(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function PF(t,e,n){return{name:jd(t,e),fields:n.value.mapValue.fields}}function JL(t,e,n){let r=Lr(t,e.name),i=rt(e.updateTime),s=e.createTime?rt(e.createTime):q.min(),o=new zt({mapValue:{fields:e.fields}}),a=ft.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function aQ(t,e){return"found"in e?function(r,i){U(!!i.found),i.found.name,i.found.updateTime;let s=Lr(r,i.found.name),o=rt(i.found.updateTime),a=i.found.createTime?rt(i.found.createTime):q.min(),l=new zt({mapValue:{fields:i.found.fields}});return ft.newFoundDocument(s,o,a,l)}(t,e):"missing"in e?function(r,i){U(!!i.missing),U(!!i.readTime);let s=Lr(r,i.missing),o=rt(i.readTime);return ft.newNoDocument(s,o)}(t,e):O()}function lQ(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:O()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(U(u===void 0||typeof u=="string"),Tt.fromBase64String(u||"")):(U(u===void 0||u instanceof Uint8Array),Tt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let u=c.code===void 0?v.UNKNOWN:GL(c.code);return new I(u,c.message||"")}(o);n=new jm(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Lr(t,r.document.name),s=rt(r.document.updateTime),o=r.document.createTime?rt(r.document.createTime):q.min(),a=new zt({mapValue:{fields:r.document.fields}}),l=ft.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Cl(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Lr(t,r.document),s=r.readTime?rt(r.readTime):q.min(),o=ft.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Cl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Lr(t,r.document),s=r.removedTargetIds||[];n=new Cl([],s,i,null)}else{if(!("filter"in e))return O();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new wD(i,s),a=r.targetId;n=new Vm(a,o)}}return n}function Ud(t,e){let n;if(e instanceof ws)n={update:PF(t,e.key,e.value)};else if(e instanceof Es)n={delete:jd(t,e.key)};else if(e instanceof ir)n={update:PF(t,e.key,e.data),updateMask:pQ(e.fieldMask)};else{if(!(e instanceof kd))return O();n={verify:jd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof _s)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof gi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof mi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof vs)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw O()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:oQ(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:O()}(t,e.precondition)),n}function SD(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?Qe.updateTime(rt(s.updateTime)):s.exists!==void 0?Qe.exists(s.exists):Qe.none()}(e.currentDocument):Qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)U(a.setToServerValue==="REQUEST_TIME"),l=new _s;else if("appendMissingElements"in a){let u=a.appendMissingElements.values||[];l=new gi(u)}else if("removeAllFromArray"in a){let u=a.removeAllFromArray.values||[];l=new mi(u)}else"increment"in a?l=new vs(o,a.increment):O();let c=nt.fromServerFormat(a.fieldPath);return new bo(c,l)}(t,i)):[];if(e.update){e.update.name;let i=Lr(t,e.update.name),s=new zt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(l){let c=l.fieldPaths||[];return new Cn(c.map(u=>nt.fromServerFormat(u)))}(e.updateMask);return new ir(i,s,o,n,r)}return new ws(i,s,n,r)}if(e.delete){let i=Lr(t,e.delete);return new Es(i,n)}if(e.verify){let i=Lr(t,e.verify);return new kd(i,n)}return O()}function cQ(t,e){return t&&t.length>0?(U(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?rt(i.updateTime):rt(s);return o.isEqual(q.min())&&(o=rt(s)),new _D(o,i.transformResults||[])}(n,e))):[]}function eV(t,e){return{documents:[YL(t,e.path)]}}function tV(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=YL(t,i);let s=function(c){if(c.length!==0)return iV(Te.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:yl(h.field),direction:dQ(h.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=DD(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ut:n,parent:i}}function nV(t){let e=XL(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){U(r===1);let u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(d){let h=rV(d);return h instanceof Te&&KT(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new Do(_l(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Yd(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(d){let h=!!d.before,f=d.values||[];return new Ur(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new Ur(f,h)}(n.endAt)),xL(e,i,o,s,a,"F",l,c)}function uQ(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function rV(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=_l(n.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=_l(n.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=_l(n.unaryFilter.field);return de.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=_l(n.unaryFilter.field);return de.create(o,"!=",{nullValue:"NULL_VALUE"});default:return O()}}(t):t.fieldFilter!==void 0?function(n){return de.create(_l(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return O()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Te.create(n.compositeFilter.filters.map(r=>rV(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return O()}}(n.compositeFilter.op))}(t):O()}function dQ(t){return rQ[t]}function hQ(t){return iQ[t]}function fQ(t){return sQ[t]}function yl(t){return{fieldPath:t.canonicalString()}}function _l(t){return nt.fromServerFormat(t.fieldPath)}function iV(t){return t instanceof de?function(n){if(n.op==="=="){if(mF(n.value))return{unaryFilter:{field:yl(n.field),op:"IS_NAN"}};if(gF(n.value))return{unaryFilter:{field:yl(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(mF(n.value))return{unaryFilter:{field:yl(n.field),op:"IS_NOT_NAN"}};if(gF(n.value))return{unaryFilter:{field:yl(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yl(n.field),op:hQ(n.op),value:n.value}}}(t):t instanceof Te?function(n){let r=n.getFilters().map(i=>iV(i));return r.length===1?r[0]:{compositeFilter:{op:fQ(n.op),filters:r}}}(t):O()}function pQ(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sV(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Ml=class t{constructor(e,n,r,i,s=q.min(),o=q.min(),a=Tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Bm=class{constructor(e){this.ct=e}};function gQ(t,e){let n;if(e.document)n=JL(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=R.fromSegments(e.noDocument.path),i=Ao(e.noDocument.readTime);n=ft.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return O();{let r=R.fromSegments(e.unknownDocument.path),i=Ao(e.unknownDocument.version);n=ft.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new ze(i[0],i[1]);return q.fromTimestamp(s)}(e.readTime)),n}function kF(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:$m(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:jd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Rl(s,o.version.toTimestamp()),createTime:Rl(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:So(e.version)};else{if(!e.isUnknownDocument())return O();r.unknownDocument={path:n.path.toArray(),version:So(e.version)}}return r}function $m(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function So(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ao(t){let e=new ze(t.seconds,t.nanoseconds);return q.fromTimestamp(e)}function yo(t,e){let n=(e.baseMutations||[]).map(s=>SD(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>SD(t.ct,s)),i=ze.fromMillis(e.localWriteTimeMs);return new Od(e.batchId,i,n,r)}function Id(t){let e=Ao(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ao(t.lastLimboFreeSnapshotVersion):q.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return U(s.documents.length===1),rn($l(XL(s.documents[0])))}(t.query):function(s){return rn(nV(s))}(t.query),new Ml(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Tt.fromBase64String(t.resumeToken))}function oV(t,e){let n=So(e.snapshotVersion),r=So(e.lastLimboFreeSnapshotVersion),i;i=Om(e.target)?eV(t.ct,e.target):tV(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:To(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function ZT(t){let e=nV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Lm(e,e.limit,"L"):e}function $0(t,e){return new Fd(e.largestBatchId,SD(t.ct,e.overlayMutation))}function OF(t,e){let n=e.path.lastSegment();return[t,nn(e.path.popLast()),n]}function FF(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:So(r.readTime),documentKey:nn(r.documentKey.path),largestBatchId:r.largestBatchId}}var AD=class{getBundleMetadata(e,n){return LF(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ao(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return LF(e).put(function(i){return{bundleId:i.id,createTime:So(rt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return VF(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:ZT(s.bundledQuery),readTime:Ao(s.readTime)}}(r)})}saveNamedQuery(e,n){return VF(e).put(function(i){return{name:i.name,readTime:So(rt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function LF(t){return bt(t,"bundles")}function VF(t){return bt(t,"namedQueries")}var qm=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return yd(e).get(OF(this.userId,n)).next(r=>r?$0(this.serializer,r):null)}getOverlays(e,n){let r=Or();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Fd(n,o);i.push(this.ht(e,a))}),y.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(nn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(yd(e).H("collectionPathOverlayIndex",a))}),y.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Or(),s=nn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return yd(e).W("collectionPathOverlayIndex",o).next(a=>{for(let l of a){let c=$0(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Or(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return yd(e).Y({index:"collectionGroupOverlayIndex",range:a},(l,c,u)=>{let d=$0(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>s)}ht(e,n){return yd(e).put(function(i,s,o){let[a,l,c]=OF(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ud(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function yd(t){return bt(t,"documentOverlays")}var hi=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Ke(e.integerValue));else if("doubleValue"in e){let r=Ke(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),xd(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(gs(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?IL(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):O()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),R.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};hi.bt=new hi;function mQ(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function jF(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=mQ(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var xD=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=jF(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=jF(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},RD=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},MD=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},_o=class{constructor(){this.Gt=new xD,this.zt=new RD(this.Gt),this.jt=new MD(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var vo=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function as(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=UF(t.arrayValue,e.arrayValue),n!==0?n:(n=UF(t.directionalValue,e.directionalValue),n!==0?n:R.comparator(t.documentKey,e.documentKey)))}function UF(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Hm=class{constructor(e){this.Yt=new Re((n,r)=>nt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(U(e.collectionGroup===this.collectionId),this.en)return!1;let n=J0(e);if(n!==void 0&&!this.nn(n))return!1;let r=go(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let l=r[s];if(!this.rn(a,l)||!this.sn(this.Zt[o++],l))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Re(nt.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new El(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new El(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new El(r.field,r.dir==="asc"?0:1)));return new Tl(Tl.UNKNOWN_ID,this.collectionId,n,Ad.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function aV(t){var e,n;if(U(t instanceof de||t instanceof Te),t instanceof de){if(t instanceof km){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>de.create(t.field,"==",s)))||[];return Te.create(i,"or")}return t}let r=t.filters.map(i=>aV(i));return Te.create(r,t.op)}function yQ(t){if(t.getFilters().length===0)return[];let e=kD(aV(t));return U(lV(e)),ND(e)||PD(e)?[e]:e.getFilters()}function ND(t){return t instanceof de}function PD(t){return t instanceof Te&&KT(t)}function lV(t){return ND(t)||PD(t)||function(n){if(n instanceof Te&&aD(n)){for(let r of n.getFilters())if(!ND(r)&&!PD(r))return!1;return!0}return!1}(t)}function kD(t){if(U(t instanceof de||t instanceof Te),t instanceof de)return t;if(t.filters.length===1)return kD(t.filters[0]);let e=t.filters.map(r=>kD(r)),n=Te.create(e,t.op);return n=zm(n),lV(n)?n:(U(n instanceof Te),U(Sl(n)),U(n.filters.length>1),n.filters.reduce((r,i)=>JT(r,i)))}function JT(t,e){let n;return U(t instanceof de||t instanceof Te),U(e instanceof de||e instanceof Te),n=t instanceof de?e instanceof de?function(i,s){return Te.create([i,s],"and")}(t,e):BF(t,e):e instanceof de?BF(e,t):function(i,s){if(U(i.filters.length>0&&s.filters.length>0),Sl(i)&&Sl(s))return bL(i,s.getFilters());let o=aD(i)?i:s,a=aD(i)?s:i,l=o.filters.map(c=>JT(c,a));return Te.create(l,"or")}(t,e),zm(n)}function BF(t,e){if(Sl(e))return bL(e,t.getFilters());{let n=e.filters.map(r=>JT(t,r));return Te.create(n,"or")}}function zm(t){if(U(t instanceof de||t instanceof Te),t instanceof de)return t;let e=t.getFilters();if(e.length===1)return zm(e[0]);if(DL(t))return t;let n=e.map(i=>zm(i)),r=[];return n.forEach(i=>{i instanceof de?r.push(i):i instanceof Te&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,t.op)}var OD=class{constructor(){this._n=new Bd}addToCollectionParentIndex(e,n){return this._n.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}deleteAllFieldIndexes(e){return y.resolve()}createTargetIndexes(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(Vn.min())}updateCollectionGroup(e,n,r){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}},Bd=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Re(ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ge.comparator)).toArray()}};var mm=new Uint8Array(0),FD=class{constructor(e,n){this.databaseId=n,this.an=new Bd,this.un=new Br(r=>To(r),(r,i)=>Xd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:nn(i)};return $F(e).put(s)}return y.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[dL(n),""],!1,!0);return $F(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(kr(o.parent))}return r})}addFieldIndex(e,n){let r=_d(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=fl(e);return s.next(a=>{o.put(FF(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=_d(e),i=fl(e),s=hl(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=_d(e),r=hl(e),i=fl(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return y.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Hm(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=hl(e),i=!0,s=new Map;return y.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=te(),a=[];return y.forEach(s,(l,c)=>{D("IndexedDbIndexManager",`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(b=>`${b.fieldPath}:${b.kind}`).join(",")}`}(l)} to execute ${To(n)}`);let u=function(C,b){let B=J0(b);if(B===void 0)return null;for(let H of Fm(C,B.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(c,l),d=function(C,b){let B=new Map;for(let H of go(b))for(let ye of Fm(C,H.fieldPath))switch(ye.op){case"==":case"in":B.set(H.fieldPath.canonicalString(),ye.value);break;case"not-in":case"!=":return B.set(H.fieldPath.canonicalString(),ye.value),Array.from(B.values())}return null}(c,l),h=function(C,b){let B=[],H=!0;for(let ye of go(b)){let it=ye.kind===0?EF(C,ye.fieldPath,C.startAt):IF(C,ye.fieldPath,C.startAt);B.push(it.value),H&&(H=it.inclusive)}return new Ur(B,H)}(c,l),f=function(C,b){let B=[],H=!0;for(let ye of go(b)){let it=ye.kind===0?IF(C,ye.fieldPath,C.endAt):EF(C,ye.fieldPath,C.endAt);B.push(it.value),H&&(H=it.inclusive)}return new Ur(B,H)}(c,l),p=this.hn(l,c,h),g=this.hn(l,c,f),m=this.Pn(l,c,d),w=this.In(l.indexId,u,p,h.inclusive,g,f.inclusive,m);return y.forEach(w,S=>r.j(S,n.limit).next(C=>{C.forEach(b=>{let B=R.fromSegments(b.documentKey);o.has(B)||(o=o.add(B),a.push(B))})}))}).next(()=>a)}return y.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=yQ(Te.create(e.filters,"and")).map(r=>mD(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),u=[];for(let d=0;d<l;++d){let h=n?this.Tn(n[d/c]):mm,f=this.En(e,h,r[d%c],i),p=this.dn(e,h,s[d%c],o),g=a.map(m=>this.En(e,h,m,!0));u.push(...this.createRange(f,p,g))}return u}En(e,n,r,i){let s=new vo(e,R.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new vo(e,R.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new Hm(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return y.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new Re(nt.comparator),u=!1;for(let d of l.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:c=c.add(h.field));for(let d of l.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new _o;for(let i of go(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);hi.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new _o;return hi.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new _o;return hi.bt.Pt(Co(this.databaseId,n),r.Ht(function(s){let o=go(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new _o);let s=0;for(let o of go(e)){let a=r[s++];for(let l of i)if(this.Vn(n,o.fieldPath)&&Pd(a))i=this.mn(i,o,a);else{let c=l.Ht(o.kind);hi.bt.Pt(a,c)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let l=new _o;l.seed(a.Wt()),hi.bt.Pt(o,l.Ht(n.kind)),s.push(l)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof de&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=_d(e),i=fl(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return y.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(u,d){let h=d?new Ad(d.sequenceNumber,new Vn(Ao(d.readTime),new R(kr(d.documentKey)),d.largestBatchId)):Ad.empty(),f=u.fields.map(([p,g])=>new El(nt.fromServerFormat(p),g));return new Tl(u.indexId,u.collectionGroup,f,h)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ee(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=_d(e),s=fl(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,l=>s.put(FF(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return y.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),y.forEach(a,l=>this.pn(e,i,l).next(c=>{let u=this.yn(s,l);return c.isEqual(u)?y.resolve():this.wn(e,s,l,c,u)}))))})}Sn(e,n,r,i){return hl(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return hl(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=hl(e),s=new Re(as);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new vo(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Re(as),i=this.An(n,e);if(i==null)return r;let s=J0(n);if(s!=null){let o=e.data.field(s.fieldPath);if(Pd(o))for(let a of o.arrayValue.values||[])r=r.add(new vo(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new vo(n.indexId,e.key,mm,i));return r}wn(e,n,r,i,s){D("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(l,c,u,d,h){let f=l.getIterator(),p=c.getIterator(),g=dl(f),m=dl(p);for(;g||m;){let w=!1,S=!1;if(g&&m){let C=u(g,m);C<0?S=!0:C>0&&(w=!0)}else g!=null?S=!0:w=!0;w?(d(m),m=dl(p)):S?(h(g),g=dl(f)):(g=dl(f),m=dl(p))}}(i,s,as,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),y.waitFor(o)}gn(e){let n=1;return fl(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>as(o,a)).filter((o,a,l)=>!a||as(o,l[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=as(o,e),l=as(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&l<0)i.push(o),i.push(o.Jt());else if(l>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,mm,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,mm,[]];s.push(IDBKeyRange.bound(a,l))}return s}Dn(e,n){return as(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(qF)}getMinOffset(e,n){return y.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||O())).next(qF)}};function $F(t){return bt(t,"collectionParents")}function hl(t){return bt(t,"indexEntries")}function _d(t){return bt(t,"indexConfiguration")}function fl(t){return bt(t,"indexState")}function qF(t){U(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;zT(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Vn(e.readTime,e.documentKey,n)}var HF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Fn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function cV(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,l=r.Y({range:o},(u,d,h)=>(a++,h.delete()));s.push(l.next(()=>{U(a===1)}));let c=[];for(let u of n.mutations){let d=mL(e,u.key.path,n.batchId);s.push(i.delete(d)),c.push(u.key)}return y.waitFor(s).next(()=>c)}function Gm(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw O();e=t.noDocument}return JSON.stringify(e).length}Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(41943040,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);var Wm=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){U(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ls(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=vl(e),o=ls(e);return o.add({}).next(a=>{U(typeof a=="number");let l=new Od(a,n,r,i),c=function(f,p,g){let m=g.baseMutations.map(S=>Ud(f.ct,S)),w=g.mutations.map(S=>Ud(f.ct,S));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:m,mutations:w}}(this.serializer,this.userId,l),u=[],d=new Re((h,f)=>ee(h.canonicalString(),f.canonicalString()));for(let h of i){let f=mL(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),u.push(o.put(c)),u.push(s.put(f,DK))}return d.forEach(h=>{u.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=l.keys()}),y.waitFor(u).next(()=>l)})}lookupMutationBatch(e,n){return ls(e).get(n).next(r=>r?(U(r.userId===this.userId),yo(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?y.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ls(e).Y({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(U(a.batchId>=r),s=yo(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ls(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ls(e).W("userMutationsIndex",n).next(r=>r.map(i=>yo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=wm(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return vl(e).Y({range:i},(o,a,l)=>{let[c,u,d]=o,h=kr(u);if(c===this.userId&&n.path.isEqual(h))return ls(e).get(d).next(f=>{if(!f)throw O();U(f.userId===this.userId),s.push(yo(this.serializer,f))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(ee),i=[];return n.forEach(s=>{let o=wm(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=vl(e).Y({range:a},(c,u,d)=>{let[h,f,p]=c,g=kr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(l)}),y.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=wm(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Re(ee);return vl(e).Y({range:o},(l,c,u)=>{let[d,h,f]=l,p=kr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):u.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(ls(e).get(s).next(o=>{if(o===null)throw O();U(o.userId===this.userId),r.push(yo(this.serializer,o))}))}),y.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return cV(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),y.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return vl(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let l=kr(s[1]);i.push(l)}else a.done()}).next(()=>{U(i.length===0)})})}containsKey(e,n){return uV(e,this.userId,n)}xn(e){return dV(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function uV(t,e,n){let r=wm(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return vl(t).Y({range:s,J:!0},(a,l,c)=>{let[u,d,h]=a;u===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function ls(t){return bt(t,"mutations")}function vl(t){return bt(t,"documentMutations")}function dV(t){return bt(t,"mutationQueues")}var Nl=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var LD=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new Nl(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>q.fromTimestamp(new ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>pl(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(U(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return pl(e).Y((o,a)=>{let l=Id(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>y.waitFor(s)).next(()=>i)}forEachTarget(e,n){return pl(e).Y((r,i)=>{let s=Id(i);n(s)})}Bn(e){return zF(e).get("targetGlobalKey").next(n=>(U(n!==null),n))}kn(e,n){return zF(e).put("targetGlobalKey",n)}qn(e,n){return pl(e).put(oV(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=To(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return pl(e).Y({range:i,index:"queryTargetsIndex"},(o,a,l)=>{let c=Id(a);Xd(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=cs(e);return n.forEach(o=>{let a=nn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),y.waitFor(i)}removeMatchingKeys(e,n,r){let i=cs(e);return y.forEach(n,s=>{let o=nn(s.path);return y.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=cs(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=cs(e),s=te();return i.Y({range:r,J:!0},(o,a,l)=>{let c=kr(o[1]),u=new R(c);s=s.add(u)}).next(()=>s)}containsKey(e,n){let r=nn(n.path),i=IDBKeyRange.bound([r],[dL(r)],!1,!0),s=0;return cs(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return pl(e).get(n).next(r=>r?Id(r):null)}};function pl(t){return bt(t,"targets")}function zF(t){return bt(t,"targetGlobal")}function cs(t){return bt(t,"targetDocuments")}function GF([t,e],[n,r]){let i=ee(t,n);return i===0?ee(e,r):i}var VD=class{constructor(e){this.Kn=e,this.buffer=new Re(GF),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();GF(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},jD=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){D("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>_(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ds(n)?D("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Cs(n)}yield this.zn(3e5)}))}},UD=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return y.resolve(In._e);let r=new VD(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(D("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(HF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(D("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HF):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,l,c,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(D("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),gl()<=Tn.DEBUG&&D("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function _Q(t,e){return new UD(t,e)}var BD=class{constructor(e,n){this.db=e,this.garbageCollector=_Q(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return ym(e,r)}removeReference(e,n,r){return ym(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ym(e,n)}er(e,n){return function(i,s){let o=!1;return dV(i).Z(a=>uV(i,a,s).next(l=>(l&&(o=!0),y.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let l=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,q.min()),cs(e).delete(function(d){return[0,nn(d.path)]}(o))))});i.push(l)}}).next(()=>y.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ym(e,n)}Xn(e,n){let r=cs(e),i,s=In._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==In._e&&n(new R(kr(i)),s),s=c,i=l):s=In._e}).next(()=>{s!==In._e&&n(new R(kr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function ym(t,e){return cs(t).put(function(r,i){return{targetId:0,path:nn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Km=class{constructor(){this.changes=new Br(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ft.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var $D=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return po(e).put(r)}removeEntry(e,n,r){return po(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],$m(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=ft.newInvalidDocument(n);return po(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(vd(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:ft.newInvalidDocument(n)};return po(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(vd(n))},(i,s)=>{r={document:this.nr(n,s),size:Gm(s)}}).next(()=>r)}getEntries(e,n){let r=hn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=hn(),i=new Le(R.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Gm(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return y.resolve();let i=new Re(QF);n.forEach(l=>i=i.add(l));let s=IDBKeyRange.bound(vd(i.first()),vd(i.last())),o=i.getIterator(),a=o.getNext();return po(e).Y({index:"documentKeyIndex",range:s},(l,c,u)=>{let d=R.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&QF(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.U(vd(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),$m(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return po(e).W(IDBKeyRange.bound(a,l,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let u=hn();for(let d of c){let h=this.nr(R.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Jd(n,h)||i.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,i){let s=hn(),o=KF(n,r),a=KF(n,Vn.max());return po(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{let d=this.nr(R.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new qD(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return WF(e).get("remoteDocumentGlobalKey").next(n=>(U(!!n),n))}tr(e,n){return WF(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=gQ(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(q.min())))return r}return ft.newInvalidDocument(e)}};function hV(t){return new $D(t)}var qD=class extends Km{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Br(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Re((s,o)=>ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let l=kF(this.ar.serializer,o);i=i.add(s.path.popLast());let c=Gm(l);r+=c-a.size,n.push(this.ar.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){let l=kF(this.ar.serializer,o.convertToNoDocument(q.min()));n.push(this.ar.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),y.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function WF(t){return bt(t,"remoteDocumentGlobal")}function po(t){return bt(t,"remoteDocumentsV14")}function vd(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function KF(t,e){let n=e.documentKey.path.toArray();return[t,$m(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function QF(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ee(n[s],r[s]),i)return i;return i=ee(n.length,r.length),i||(i=ee(n[n.length-2],r[r.length-2]),i||ee(n[n.length-1],r[r.length-1]))}var HD=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Qm=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Td(r.mutation,i,Cn.empty(),ze.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=te()){let i=Or();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ed();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Or();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,te()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=hn(),o=Dd(),a=function(){return Dd()}();return n.forEach((l,c)=>{let u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof ir)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Td(u.mutation,c,u.mutation.getFieldMask(),ze.now())):o.set(c.key,Cn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var d;return a.set(c,new HD(u,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Dd(),i=new Le((o,a)=>o-a),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(l=>{let c=n.get(l);if(c===null)return;let u=r.get(l)||Cn.empty();u=a.applyToLocalView(c,u),r.set(l,u);let d=(i.get(a.batchId)||te()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,u=l.value,d=OL();u.forEach(h=>{if(!s.has(h)){let f=qL(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return R.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):QT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):y.resolve(Or()),a=-1,l=s;return o.next(c=>y.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?y.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,te())).next(u=>({batchId:a,changes:kL(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new R(n)).next(r=>{let i=Ed();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Ed();return this.indexManager.getCollectionParents(e,s).next(a=>y.forEach(a,l=>{let c=function(d,h){return new rr(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(u=>{u.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,c)=>{let u=c.getKey();o.get(u)===null&&(o=o.insert(u,ft.newInvalidDocument(u)))});let a=Ed();return o.forEach((l,c)=>{let u=s.get(l);u!==void 0&&Td(u.mutation,c,Cn.empty(),ze.now()),Jd(n,c)&&(a=a.insert(l,c))}),a})}};var zD=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return y.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:rt(i.createTime)}}(n)),y.resolve()}getNamedQuery(e,n){return y.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:ZT(i.bundledQuery),readTime:rt(i.readTime)}}(n)),y.resolve()}};var GD=class{constructor(){this.overlays=new Le(R.comparator),this.hr=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Or();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),y.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),y.resolve()}getOverlaysForCollection(e,n,r){let i=Or(),s=n.length+1,o=new R(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return y.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Le((c,u)=>c-u),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=Or(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}let a=Or(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=i)););return y.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fd(n,r));let s=this.hr.get(n);s===void 0&&(s=te(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var $d=class{constructor(){this.Pr=new Re(ut.Ir),this.Tr=new Re(ut.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new ut(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new ut(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new R(new ge([])),r=new ut(n,e),i=new ut(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new R(new ge([])),r=new ut(n,e),i=new ut(n,e+1),s=te();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new ut(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},ut=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return R.comparator(e.key,n.key)||ee(e.pr,n.pr)}static Er(e,n){return ee(e.pr,n.pr)||R.comparator(e.key,n.key)}};var WD=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Re(ut.Ir)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Od(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new ut(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new ut(n,0),i=new ut(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(ee);return n.forEach(i=>{let s=new ut(i,0),o=new ut(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),y.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;R.isDocumentKey(s)||(s=s.child(""));let o=new ut(new R(s),0),a=new Re(ee);return this.wr.forEachWhile(l=>{let c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.pr)),!0)},o),y.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){U(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return y.forEach(n.mutations,i=>{let s=new ut(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new ut(n,0),i=this.wr.firstAfterOrEqual(r);return y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var KD=class{constructor(e){this.vr=e,this.docs=function(){return new Le(R.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return y.resolve(r?r.document.mutableCopy():ft.newInvalidDocument(n))}getEntries(e,n){let r=hn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ft.newInvalidDocument(i))}),y.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=hn(),o=n.path,a=new R(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||zT(fL(u),r)<=0||(i.has(u.key)||Jd(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return y.resolve(s)}getAllFromCollectionGroup(e,n,r,i){O()}Fr(e,n){return y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new QD(this)}getSize(e){return y.resolve(this.size)}},QD=class extends Km{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),y.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var YD=class{constructor(e){this.persistence=e,this.Mr=new Br(n=>To(n),Xd),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Or=0,this.Nr=new $d,this.targetCount=0,this.Lr=Nl.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),y.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new Nl(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.qn(n),y.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),y.waitFor(s).next(()=>i)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return y.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),y.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),y.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),y.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return y.resolve(r)}containsKey(e,n){return y.resolve(this.Nr.containsKey(n))}};var Ym=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new In(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new YD(this),this.indexManager=new OD,this.remoteDocumentCache=function(i){return new KD(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Bm(n),this.$r=new zD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new GD,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new WD(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){D("MemoryPersistence","Starting transaction:",e);let i=new XD(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return y.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},XD=class extends xm{constructor(e){super(),this.currentSequenceNumber=e}},Xm=class t{constructor(e){this.persistence=e,this.zr=new $d,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw O()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),y.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),y.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.Jr,r=>{let i=R.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,q.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return y.or([()=>y.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var ZD=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Rm("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",hF,{unique:!0}),l.createObjectStore("documentMutations")}(e),YF(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),YF(e)),o=o.next(()=>function(l){let c=l.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:q.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").W().next(u=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",hF,{unique:!0});let d=c.store("mutations"),h=u.map(f=>d.put(f));return y.waitFor(h)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){let c=l.createObjectStore("documentOverlays",{keyPath:FK});c.createIndex("collectionPathOverlayIndex",LK,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",VK,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){let c=l.createObjectStore("remoteDocumentsV14",{keyPath:TK});c.createIndex("documentKeyIndex",bK),c.createIndex("collectionGroupIndex",SK)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:NK}).createIndex("sequenceNumberIndex",PK,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:kK}).createIndex("documentKeyIndex",OK,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Gm(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>y.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>y.forEach(a,l=>{U(l.userId===s.userId);let c=yo(this.serializer,l);return cV(e,s.userId,c).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let l=new ge(o),c=function(d){return[0,nn(d)]}(l);s.push(n.get(c).next(u=>u?y.resolve():(d=>n.put({targetId:0,path:nn(d),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>y.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:MK});let r=n.store("collectionParents"),i=new Bd,s=o=>{if(i.add(o)){let a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:nn(l)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let l=new ge(o);return s(l.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,l],c)=>{let u=kr(a);return s(u.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Id(i),o=oV(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),l=function(d){return d.document?new R(ge.fromString(d.document.name).popFirst(5)):d.noDocument?R.fromSegments(d.noDocument.path):d.unknownDocument?R.fromSegments(d.unknownDocument.path):O()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>y.waitFor(i))}si(e,n){let r=n.store("mutations"),i=hV(this.serializer),s=new Ym(Xm.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(l=>{var c;let u=(c=a.get(l.userId))!==null&&c!==void 0?c:te();yo(this.serializer,l).keys().forEach(d=>u=u.add(d)),a.set(l.userId,u)}),y.forEach(a,(l,c)=>{let u=new dt(c),d=qm.lt(this.serializer,u),h=s.getIndexManager(u),f=Wm.lt(u,this.serializer,h,s.referenceDelegate);return new Qm(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Rd(n,In._e),l).next()})})}};function YF(t){t.createObjectStore("targetDocuments",{keyPath:xK}).createIndex("documentTargetsIndex",RK,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",AK,{unique:!0}),t.createObjectStore("targetGlobal")}var q0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",JD=class t{constructor(e,n,r,i,s,o,a,l,c,u,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=u,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new I(v.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new BD(this,i),this.Ti=n+"main",this.serializer=new Bm(l),this.Ei=new pi(this.Ti,this.ui,new ZD(this.serializer)),this.Qr=new LD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hV(this.serializer),this.$r=new AD,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,u===!1&&tt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new I(v.FAILED_PRECONDITION,q0);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new In(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>_(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B(n=>_(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>_(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>_m(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Ds(e))return D("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return D("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return wd(e).get("owner").next(n=>y.resolve(this.Si(n)))}bi(e){return _m(e).delete(this.clientId)}Di(){return _(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=bt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return y.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?y.resolve(!0):wd(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new I(v.FAILED_PRECONDITION,q0);return!1}}return!(!this.networkEnabled||!this.inForeground)||_m(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&D("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return _(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Rd(e,In._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>_m(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return Wm.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new FD(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return qm.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){D("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===15?UK:l===14?vL:l===13?_L:l===12?jK:l===11?yL:void O()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Rd(a,this.kr?this.kr.next():In._e),n==="readwrite-primary"?this.gi(o).next(l=>!!l||this.pi(o)).next(l=>{if(!l)throw tt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new I(v.FAILED_PRECONDITION,pL);return r(o)}).next(l=>this.wi(o).next(()=>l)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return wd(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new I(v.FAILED_PRECONDITION,q0)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return wd(e).put("owner",n)}static D(){return pi.D()}yi(e){let n=wd(e);return n.get("owner").next(r=>this.Si(r)?(D("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(tt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;Qy()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return D("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return tt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){tt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function wd(t){return bt(t,"owner")}function _m(t){return bt(t,"clientMetadata")}function eb(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var eT=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=te(),i=te();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var tT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Zm=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Qy()?8:pi.v(Jl())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new tT;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(gl()<=Tn.DEBUG&&D("QueryEngine","SDK will not create cache indexes for query:",ml(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),y.resolve()):(gl()<=Tn.DEBUG&&D("QueryEngine","Query:",ml(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(gl()<=Tn.DEBUG&&D("QueryEngine","The SDK decides to create cache indexes for query:",ml(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rn(n))):y.resolve())}ji(e,n){if(CF(n))return y.resolve(null);let r=rn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Lm(n,null,"F"),r=rn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{let c=this.Zi(n,a);return this.Xi(n,c,o,l.readTime)?this.ji(e,Lm(n,null,"F")):this.es(e,c,n,l)}))})))}Hi(e,n,r,i){return CF(n)||i.isEqual(q.min())?y.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?y.resolve(null):(gl()<=Tn.DEBUG&&D("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ml(n)),this.es(e,o,n,hL(i,-1)).next(a=>a))})}Zi(e,n){let r=new Re(NL(e));return n.forEach((i,s)=>{Jd(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return gl()<=Tn.DEBUG&&D("QueryEngine","Using full collection scan to execute query:",ml(n)),this.zi.getDocumentsMatchingQuery(e,n,Vn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var nT=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Le(ee),this.rs=new Br(s=>To(s),Xd),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Qm(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function fV(t,e,n,r){return new nT(t,e,n,r)}function pV(t,e){return _(this,null,function*(){let n=N(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],l=te();for(let c of i){o.push(c.batchId);for(let u of c.mutations)l=l.add(u.key)}for(let c of s){a.push(c.batchId);for(let u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})})}function vQ(t,e){let n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){let d=c.batch,h=d.keys(),f=y.resolve();return h.forEach(p=>{f=f.next(()=>u.getEntry(l,p)).next(g=>{let m=c.docVersions.get(p);U(m!==null),g.version.compareTo(m)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=te();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function gV(t){let e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function wQ(t,e){let n=N(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((u,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,u.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Tt.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(d,f),function(g,m,w){return g.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(h,f,u)&&a.push(n.Qr.updateTargetData(s,f))});let l=hn(),c=te();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(mV(s,o,e.documentUpdates).next(u=>{l=u.cs,c=u.ls})),!r.isEqual(q.min())){let u=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return y.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.ns=i,s))}function mV(t,e,n){let r=te(),i=te();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=hn();return n.forEach((a,l)=>{let c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(q.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):D("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{cs:o,ls:i}})}function EQ(t,e){let n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Pl(t,e){let n=N(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,y.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Ml(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function kl(t,e,n){return _(this,null,function*(){let r=N(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ds(o))throw o;D("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Jm(t,e,n){let r=N(t),i=q.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){let d=N(l),h=d.rs.get(u);return h!==void 0?y.resolve(d.ns.get(h)):d.Qr.getTargetData(c,u)}(r,o,rn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:q.min(),n?s:te())).next(a=>(vV(r,ML(e),a),{documents:a,hs:s})))}function yV(t,e){let n=N(t),r=N(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function _V(t,e){let n=N(t),r=n.ss.get(e)||q.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,hL(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(vV(n,e,i),i))}function vV(t,e,n){let r=t.ss.get(e)||q.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function IQ(t,e,n,r){return _(this,null,function*(){let i=N(t),s=te(),o=hn();for(let c of n){let u=e.Ps(c.metadata.name);c.document&&(s=s.add(u));let d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(u,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),l=yield Pl(i,function(u){return rn($l(ge.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>mV(c,a,o).next(u=>(a.apply(c),u)).next(u=>i.Qr.removeMatchingKeysForTargetId(c,l.targetId).next(()=>i.Qr.addMatchingKeys(c,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,u.cs,u.ls)).next(()=>u.cs)))})}function CQ(r,i){return _(this,arguments,function*(t,e,n=te()){let s=yield Pl(t,rn(ZT(e.bundledQuery))),o=N(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let l=rt(e.readTime);if(s.snapshotVersion.compareTo(l)>=0)return o.$r.saveNamedQuery(a,e);let c=s.withResumeToken(Tt.EMPTY_BYTE_STRING,l);return o.ns=o.ns.insert(c.targetId,c),o.Qr.updateTargetData(a,c).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function XF(t,e){return`firestore_clients_${t}_${e}`}function ZF(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function H0(t,e){return`firestore_targets_${t}_${e}`}var ey=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new I(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(tt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},bd=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new I(r.error.code,r.error.message))),s?new t(e,r.state,i):(tt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ty=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=YT();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=gL(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(tt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},rT=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(tt("SharedClientState",`Failed to parse online state: ${e}`),null)}},qd=class{constructor(){this.activeTargetIds=YT()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Sd=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Le(ee),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=XF(this.persistenceKey,this.Vs),this.Ss=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new qd),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Fs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return _(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(XF(this.persistenceKey,r));if(i){let s=ty.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(H0(this.persistenceKey,e));if(r){let i=bd.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(H0(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return D("SharedClientState","READ",e,n),n}setItem(e,n){D("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){D("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(D("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void tt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>_(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=In._e;if(s!=null)try{let a=JSON.parse(s);U(typeof a=="number"),o=a}catch(a){tt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==In._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new ey(this.currentUser,e,n,r),s=ZF(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=ZF(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=H0(this.persistenceKey,e),s=new bd(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return ty.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return ey.Es(new dt(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return bd.Es(i,n)}xs(e){return rT.Es(e)}Js(e){return JSON.parse(e)}zs(e){return _(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);D("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=YT();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},ny=class{constructor(){this.no=new qd,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new qd,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var iT=class{io(e){}shutdown(){}};var ry=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){D("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){D("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var vm=null;function z0(){return vm===null?vm=function(){return 268435456+Math.round(2147483648*Math.random())}():vm++,"0x"+vm.toString(16)}var DQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var sT=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Ht="WebChannelConnection",oT=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=z0(),l=this.bo(n,r.toUriEncodedString());D("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);let c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,o),this.Co(n,l,c,i).then(u=>(D("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw Ln("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",l,"request:",i),u})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=DQ[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=z0();return new Promise((o,a)=>{let l=new aF;l.setWithCredentials(!0),l.listenOnce(sF.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case gm.NO_ERROR:let u=l.getResponseJson();D(Ht,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case gm.TIMEOUT:D(Ht,`RPC '${e}' ${s} timed out`),a(new I(v.DEADLINE_EXCEEDED,"Request time out"));break;case gm.HTTP_ERROR:let d=l.getStatus();if(D(Ht,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(m){let w=m.toLowerCase().replace(/_/g,"-");return Object.values(v).indexOf(w)>=0?w:v.UNKNOWN}(f.status);a(new I(p,f.message))}else a(new I(v.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new I(v.UNAVAILABLE,"Connection failed."));break;default:O()}}finally{D(Ht,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);D(Ht,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}Fo(e,n,r){let i=z0(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=rF(),a=iF(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;let u=s.join("");D(Ht,`Creating RPC '${e}' stream ${i}: ${u}`,l);let d=o.createWebChannel(u,l),h=!1,f=!1,p=new sT({lo:m=>{f?D(Ht,`Not sending because RPC '${e}' stream ${i} is closed:`,m):(h||(D(Ht,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),D(Ht,`RPC '${e}' stream ${i} sending:`,m),d.send(m))},ho:()=>d.close()}),g=(m,w,S)=>{m.listen(w,C=>{try{S(C)}catch(b){setTimeout(()=>{throw b},0)}})};return g(d,md.EventType.OPEN,()=>{f||D(Ht,`RPC '${e}' stream ${i} transport opened.`)}),g(d,md.EventType.CLOSE,()=>{f||(f=!0,D(Ht,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,md.EventType.ERROR,m=>{f||(f=!0,Ln(Ht,`RPC '${e}' stream ${i} transport errored:`,m),p.Vo(new I(v.UNAVAILABLE,"The operation could not be completed")))}),g(d,md.EventType.MESSAGE,m=>{var w;if(!f){let S=m.data[0];U(!!S);let C=S,b=C.error||((w=C[0])===null||w===void 0?void 0:w.error);if(b){D(Ht,`RPC '${e}' stream ${i} received error:`,b);let B=b.status,H=function(bs){let ch=ct[bs];if(ch!==void 0)return GL(ch)}(B),ye=b.message;H===void 0&&(H=v.INTERNAL,ye="Unknown error status: "+B+" with message "+b.message),f=!0,p.Vo(new I(H,ye)),d.close()}else D(Ht,`RPC '${e}' stream ${i} received:`,S),p.mo(S)}}),g(a,oF.STAT_EVENT,m=>{m.stat===B0.PROXY?D(Ht,`RPC '${e}' stream ${i} detected buffering proxy`):m.stat===B0.NOPROXY&&D(Ht,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function wV(){return typeof window<"u"?window:null}function Dm(){return typeof document<"u"?document:null}function eh(t){return new CD(t,!0)}var Hd=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&D("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Lo!==null&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){this.Lo!==null&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}};var iy=class{constructor(e,n,r,i,s,o,a,l){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Hd(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return _(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return _(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return _(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===v.RESOURCE_EXHAUSTED?(tt(n.toString()),tt("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===v.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new I(v.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>_(this,null,function*(){this.state=0,this.start()}))}__(e){return D("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(D("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},aT=class extends iy{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=lQ(this.serializer,e),r=function(s){if(!("targetChange"in s))return q.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?q.min():o.readTime?rt(o.readTime):q.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=bD(this.serializer),n.addTarget=function(s,o){let a,l=o.target;if(a=Om(l)?{documents:eV(s,l)}:{query:tV(s,l).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=KL(s,o.resumeToken);let c=DD(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(q.min())>0){a.readTime=Rl(s,o.snapshotVersion.toTimestamp());let c=DD(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=uQ(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=bD(this.serializer),n.removeTarget=e,this.t_(n)}},lT=class extends iy{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(U(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=cQ(e.writeResults,e.commitTime),r=rt(e.commitTime);return this.listener.T_(r,n)}return U(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=bD(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Ud(this.serializer,r))};this.t_(n)}};var cT=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new I(v.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,TD(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new I(v.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,TD(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new I(v.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var uT=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(tt(n),this.g_=!1):D("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var dT=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>_(this,null,function*(){Ts(this)&&(D("RemoteStore","Restarting streams for network reachability change."),yield function(l){return _(this,null,function*(){let c=N(l);c.v_.add(4),yield ql(c),c.x_.set("Unknown"),c.v_.delete(4),yield th(c)})}(this))}))}),this.x_=new uT(r,i)}};function th(t){return _(this,null,function*(){if(Ts(t))for(let e of t.F_)yield e(!0)})}function ql(t){return _(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Cy(t,e){let n=N(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),rb(n)?nb(n):zl(n).Jo()&&tb(n,e))}function Ol(t,e){let n=N(t),r=zl(n);n.C_.delete(e),r.Jo()&&EV(n,e),n.C_.size===0&&(r.Jo()?r.Xo():Ts(n)&&n.x_.set("Unknown"))}function tb(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}zl(t).c_(e)}function EV(t,e){t.O_.Oe(e),zl(t).l_(e)}function nb(t){t.O_=new ID({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),zl(t).start(),t.x_.p_()}function rb(t){return Ts(t)&&!zl(t).Ho()&&t.C_.size>0}function Ts(t){return N(t).v_.size===0}function IV(t){t.O_=void 0}function TQ(t){return _(this,null,function*(){t.C_.forEach((e,n)=>{tb(t,e)})})}function bQ(t,e){return _(this,null,function*(){IV(t),rb(t)?(t.x_.S_(e),nb(t)):t.x_.set("Unknown")})}function SQ(t,e,n){return _(this,null,function*(){if(t.x_.set("Online"),e instanceof jm&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){D("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield sy(t,r)}else if(e instanceof Cl?t.O_.$e(e):e instanceof Vm?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(q.min()))try{let r=yield gV(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let u=s.C_.get(c);u&&s.C_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{let u=s.C_.get(l);if(!u)return;s.C_.set(l,u.withResumeToken(Tt.EMPTY_BYTE_STRING,u.snapshotVersion)),EV(s,l);let d=new Ml(u.target,l,c,u.sequenceNumber);tb(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){D("RemoteStore","Failed to raise snapshot:",r),yield sy(t,r)}})}function sy(t,e,n){return _(this,null,function*(){if(!Ds(e))throw e;t.v_.add(1),yield ql(t),t.x_.set("Offline"),n||(n=()=>gV(t.localStore)),t.asyncQueue.enqueueRetryable(()=>_(this,null,function*(){D("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield th(t)}))})}function CV(t,e){return e().catch(n=>sy(t,n,e))}function Hl(t){return _(this,null,function*(){let e=N(t),n=Is(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;AQ(e);)try{let i=yield EQ(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,xQ(e,i)}catch(i){yield sy(e,i)}DV(e)&&TV(e)})}function AQ(t){return Ts(t)&&t.D_.length<10}function xQ(t,e){t.D_.push(e);let n=Is(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function DV(t){return Ts(t)&&!Is(t).Ho()&&t.D_.length>0}function TV(t){Is(t).start()}function RQ(t){return _(this,null,function*(){Is(t).d_()})}function MQ(t){return _(this,null,function*(){let e=Is(t);for(let n of t.D_)e.I_(n.mutations)})}function NQ(t,e,n){return _(this,null,function*(){let r=t.D_.shift(),i=vD.from(r,e,n);yield CV(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Hl(t)})}function PQ(t,e){return _(this,null,function*(){e&&Is(t).P_&&(yield function(r,i){return _(this,null,function*(){if(function(o){return zL(o)&&o!==v.ABORTED}(i.code)){let s=r.D_.shift();Is(r).Zo(),yield CV(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Hl(r)}})}(t,e)),DV(t)&&TV(t)})}function JF(t,e){return _(this,null,function*(){let n=N(t);n.asyncQueue.verifyOperationInProgress(),D("RemoteStore","RemoteStore received new credentials");let r=Ts(n);n.v_.add(3),yield ql(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield th(n)})}function hT(t,e){return _(this,null,function*(){let n=N(t);e?(n.v_.delete(2),yield th(n)):e||(n.v_.add(2),yield ql(n),n.x_.set("Unknown"))})}function zl(t){return t.N_||(t.N_=function(n,r,i){let s=N(n);return s.R_(),new aT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:TQ.bind(null,t),To:bQ.bind(null,t),u_:SQ.bind(null,t)}),t.F_.push(e=>_(this,null,function*(){e?(t.N_.Zo(),rb(t)?nb(t):t.x_.set("Unknown")):(yield t.N_.stop(),IV(t))}))),t.N_}function Is(t){return t.L_||(t.L_=function(n,r,i){let s=N(n);return s.R_(),new lT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:RQ.bind(null,t),To:PQ.bind(null,t),E_:MQ.bind(null,t),T_:NQ.bind(null,t)}),t.F_.push(e=>_(this,null,function*(){e?(t.L_.Zo(),yield Hl(t)):(yield t.L_.stop(),t.D_.length>0&&(D("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}var fT=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ht,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(v.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Gl(t,e){if(tt("AsyncQueue",`${e}: ${t}`),Ds(t))return new I(v.UNAVAILABLE,`${e}: ${t}`);throw t}var oy=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||R.comparator(n.key,r.key):(n,r)=>R.comparator(n.key,r.key),this.keyedMap=Ed(),this.sortedSet=new Le(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var ay=class{constructor(){this.B_=new Le(R.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):O():this.B_=this.B_.insert(n,e)}k_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},Fl=class t{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,oy.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var pT=class{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some(e=>e.U_())}},gT=class{constructor(){this.queries=new Br(e=>RL(e),Zd),this.onlineState="Unknown",this.W_=new Set}};function ib(t,e){return _(this,null,function*(){let n=N(t),r=3,i=e.query,s=n.queries.get(i);s?!s.K_()&&e.U_()&&(r=2):(s=new pT,r=e.U_()?0:1);try{switch(r){case 0:s.q_=yield n.onListen(i,!0);break;case 1:s.q_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=Gl(o,`Initialization of query '${ml(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Q_.push(e),e.G_(n.onlineState),s.q_&&e.z_(s.q_)&&ob(n)})}function sb(t,e){return _(this,null,function*(){let n=N(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),s.Q_.length===0?i=e.U_()?0:1:!s.K_()&&e.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function kQ(t,e){let n=N(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.z_(i)&&(r=!0);o.q_=i}}r&&ob(n)}function OQ(t,e,n){let r=N(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function ob(t){t.W_.forEach(e=>{e.next()})}var mT,eL;(eL=mT||(mT={})).j_="default",eL.Cache="cache";var zd=class{constructor(e,n,r){this.query=e,this.H_=n,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Fl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),n=!0):this.X_(e,this.onlineState)&&(this.ea(e),n=!0),this.Y_=e,n}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let n=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),n=!0),n}X_(e,n){if(!e.fromCache||!this.U_())return!0;let r=n!=="Offline";return(!this.options.ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Z_(e){if(e.docChanges.length>0)return!0;let n=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ea(e){e=Fl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==mT.Cache}};var yT=class{constructor(e,n){this.na=e,this.byteLength=n}ra(){return"metadata"in this.na}};var ly=class{constructor(e){this.serializer=e}Ps(e){return Lr(this.serializer,e)}Is(e){return e.metadata.exists?JL(this.serializer,e.document,!1):ft.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return rt(e)}},_T=class{constructor(e,n,r){this.ia=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=bV(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++n;let r=ge.fromString(e.na.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}oa(e){let n=new Map,r=new ly(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||te()).add(s);n.set(o,a)}}return n}complete(){return _(this,null,function*(){let e=yield IQ(this.localStore,new ly(this.serializer),this.documents,this.ia.id),n=this.oa(this.documents);for(let r of this.queries)yield CQ(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}})}};function bV(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var cy=class{constructor(e){this.key=e}},uy=class{constructor(e){this.key=e}},dy=class{constructor(e,n){this.query=e,this.ua=n,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=te(),this.mutatedKeys=te(),this.ha=NL(e),this.Pa=new oy(this.ha)}get Ia(){return this.ua}Ta(e,n){let r=n?n.Ea:new ay,i=n?n.Pa:this.Pa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,d)=>{let h=i.get(u),f=Jd(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),m=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.da(h,f)||(r.track({type:2,doc:f}),m=!0,(l&&this.ha(f,l)>0||c&&this.ha(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),m=!0):h&&!f&&(r.track({type:1,doc:h}),m=!0,(l||c)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Pa:o,Ea:r,Xi:a,mutatedKeys:s}}da(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;let o=e.Ea.k_();o.sort((u,d)=>function(f,p){let g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O()}};return g(f)-g(p)}(u.type,d.type)||this.ha(u.doc,d.doc)),this.Aa(r),i=i!=null&&i;let a=n&&!i?this.Ra():[],l=this.la.size===0&&this.current&&!i?1:0,c=l!==this.ca;return this.ca=l,o.length!==0||c?{snapshot:new Fl(this.query,e.Pa,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),Va:a}:{Va:a}}G_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new ay,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach(n=>this.ua=this.ua.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ua=this.ua.delete(n)),this.current=e.current)}Ra(){if(!this.current)return[];let e=this.la;this.la=te(),this.Pa.forEach(r=>{this.ma(r.key)&&(this.la=this.la.add(r.key))});let n=[];return e.forEach(r=>{this.la.has(r)||n.push(new uy(r))}),this.la.forEach(r=>{e.has(r)||n.push(new cy(r))}),n}fa(e){this.ua=e.hs,this.la=te();let n=this.Ta(e.documents);return this.applyChanges(n,!0)}ga(){return Fl.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,this.ca===0,this.hasCachedResults)}},vT=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},wT=class{constructor(e){this.key=e,this.pa=!1}},ET=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Br(a=>RL(a),Zd),this.Sa=new Map,this.ba=new Set,this.Da=new Le(R.comparator),this.Ca=new Map,this.va=new $d,this.Fa={},this.Ma=new Map,this.xa=Nl.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return this.Oa===!0}};function FQ(t,e,n=!0){return _(this,null,function*(){let r=Dy(t),i,s=r.wa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=yield SV(r,e,n,!0),i})}function LQ(t,e){return _(this,null,function*(){let n=Dy(t);yield SV(n,e,!0,!1)})}function SV(t,e,n,r){return _(this,null,function*(){let i=yield Pl(t.localStore,rn(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield ab(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Cy(t.remoteStore,i),a})}function ab(t,e,n,r,i){return _(this,null,function*(){t.Na=(d,h,f)=>function(g,m,w,S){return _(this,null,function*(){let C=m.view.Ta(w);C.Xi&&(C=yield Jm(g.localStore,m.query,!1).then(({documents:ye})=>m.view.Ta(ye,C)));let b=S&&S.targetChanges.get(m.targetId),B=S&&S.targetMismatches.get(m.targetId)!=null,H=m.view.applyChanges(C,g.isPrimaryClient,b,B);return IT(g,m.targetId,H.Va),H.snapshot})}(t,d,h,f);let s=yield Jm(t.localStore,e,!0),o=new dy(e,s.hs),a=o.Ta(s.documents),l=Vd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);IT(t,n,c.Va);let u=new vT(e,n,o);return t.wa.set(e,u),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),c.snapshot})}function VQ(t,e,n){return _(this,null,function*(){let r=N(t),i=r.wa.get(e),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter(o=>!Zd(o,e))),void r.wa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield kl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ol(r.remoteStore,i.targetId),Ll(r,i.targetId)}).catch(Cs))):(Ll(r,i.targetId),yield kl(r.localStore,i.targetId,!0))})}function jQ(t,e){return _(this,null,function*(){let n=N(t),r=n.wa.get(e),i=n.Sa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ol(n.remoteStore,r.targetId))})}function UQ(t,e,n){return _(this,null,function*(){let r=db(t);try{let i=yield function(o,a){let l=N(o),c=ze.now(),u=a.reduce((f,p)=>f.add(p.key),te()),d,h;return l.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=hn(),g=te();return l.os.getEntries(f,u).next(m=>{p=m,p.forEach((w,S)=>{S.isValidDocument()||(g=g.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(f,p)).next(m=>{d=m;let w=[];for(let S of a){let C=tQ(S,d.get(S.key).overlayedDocument);C!=null&&w.push(new ir(S.key,C,CL(C.value.mapValue),Qe.exists(!0)))}return l.mutationQueue.addMutationBatch(f,c,w,a)}).next(m=>{h=m;let w=m.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(f,m.batchId,w)})}).then(()=>({batchId:h.batchId,changes:kL(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Fa[o.currentUser.toKey()];c||(c=new Le(ee)),c=c.insert(a,l),o.Fa[o.currentUser.toKey()]=c}(r,i.batchId,n),yield vi(r,i.changes),yield Hl(r.remoteStore)}catch(i){let s=Gl(i,"Failed to persist write");n.reject(s)}})}function AV(t,e){return _(this,null,function*(){let n=N(t);try{let r=yield wQ(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Ca.get(s);o&&(U(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.pa=!0:i.modifiedDocuments.size>0?U(o.pa):i.removedDocuments.size>0&&(U(o.pa),o.pa=!1))}),yield vi(n,r,e)}catch(r){yield Cs(r)}})}function tL(t,e,n){let r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.wa.forEach((s,o)=>{let a=o.view.G_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let l=N(o);l.onlineState=a;let c=!1;l.queries.forEach((u,d)=>{for(let h of d.Q_)h.G_(a)&&(c=!0)}),c&&ob(l)}(r.eventManager,e),i.length&&r.ya.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function BQ(t,e,n){return _(this,null,function*(){let r=N(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Ca.get(e),s=i&&i.key;if(s){let o=new Le(R.comparator);o=o.insert(s,ft.newNoDocument(s,q.min()));let a=te().add(s),l=new Ld(q.min(),new Map,new Le(ee),o,a);yield AV(r,l),r.Da=r.Da.remove(s),r.Ca.delete(e),ub(r)}else yield kl(r.localStore,e,!1).then(()=>Ll(r,e,n)).catch(Cs)})}function $Q(t,e){return _(this,null,function*(){let n=N(t),r=e.batch.batchId;try{let i=yield vQ(n.localStore,e);cb(n,r,null),lb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield vi(n,i)}catch(i){yield Cs(i)}})}function qQ(t,e,n){return _(this,null,function*(){let r=N(t);try{let i=yield function(o,a){let l=N(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(U(d!==null),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);cb(r,e,n),lb(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield vi(r,i)}catch(i){yield Cs(i)}})}function HQ(t,e){return _(this,null,function*(){let n=N(t);Ts(n.remoteStore)||D("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=N(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ma.get(r)||[];i.push(e),n.Ma.set(r,i)}catch(r){let i=Gl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function lb(t,e){(t.Ma.get(e)||[]).forEach(n=>{n.resolve()}),t.Ma.delete(e)}function cb(t,e,n){let r=N(t),i=r.Fa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}function Ll(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Sa.get(e))t.wa.delete(r),n&&t.ya.La(r,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach(r=>{t.va.containsKey(r)||xV(t,r)})}function xV(t,e){t.ba.delete(e.path.canonicalString());let n=t.Da.get(e);n!==null&&(Ol(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),ub(t))}function IT(t,e,n){for(let r of n)r instanceof cy?(t.va.addReference(r.key,e),zQ(t,r)):r instanceof uy?(D("SyncEngine","Document no longer in limbo: "+r.key),t.va.removeReference(r.key,e),t.va.containsKey(r.key)||xV(t,r.key)):O()}function zQ(t,e){let n=e.key,r=n.path.canonicalString();t.Da.get(n)||t.ba.has(r)||(D("SyncEngine","New document in limbo: "+n),t.ba.add(r),ub(t))}function ub(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){let e=t.ba.values().next().value;t.ba.delete(e);let n=new R(ge.fromString(e)),r=t.xa.next();t.Ca.set(r,new wT(n)),t.Da=t.Da.insert(n,r),Cy(t.remoteStore,new Ml(rn($l(n.path)),r,"TargetPurposeLimboResolution",In._e))}}function vi(t,e,n){return _(this,null,function*(){let r=N(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach((a,l)=>{o.push(r.Na(l,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let u=eT.Ki(l.targetId,c);s.push(u)}}))}),yield Promise.all(o),r.ya.u_(i),yield function(l,c){return _(this,null,function*(){let u=N(l);try{yield u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>y.forEach(c,h=>y.forEach(h.qi,f=>u.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>y.forEach(h.Qi,f=>u.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Ds(d))throw d;D("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=u.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);u.ns=u.ns.insert(h,g)}}})}(r.localStore,s))})}function GQ(t,e){return _(this,null,function*(){let n=N(t);if(!n.currentUser.isEqual(e)){D("SyncEngine","User change. New user:",e.toKey());let r=yield pV(n.localStore,e);n.currentUser=e,function(s,o){s.Ma.forEach(a=>{a.forEach(l=>{l.reject(new I(v.CANCELLED,o))})}),s.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield vi(n,r.us)}})}function WQ(t,e){let n=N(t),r=n.Ca.get(e);if(r&&r.pa)return te().add(r.key);{let i=te(),s=n.Sa.get(e);if(!s)return i;for(let o of s){let a=n.wa.get(o);i=i.unionWith(a.view.Ia)}return i}}function KQ(t,e){return _(this,null,function*(){let n=N(t),r=yield Jm(n.localStore,e.query,!0),i=e.view.fa(r);return n.isPrimaryClient&&IT(n,e.targetId,i.Va),i})}function QQ(t,e){return _(this,null,function*(){let n=N(t);return _V(n.localStore,e).then(r=>vi(n,r))})}function YQ(t,e,n,r){return _(this,null,function*(){let i=N(t),s=yield function(a,l){let c=N(a),u=N(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>u.vn(d,l).next(h=>h?c.localDocuments.getDocuments(d,h):y.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Hl(i.remoteStore):n==="acknowledged"||n==="rejected"?(cb(i,e,r||null),lb(i,e),function(a,l){N(N(a).mutationQueue).Mn(l)}(i.localStore,e)):O(),yield vi(i,s)):D("SyncEngine","Cannot apply mutation batch with id: "+e)})}function XQ(t,e){return _(this,null,function*(){let n=N(t);if(Dy(n),db(n),e===!0&&n.Oa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield nL(n,r.toArray());n.Oa=!0,yield hT(n.remoteStore,!0);for(let s of i)Cy(n.remoteStore,s)}else if(e===!1&&n.Oa!==!1){let r=[],i=Promise.resolve();n.Sa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ll(n,o),kl(n.localStore,o,!0))),Ol(n.remoteStore,o)}),yield i,yield nL(n,r),function(o){let a=N(o);a.Ca.forEach((l,c)=>{Ol(a.remoteStore,c)}),a.va.mr(),a.Ca=new Map,a.Da=new Le(R.comparator)}(n),n.Oa=!1,yield hT(n.remoteStore,!1)}})}function nL(t,e,n){return _(this,null,function*(){let r=N(t),i=[],s=[];for(let o of e){let a,l=r.Sa.get(o);if(l&&l.length!==0){a=yield Pl(r.localStore,rn(l[0]));for(let c of l){let u=r.wa.get(c),d=yield KQ(r,u);d.snapshot&&s.push(d.snapshot)}}else{let c=yield yV(r.localStore,o);a=yield Pl(r.localStore,c),yield ab(r,RV(c),o,!1,a.resumeToken)}i.push(a)}return r.ya.u_(s),i})}function RV(t){return xL(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ZQ(t){return function(n){return N(N(n).persistence).Bi()}(N(t).localStore)}function JQ(t,e,n,r){return _(this,null,function*(){let i=N(t);if(i.Oa)return void D("SyncEngine","Ignoring unexpected query state notification.");let s=i.Sa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield _V(i.localStore,ML(s[0])),a=Ld.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Tt.EMPTY_BYTE_STRING);yield vi(i,o,a);break}case"rejected":yield kl(i.localStore,e,!0),Ll(i,e,r);break;default:O()}})}function e7(t,e,n){return _(this,null,function*(){let r=Dy(t);if(r.Oa){for(let i of e){if(r.Sa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){D("SyncEngine","Adding an already active target "+i);continue}let s=yield yV(r.localStore,i),o=yield Pl(r.localStore,s);yield ab(r,RV(s),o.targetId,!1,o.resumeToken),Cy(r.remoteStore,o)}for(let i of n)r.Sa.has(i)&&(yield kl(r.localStore,i,!1).then(()=>{Ol(r.remoteStore,i),Ll(r,i)}).catch(Cs))}})}function Dy(t){let e=N(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=AV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=WQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BQ.bind(null,e),e.ya.u_=kQ.bind(null,e.eventManager),e.ya.La=OQ.bind(null,e.eventManager),e}function db(t){let e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$Q.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qQ.bind(null,e),e}function t7(t,e,n){let r=N(t);(function(s,o,a){return _(this,null,function*(){try{let l=yield o.getMetadata();if(yield function(f,p){let g=N(f),m=rt(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",w=>g.$r.getBundleMetadata(w,p.id)).then(w=>!!w&&w.createTime.compareTo(m)>=0)}(s.localStore,l))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(bV(l));let c=new _T(l,s.localStore,o.serializer),u=yield o.Ba();for(;u;){let h=yield c.sa(u);h&&a._updateProgress(h),u=yield o.Ba()}let d=yield c.complete();return yield vi(s,d.aa,void 0),yield function(f,p){let g=N(f);return g.persistence.runTransaction("Save bundle","readwrite",m=>g.$r.saveBundleMetadata(m,p))}(s.localStore,l),a._completeWith(d.progress),Promise.resolve(d._a)}catch(l){return Ln("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Gd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){this.serializer=eh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return fV(this.persistence,new Zm,e.initialUser,this.serializer)}createPersistence(e){return new Ym(Xm.Hr,this.serializer)}createSharedClientState(e){return new ny}terminate(){return _(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var hy=class t extends Gd{constructor(e,n,r){super(),this.ka=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){yield Wy(t.prototype,this,"initialize").call(this,e),yield this.ka.initialize(this,e),yield db(this.ka.syncEngine),yield Hl(this.ka.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return fV(this.persistence,new Zm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new jD(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new rD(n,this.persistence);return new nD(e.asyncQueue,r)}createPersistence(e){let n=eb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new JD(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,wV(),Dm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new ny}},CT=class t extends hy{constructor(e,n){super(e,n,!1),this.ka=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return _(this,null,function*(){yield Wy(t.prototype,this,"initialize").call(this,e);let n=this.ka.syncEngine;this.sharedClientState instanceof Sd&&(this.sharedClientState.syncEngine={Zs:YQ.bind(null,n),Xs:JQ.bind(null,n),eo:e7.bind(null,n),Bi:ZQ.bind(null,n),Ys:QQ.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>_(this,null,function*(){yield XQ(this.ka.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=wV();if(!Sd.D(n))throw new I(v.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=eb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Sd(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Wd=class{initialize(e,n){return _(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>tL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=GQ.bind(null,this.syncEngine),yield hT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new gT}()}createDatastore(e){let n=eh(e.databaseInfo.databaseId),r=function(s){return new oT(s)}(e.databaseInfo);return function(s,o,a,l){return new cT(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new dT(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>tL(this.syncEngine,n,0),function(){return ry.D()?new ry:new iT}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,u){let d=new ET(i,s,o,a,l,c);return u&&(d.Oa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return _(this,null,function*(){var e;yield function(r){return _(this,null,function*(){let i=N(r);D("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield ql(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function rL(t,e=10240){let n=0;return{read(){return _(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return _(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Vl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):tt("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var DT=class{constructor(e,n){this.Ka=e,this.serializer=n,this.metadata=new ht,this.buffer=new Uint8Array,this.$a=function(){return new TextDecoder("utf-8")}(),this.Ua().then(r=>{r&&r.ra()?this.metadata.resolve(r.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.na)}`))},r=>this.metadata.reject(r))}close(){return this.Ka.cancel()}getMetadata(){return _(this,null,function*(){return this.metadata.promise})}Ba(){return _(this,null,function*(){return yield this.getMetadata(),this.Ua()})}Ua(){return _(this,null,function*(){let e=yield this.Wa();if(e===null)return null;let n=this.$a.decode(e),r=Number(n);isNaN(r)&&this.Ga(`length string (${n}) is not valid number`);let i=yield this.za(r);return new yT(JSON.parse(i),e.length+r)})}ja(){return this.buffer.findIndex(e=>e===123)}Wa(){return _(this,null,function*(){for(;this.ja()<0&&!(yield this.Ha()););if(this.buffer.length===0)return null;let e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}za(e){return _(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ha())&&this.Ga("Reached the end of bundle when more is expected.");let n=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ha(){return _(this,null,function*(){let e=yield this.Ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var TT=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new I(v.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return _(this,null,function*(){let o=N(i),a={documents:s.map(d=>jd(o.serializer,d))},l=yield o.vo("BatchGetDocuments",o.serializer.databaseId,ge.emptyPath(),a,s.length),c=new Map;l.forEach(d=>{let h=aQ(o.serializer,d);c.set(h.key.toString(),h)});let u=[];return s.forEach(d=>{let h=c.get(d.toString());U(!!h),u.push(h)}),u})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Es(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=R.fromPath(r);this.mutations.push(new kd(i,this.precondition(i)))}),yield function(r,i){return _(this,null,function*(){let s=N(r),o={writes:i.map(a=>Ud(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,ge.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw O();n=q.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new I(v.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(q.min())?Qe.exists(!1):Qe.updateTime(n):Qe.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(q.min()))throw new I(v.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qe.updateTime(n)}return Qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var bT=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ja=r.maxAttempts,this.jo=new Hd(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo(()=>_(this,null,function*(){let e=new TT(this.datastore),n=this.Xa(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.eu(i)}))}).catch(r=>{this.eu(r)})}))}Xa(e){try{let n=this.updateFunction(e);return!Yd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget(()=>(this.Za(),Promise.resolve()))):this.deferred.reject(e)}tu(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!zL(n)}return!1}};var ST=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=dt.UNAUTHENTICATED,this.clientId=Sm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>_(this,null,function*(){D("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(D("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(v.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ht;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Gl(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Tm(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),D("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>_(this,null,function*(){r.isEqual(i)||(yield pV(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function AT(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield hb(t);D("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>JF(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>JF(e.remoteStore,i)),t._onlineComponents=e})}function MV(t){return t.name==="FirebaseError"?t.code===v.FAILED_PRECONDITION||t.code===v.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function hb(t){return _(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){D("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Tm(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!MV(n))throw n;Ln("Error using user provided cache. Falling back to memory cache: "+n),yield Tm(t,new Gd)}}else D("FirestoreClient","Using default OfflineComponentProvider"),yield Tm(t,new Gd);return t._offlineComponents})}function Ty(t){return _(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(D("FirestoreClient","Using user provided OnlineComponentProvider"),yield AT(t,t._uninitializedComponentsProvider._online)):(D("FirestoreClient","Using default OnlineComponentProvider"),yield AT(t,new Wd))),t._onlineComponents})}function NV(t){return hb(t).then(e=>e.persistence)}function fb(t){return hb(t).then(e=>e.localStore)}function PV(t){return Ty(t).then(e=>e.remoteStore)}function pb(t){return Ty(t).then(e=>e.syncEngine)}function n7(t){return Ty(t).then(e=>e.datastore)}function jl(t){return _(this,null,function*(){let e=yield Ty(t),n=e.eventManager;return n.onListen=FQ.bind(null,e.syncEngine),n.onUnlisten=VQ.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=LQ.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=jQ.bind(null,e.syncEngine),n})}function r7(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield NV(t),n=yield PV(t);return e.setNetworkEnabled(!0),function(i){let s=N(i);return s.v_.delete(0),th(s)}(n)}))}function i7(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield NV(t),n=yield PV(t);return e.setNetworkEnabled(!1),function(i){return _(this,null,function*(){let s=N(i);s.v_.add(0),yield ql(s),s.x_.set("Offline")})}(n)}))}function s7(t,e){let n=new ht;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield function(c,u){let d=N(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,u))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new I(v.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let l=Gl(a,`Failed to get document '${s} from cache`);o.reject(l)}})}(yield fb(t),e,n)})),n.promise}function kV(t,e,n={}){let r=new ht;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,l,c){let u=new Vl({next:h=>{o.enqueueAndForget(()=>sb(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new I(v.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&l&&l.source==="server"?c.reject(new I(v.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new zd($l(a.path),u,{includeMetadataChanges:!0,ta:!0});return ib(s,d)}(yield jl(t),t.asyncQueue,e,n,r)})),r.promise}function o7(t,e){let n=new ht;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield Jm(i,s,!0),l=new dy(s,a.hs),c=l.Ta(a.documents),u=l.applyChanges(c,!1);o.resolve(u.snapshot)}catch(a){let l=Gl(a,`Failed to execute query '${s} against cache`);o.reject(l)}})}(yield fb(t),e,n)})),n.promise}function OV(t,e,n={}){let r=new ht;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,l,c){let u=new Vl({next:h=>{o.enqueueAndForget(()=>sb(s,d)),h.fromCache&&l.source==="server"?c.reject(new I(v.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new zd(a,u,{includeMetadataChanges:!0,ta:!0});return ib(s,d)}(yield jl(t),t.asyncQueue,e,n,r)})),r.promise}function a7(t,e){let n=new Vl(e);return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){N(i).W_.add(s),s.next()}(yield jl(t),n)})),()=>{n.Qa(),t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){N(i).W_.delete(s)}(yield jl(t),n)}))}}function l7(t,e,n,r){let i=function(o,a){let l;return l=typeof o=="string"?WL().encode(o):o,function(u,d){return new DT(u,d)}(function(u,d){if(u instanceof Uint8Array)return rL(u,d);if(u instanceof ArrayBuffer)return rL(new Uint8Array(u),d);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,eh(e));t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){t7(yield pb(t),i,r)}))}function c7(t,e){return t.asyncQueue.enqueue(()=>_(this,null,function*(){return function(r,i){let s=N(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield fb(t),e)}))}function FV(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var iL=new Map;function gb(t,e,n){if(!n)throw new I(v.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function mb(t,e,n,r){if(e===!0&&r===!0)throw new I(v.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function sL(t){if(!R.isDocumentKey(t))throw new I(v.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function oL(t){if(R.isDocumentKey(t))throw new I(v.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function by(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":O()}function me(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(v.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=by(t);throw new I(v.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function LV(t,e){if(e<=0)throw new I(v.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var fy=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(v.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(v.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FV((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},xo=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fy({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(v.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(v.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new G0;switch(r.type){case"firstParty":return new Y0(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(v.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=iL.get(n);r&&(D("ComponentProvider","Removing Datastore"),iL.delete(n),r.terminate())}(this),Promise.resolve()}};function VV(t,e,n,r={}){var i;let s=(t=me(t,xo))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ln("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=dt.MOCK_USER;else{a=Bo(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new I(v.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new dt(c)}t._authCredentials=new W0(new bm(a,l))}}var Ft=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Ne=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Vr=class t extends Ft{constructor(e,n,r){super(e,n,$l(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ne(this.firestore,null,new R(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function yb(t,e,...n){if(t=W(t),gb("collection","path",e),t instanceof xo){let r=ge.fromString(e,...n);return oL(r),new Vr(t,null,r)}{if(!(t instanceof Ne||t instanceof Vr))throw new I(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ge.fromString(e,...n));return oL(r),new Vr(t.firestore,null,r)}}function jV(t,e){if(t=me(t,xo),gb("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new I(v.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ft(t,null,function(r){return new rr(ge.emptyPath(),r)}(e))}function nh(t,e,...n){if(t=W(t),arguments.length===1&&(e=Sm.newId()),gb("doc","path",e),t instanceof xo){let r=ge.fromString(e,...n);return sL(r),new Ne(t,null,new R(r))}{if(!(t instanceof Ne||t instanceof Vr))throw new I(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ge.fromString(e,...n));return sL(r),new Ne(t.firestore,t instanceof Vr?t.converter:null,new R(r))}}function _b(t,e){return t=W(t),e=W(e),(t instanceof Ne||t instanceof Vr)&&(e instanceof Ne||e instanceof Vr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function vb(t,e){return t=W(t),e=W(e),t instanceof Ft&&e instanceof Ft&&t.firestore===e.firestore&&Zd(t._query,e._query)&&t.converter===e.converter}var xT=class{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new Hd(this,"async_queue_retry"),this.cu=()=>{let n=Dm();n&&D("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Dm();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;let n=Dm();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise(()=>{});let n=new ht;return this.hu(()=>this.iu&&this.au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ru.push(e),this.Pu()))}Pu(){return _(this,null,function*(){if(this.ru.length!==0){try{yield this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Ds(e))throw e;D("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo(()=>this.Pu())}})}hu(e){let n=this.nu.then(()=>(this._u=!0,e().catch(r=>{this.ou=r,this._u=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw tt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this._u=!1,r))));return this.nu=n,n}enqueueAfterDelay(e,n,r){this.lu(),this.uu.indexOf(e)>-1&&(n=0);let i=fT.createAndSchedule(this,e,n,r,s=>this.Iu(s));return this.su.push(i),i}lu(){this.ou&&O()}verifyOperationInProgress(){}Tu(){return _(this,null,function*(){let e;do e=this.nu,yield e;while(e!==this.nu)})}Eu(e){for(let n of this.su)if(n.timerId===e)return!0;return!1}du(e){return this.Tu().then(()=>{this.su.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.su)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tu()})}Au(e){this.uu.push(e)}Iu(e){let n=this.su.indexOf(e);this.su.splice(n,1)}};function RT(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var MT=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ht,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var UV=-1,Be=class extends xo{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new xT}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||BV(this),this._firestoreClient.terminate()}};function mt(t){return t._firestoreClient||BV(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function BV(t){var e,n,r;let i=t._freezeSettings(),s=function(a,l,c,u){return new iD(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,FV(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new ST(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function $V(t,e){XV(t=me(t,Be));let n=mt(t);if(n._uninitializedComponentsProvider)throw new I(v.FAILED_PRECONDITION,"SDK cache is already specified.");Ln("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Wd;return HV(n,i,new hy(i,r.cacheSizeBytes,e?.forceOwnership))}function qV(t){XV(t=me(t,Be));let e=mt(t);if(e._uninitializedComponentsProvider)throw new I(v.FAILED_PRECONDITION,"SDK cache is already specified.");Ln("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Wd;return HV(e,r,new CT(r,n.cacheSizeBytes))}function HV(t,e,n){let r=new ht;return t.asyncQueue.enqueue(()=>_(this,null,function*(){try{yield Tm(t,n),yield AT(t,e),r.resolve()}catch(i){let s=i;if(!MV(s))throw s;Ln("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function zV(t){if(t._initialized&&!t._terminated)throw new I(v.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ht;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{yield function(r){return _(this,null,function*(){if(!pi.D())return Promise.resolve();let i=r+"main";yield pi.delete(i)})}(eb(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function GV(t){return function(n){let r=new ht;return n.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return HQ(yield pb(n),r)})),r.promise}(mt(t=me(t,Be)))}function WV(t){return r7(mt(t=me(t,Be)))}function KV(t){return i7(mt(t=me(t,Be)))}function QV(t,e){let n=mt(t=me(t,Be)),r=new MT;return l7(n,t._databaseId,e,r),r}function YV(t,e){return c7(mt(t=me(t,Be)),e).then(n=>n?new Ft(t,null,n.query):null)}function XV(t){if(t._initialized||t._terminated)throw new I(v.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var $r=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Tt.fromBase64String(e))}catch(n){throw new I(v.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var sr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(v.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var yi=class{constructor(e){this._methodName=e}};var Ro=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(v.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(v.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var u7=/^__.*__$/,NT=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ir(e,this.data,this.fieldMask,n,this.fieldTransforms):new ws(e,this.data,n,this.fieldTransforms)}},py=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ir(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function ZV(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O()}}var gy=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.pu(e),i}yu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.Ru(),i}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return my(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(e.length===0)throw this.Su("Document fields must not be empty");if(ZV(this.Vu)&&u7.test(e))throw this.Su('Document fields cannot begin and end with "__"')}},PT=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||eh(e)}Cu(e,n,r,i=!1){return new gy({Vu:e,methodName:n,Du:r,path:nt.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ko(t){let e=t._freezeSettings(),n=eh(t._databaseId);return new PT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Sy(t,e,n,r,i,s={}){let o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);Ib("Data must be an object, but it was:",o,r);let a=t2(r,o),l,c;if(s.merge)l=new Cn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let d of s.mergeFields){let h=VT(e,d,n);if(!o.contains(h))throw new I(v.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);r2(u,h)||u.push(h)}l=new Cn(u),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new NT(new zt(a),l,c)}var Kd=class t extends yi{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function JV(t,e,n){return new gy({Vu:3,Du:e.settings.Du,methodName:t._methodName,gu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var kT=class t extends yi{_toFieldTransform(e){return new bo(e.path,new _s)}isEqual(e){return e instanceof t}},OT=class t extends yi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=JV(this,e,!0),r=this.vu.map(s=>Oo(s,n)),i=new gi(r);return new bo(e.path,i)}isEqual(e){return e instanceof t&&Yy(this.vu,e.vu)}},FT=class t extends yi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=JV(this,e,!0),r=this.vu.map(s=>Oo(s,n)),i=new mi(r);return new bo(e.path,i)}isEqual(e){return e instanceof t&&Yy(this.vu,e.vu)}},LT=class t extends yi{constructor(e,n){super(e),this.Fu=n}_toFieldTransform(e){let n=new vs(e.serializer,VL(e.serializer,this.Fu));return new bo(e.path,n)}isEqual(e){return e instanceof t&&this.Fu===e.Fu}};function wb(t,e,n,r){let i=t.Cu(1,e,n);Ib("Data must be an object, but it was:",i,r);let s=[],o=zt.empty();Po(r,(l,c)=>{let u=Cb(e,l,n);c=W(c);let d=i.yu(u);if(c instanceof Kd)s.push(u);else{let h=Oo(c,d);h!=null&&(s.push(u),o.set(u,h))}});let a=new Cn(s);return new py(o,a,i.fieldTransforms)}function Eb(t,e,n,r,i,s){let o=t.Cu(1,e,n),a=[VT(e,r,n)],l=[i];if(s.length%2!=0)throw new I(v.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(VT(e,s[h])),l.push(s[h+1]);let c=[],u=zt.empty();for(let h=a.length-1;h>=0;--h)if(!r2(c,a[h])){let f=a[h],p=l[h];p=W(p);let g=o.yu(f);if(p instanceof Kd)c.push(f);else{let m=Oo(p,g);m!=null&&(c.push(f),u.set(f,m))}}let d=new Cn(c);return new py(u,d,o.fieldTransforms)}function e2(t,e,n,r=!1){return Oo(n,t.Cu(r?4:3,e))}function Oo(t,e){if(n2(t=W(t)))return Ib("Unsupported field value:",e,t),t2(t,e);if(t instanceof yi)return function(r,i){if(!ZV(i.Vu))throw i.Su(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Su(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&e.Vu!==4)throw e.Su("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let l=Oo(a,i.wu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=W(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ze.fromDate(r);return{timestampValue:Rl(i.serializer,s)}}if(r instanceof ze){let s=new ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Rl(i.serializer,s)}}if(r instanceof Ro)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $r)return{bytesValue:KL(i.serializer,r._byteString)};if(r instanceof Ne){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Su(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:XT(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Su(`Unsupported field value: ${by(r)}`)}(t,e)}function t2(t,e){let n={};return wL(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Po(t,(r,i)=>{let s=Oo(i,e.fu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function n2(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ze||t instanceof Ro||t instanceof $r||t instanceof Ne||t instanceof yi)}function Ib(t,e,n){if(!n2(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=by(n);throw r==="an object"?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function VT(t,e,n){if((e=W(e))instanceof sr)return e._internalPath;if(typeof e=="string")return Cb(t,e);throw my("Field path arguments must be of type string or ",t,!1,void 0,n)}var d7=new RegExp("[~\\*/\\[\\]]");function Cb(t,e,n){if(e.search(d7)>=0)throw my(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new sr(...e.split("."))._internalPath}catch{throw my(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function my(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new I(v.INVALID_ARGUMENT,a+t+l)}function r2(t,e){return t.some(n=>n.isEqual(e))}var Mo=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new jT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Ay("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},jT=class extends Mo{data(){return super.data()}};function Ay(t,e){return typeof e=="string"?Cb(t,e):e instanceof sr?e._internalPath:e._delegate._internalPath}function i2(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new I(v.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Qd=class{},No=class extends Qd{};function wi(t,e,...n){let r=[];e instanceof Qd&&r.push(e),r=r.concat(n),function(s){let o=s.filter(l=>l instanceof UT).length,a=s.filter(l=>l instanceof yy).length;if(o>1||o>0&&a>0)throw new I(v.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var yy=class t extends No{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return p2(e._query,n),new Ft(e.firestore,e.converter,yD(e._query,n))}_parse(e){let n=ko(e.firestore);return function(s,o,a,l,c,u,d){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new I(v.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){lL(d,u);let f=[];for(let p of d)f.push(aL(l,s,p));h={arrayValue:{values:f}}}else h=aL(l,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||lL(d,u),h=e2(a,o,d,u==="in"||u==="not-in");return de.create(c,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function s2(t,e,n){let r=e,i=Ay("where",t);return yy._create(i,r,n)}var UT=class t extends Qd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Te.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let l of a)p2(o,l),o=yD(o,l)}(e._query,n),new Ft(e.firestore,e.converter,yD(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var BT=class t extends No{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new I(v.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new I(v.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Do(s,o)}(e._query,this._field,this._direction);return new Ft(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new rr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function o2(t,e="asc"){let n=e,r=Ay("orderBy",t);return BT._create(r,n)}var _y=class t extends No{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Ft(e.firestore,e.converter,Lm(e._query,this._limit,this._limitType))}};function a2(t){return LV("limit",t),_y._create("limit",t,"F")}function l2(t){return LV("limitToLast",t),_y._create("limitToLast",t,"L")}var vy=class t extends No{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=f2(e,this.type,this._docOrFields,this._inclusive);return new Ft(e.firestore,e.converter,function(i,s){return new rr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function c2(...t){return vy._create("startAt",t,!0)}function u2(...t){return vy._create("startAfter",t,!1)}var wy=class t extends No{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=f2(e,this.type,this._docOrFields,this._inclusive);return new Ft(e.firestore,e.converter,function(i,s){return new rr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function d2(...t){return wy._create("endBefore",t,!1)}function h2(...t){return wy._create("endAt",t,!0)}function f2(t,e,n,r){if(n[0]=W(n[0]),n[0]instanceof Mo)return function(s,o,a,l,c){if(!l)throw new I(v.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let u=[];for(let d of Il(s))if(d.field.isKeyField())u.push(Co(o,l.key));else{let h=l.data.field(d.field);if(Iy(h))throw new I(v.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new I(v.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(h)}return new Ur(u,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=ko(t.firestore);return function(o,a,l,c,u,d){let h=o.explicitOrderBy;if(u.length>h.length)throw new I(v.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<u.length;p++){let g=u[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new I(v.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!QT(o)&&g.indexOf("/")!==-1)throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let m=o.path.child(ge.fromString(g));if(!R.isDocumentKey(m))throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${m}' is not because it contains an odd number of segments.`);let w=new R(m);f.push(Co(a,w))}else{let m=e2(l,c,g);f.push(m)}}return new Ur(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function aL(t,e,n){if(typeof(n=W(n))=="string"){if(n==="")throw new I(v.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!QT(e)&&n.indexOf("/")!==-1)throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ge.fromString(n));if(!R.isDocumentKey(r))throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Co(t,new R(r))}if(n instanceof Ne)return Co(t,n._key);throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${by(n)}.`)}function lL(t,e){if(!Array.isArray(t)||t.length===0)throw new I(v.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function p2(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new I(v.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new I(v.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Ul=class{convertValue(e,n="none"){switch(Io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(gs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw O()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Po(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Ro(Ke(e.latitude),Ke(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=WT(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Md(e));default:return null}}convertTimestamp(e){let n=ps(e);return new ze(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ge.fromString(e);U(sV(r));let i=new ms(r.get(1),r.get(3)),s=new R(r.popFirst(5));return i.isEqual(n)||tt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function xy(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var $T=class extends Ul{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,n)}};var fi=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},jn=class extends Mo{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new hs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Ay("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},hs=class extends jn{data(e={}){return super.data(e)}},or=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new fi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new hs(this._firestore,this._userDataWriter,r.key,r,new fi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new I(v.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let l=new hs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new fi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let l=new hs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new fi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:h7(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function h7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O()}}function Db(t,e){return t instanceof jn&&e instanceof jn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof or&&e instanceof or&&t._firestore===e._firestore&&vb(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function g2(t){t=me(t,Ne);let e=me(t.firestore,Be);return kV(mt(e),t._key).then(n=>Ab(e,t,n))}var _i=class extends Ul{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,n)}};function m2(t){t=me(t,Ne);let e=me(t.firestore,Be),n=mt(e),r=new _i(e);return s7(n,t._key).then(i=>new jn(e,r,t._key,i,new fi(i!==null&&i.hasLocalMutations,!0),t.converter))}function y2(t){t=me(t,Ne);let e=me(t.firestore,Be);return kV(mt(e),t._key,{source:"server"}).then(n=>Ab(e,t,n))}function _2(t){t=me(t,Ft);let e=me(t.firestore,Be),n=mt(e),r=new _i(e);return i2(t._query),OV(n,t._query).then(i=>new or(e,r,t,i))}function v2(t){t=me(t,Ft);let e=me(t.firestore,Be),n=mt(e),r=new _i(e);return o7(n,t._query).then(i=>new or(e,r,t,i))}function w2(t){t=me(t,Ft);let e=me(t.firestore,Be),n=mt(e),r=new _i(e);return OV(n,t._query,{source:"server"}).then(i=>new or(e,r,t,i))}function Tb(t,e,n){t=me(t,Ne);let r=me(t.firestore,Be),i=xy(t.converter,e,n);return Wl(r,[Sy(ko(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Qe.none())])}function bb(t,e,n,...r){t=me(t,Ne);let i=me(t.firestore,Be),s=ko(i),o;return o=typeof(e=W(e))=="string"||e instanceof sr?Eb(s,"updateDoc",t._key,e,n,r):wb(s,"updateDoc",t._key,e),Wl(i,[o.toMutation(t._key,Qe.exists(!0))])}function E2(t){return Wl(me(t.firestore,Be),[new Es(t._key,Qe.none())])}function I2(t,e){let n=me(t.firestore,Be),r=nh(t),i=xy(t.converter,e);return Wl(n,[Sy(ko(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Qe.exists(!1))]).then(()=>r)}function Sb(t,...e){var n,r,i;t=W(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||RT(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(RT(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let l,c,u;if(t instanceof Ne)c=me(t.firestore,Be),u=$l(t._key.path),l={next:d=>{e[o]&&e[o](Ab(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=me(t,Ft);c=me(d.firestore,Be),u=d._query;let h=new _i(c);l={next:f=>{e[o]&&e[o](new or(c,h,d,f))},error:e[o+1],complete:e[o+2]},i2(t._query)}return function(h,f,p,g){let m=new Vl(g),w=new zd(f,m,p);return h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return ib(yield jl(h),w)})),()=>{m.Qa(),h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return sb(yield jl(h),w)}))}}(mt(c),u,a,l)}function C2(t,e){return a7(mt(t=me(t,Be)),RT(e)?e:{next:e})}function Wl(t,e){return function(r,i){let s=new ht;return r.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return UQ(yield pb(r),i,s)})),s.promise}(mt(t),e)}function Ab(t,e,n){let r=n.docs.get(e._key),i=new _i(t);return new jn(t,i,e._key,r,new fi(n.hasPendingWrites,n.fromCache),e.converter)}var f7={maxAttempts:5};var Ey=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ko(e)}set(e,n,r){this._verifyNotCommitted();let i=us(e,this._firestore),s=xy(i.converter,n,r),o=Sy(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Qe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=us(e,this._firestore),o;return o=typeof(n=W(n))=="string"||n instanceof sr?Eb(this._dataReader,"WriteBatch.update",s._key,n,r,i):wb(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Qe.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=us(e,this._firestore);return this._mutations=this._mutations.concat(new Es(n._key,Qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new I(v.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function us(t,e){if((t=W(t)).firestore!==e)throw new I(v.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var qT=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=ko(n)}get(n){let r=us(n,this._firestore),i=new $T(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return O();let o=s[0];if(o.isFoundDocument())return new Mo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Mo(this._firestore,i,r._key,null,r.converter);throw O()})}set(n,r,i){let s=us(n,this._firestore),o=xy(s.converter,r,i),a=Sy(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=us(n,this._firestore),a;return a=typeof(r=W(r))=="string"||r instanceof sr?Eb(this._dataReader,"Transaction.update",o._key,r,i,s):wb(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=us(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=us(e,this._firestore),r=new _i(this._firestore);return super.get(e).then(i=>new jn(this._firestore,r,n._key,i._document,new fi(!1,!1),n.converter))}};function D2(t,e,n){t=me(t,Be);let r=Object.assign(Object.assign({},f7),n);return function(s){if(s.maxAttempts<1)throw new I(v.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let l=new ht;return s.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){let c=yield n7(s);new bT(s.asyncQueue,c,a,o,l).Ya()})),l.promise}(mt(t),i=>e(new qT(t,i)),r)}function T2(){return new Kd("deleteField")}function b2(){return new kT("serverTimestamp")}function S2(...t){return new OT("arrayUnion",t)}function A2(...t){return new FT("arrayRemove",t)}function x2(t){return new LT("increment",t)}(function(e,n=!0){(function(i){Bl=i})($o),Hr(new St("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Be(new K0(r.getProvider("auth-internal")),new Z0(r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new I(v.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ms(c.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),an(cF,"4.5.0",e),an(cF,"4.5.0","esm2017")})();var p7="@firebase/firestore-compat",g7="0.3.27";function kb(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new I("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function R2(){if(typeof Uint8Array>"u")throw new I("unimplemented","Uint8Arrays are not available in this environment.")}function M2(){if(!EL())throw new I("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Ry=class t{constructor(e){this._delegate=e}static fromBase64String(e){return M2(),new t($r.fromBase64String(e))}static fromUint8Array(e){return R2(),new t($r.fromUint8Array(e))}toBase64(){return M2(),this._delegate.toBase64()}toUint8Array(){return R2(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function xb(t){return m7(t,["next","error","complete"])}function m7(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var Rb=class{enableIndexedDbPersistence(e,n){return $V(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return qV(e._delegate)}clearIndexedDbPersistence(e){return zV(e._delegate)}},My=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ms||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ln("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){VV(this._delegate,e,n,r)}enableNetwork(){return WV(this._delegate)}disableNetwork(){return KV(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,mb("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return GV(this._delegate)}onSnapshotsInSync(e){return C2(this._delegate,e)}get app(){if(!this._appCompat)throw new I("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Yl(this,yb(this._delegate,e))}catch(n){throw sn(n,"collection()","Firestore.collection()")}}doc(e){try{return new qr(this,nh(this._delegate,e))}catch(n){throw sn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new jo(this,jV(this._delegate,e))}catch(n){throw sn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return D2(this._delegate,n=>e(new Ny(this,n)))}batch(){return mt(this._delegate),new Py(new Ey(this._delegate,e=>Wl(this._delegate,e)))}loadBundle(e){return QV(this._delegate,e)}namedQuery(e){return YV(this._delegate,e).then(n=>n?new jo(this,n):null)}},Kl=class extends Ul{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ry(new $r(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return qr.forKey(n,this.firestore,null)}};function y7(t){cL(t)}var Ny=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Kl(e)}get(e){let n=Fo(e);return this._delegate.get(n).then(r=>new Lo(this._firestore,new jn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Fo(e);return r?(kb("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Fo(e);return this._delegate.delete(n),this}},Py=class{constructor(e){this._delegate=e}set(e,n,r){let i=Fo(e);return r?(kb("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Fo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},Ql=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new hs(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Vo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new Kl(e),n),i.set(n,s)),s}};Ql.INSTANCES=new WeakMap;var qr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Kl(e)}static forPath(e,n,r){if(e.length%2!==0)throw new I("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Ne(n._delegate,r,new R(e)))}static forKey(e,n,r){return new t(n,new Ne(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Yl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Yl(this.firestore,yb(this._delegate,e))}catch(n){throw sn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=W(e),e instanceof Ne?_b(this._delegate,e):!1}set(e,n){n=kb("DocumentReference.set",n);try{return n?Tb(this._delegate,e,n):Tb(this._delegate,e)}catch(r){throw sn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?bb(this._delegate,e):bb(this._delegate,e,n,...r)}catch(i){throw sn(i,"updateDoc()","DocumentReference.update()")}}delete(){return E2(this._delegate)}onSnapshot(...e){let n=N2(e),r=P2(e,i=>new Lo(this.firestore,new jn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Sb(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=m2(this._delegate):e?.source==="server"?n=y2(this._delegate):n=g2(this._delegate),n.then(r=>new Lo(this.firestore,new jn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Ql.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function sn(t,e,n){return t.message=t.message.replace(e,n),t}function N2(t){for(let e of t)if(typeof e=="object"&&!xb(e))return e;return{}}function P2(t,e){var n,r;let i;return xb(t[0])?i=t[0]:xb(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Lo=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new qr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Db(this._delegate,e._delegate)}},Vo=class extends Lo{data(e){let n=this._delegate.data(e);return this._delegate._converter||uL(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},jo=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Kl(e)}where(e,n,r){try{return new t(this.firestore,wi(this._delegate,s2(e,n,r)))}catch(i){throw sn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,wi(this._delegate,o2(e,n)))}catch(r){throw sn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,wi(this._delegate,a2(e)))}catch(n){throw sn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,wi(this._delegate,l2(e)))}catch(n){throw sn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,wi(this._delegate,c2(...e)))}catch(n){throw sn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,wi(this._delegate,u2(...e)))}catch(n){throw sn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,wi(this._delegate,d2(...e)))}catch(n){throw sn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,wi(this._delegate,h2(...e)))}catch(n){throw sn(n,"endAt()","Query.endAt()")}}isEqual(e){return vb(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=v2(this._delegate):e?.source==="server"?n=w2(this._delegate):n=_2(this._delegate),n.then(r=>new rh(this.firestore,new or(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=N2(e),r=P2(e,i=>new rh(this.firestore,new or(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Sb(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Ql.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Mb=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Vo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},rh=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new jo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Vo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Mb(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Vo(this._firestore,r))})}isEqual(e){return Db(this._delegate,e._delegate)}},Yl=class t extends jo{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new qr(this.firestore,e):null}doc(e){try{return e===void 0?new qr(this.firestore,nh(this._delegate)):new qr(this.firestore,nh(this._delegate,e))}catch(n){throw sn(n,"doc()","CollectionReference.doc()")}}add(e){return I2(this._delegate,e).then(n=>new qr(this.firestore,n))}isEqual(e){return _b(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Ql.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Fo(t){return me(t,Ne)}var Nb=class t{constructor(...e){this._delegate=new sr(...e)}static documentId(){return new t(nt.keyField().canonicalString())}isEqual(e){return e=W(e),e instanceof sr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Pb=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=b2();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=T2();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=S2(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=A2(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=x2(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var _7={Firestore:My,GeoPoint:Ro,Timestamp:ze,Blob:Ry,Transaction:Ny,WriteBatch:Py,DocumentReference:qr,DocumentSnapshot:Lo,Query:jo,QueryDocumentSnapshot:Vo,QuerySnapshot:rh,CollectionReference:Yl,FieldPath:Nb,FieldValue:Pb,setLogLevel:y7,CACHE_SIZE_UNLIMITED:UV};function v7(t,e){t.INTERNAL.registerComponent(new St("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},_7)))}function w7(t){v7(t,(e,n)=>new My(e,n,new Rb)),t.registerVersion(p7,g7)}w7(Ye);function E7(t,e=Gr){return new Z(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function k2(t,e){return E7(t,e)}function I7(t,e){return k2(t,e).pipe(Ms(void 0),oc(),F(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Lb(t,e){return k2(t,e).pipe(F(n=>({payload:n,type:"query"})))}var ky=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=L2(r,n);return new Fy(i,s,this.afs)}snapshotChanges(){return I7(this.ref,this.afs.schedulers.outsideAngular).pipe(Ve)}valueChanges(e={}){return this.snapshotChanges().pipe(F(({payload:n})=>e.idField?fe(M({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return re(this.ref.get(e)).pipe(Ve)}};function Oy(t,e){return Lb(t,e).pipe(Ms(void 0),oc(),F(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,l)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),u=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:a}})}),o}))}function O2(t,e,n){return Oy(t,n).pipe(cr((r,i)=>C7(r,i.map(s=>s.payload),e),[]),sc(),F(r=>r.map(i=>({type:i.type,payload:i}))))}function C7(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=D7(t,r))}),t}function Ob(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function D7(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Ob(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return Ob(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Ob(t,e.oldIndex,1);break}return t}function F2(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Fy=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Oy(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(F(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(Ms(void 0),oc(),gt(([r,i])=>i.length>0||!r),F(([,r])=>r),Ve)}auditTrail(e){return this.stateChanges(e).pipe(cr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=F2(e);return O2(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ve)}valueChanges(e={}){return Lb(this.query,this.afs.schedulers.outsideAngular).pipe(F(n=>n.payload.docs.map(r=>e.idField?fe(M({},r.data()),{[e.idField]:r.id}):r.data())),Ve)}get(e){return re(this.query.get(e)).pipe(Ve)}add(e){return this.ref.add(e)}doc(e){return new ky(this.ref.doc(e),this.afs)}},Fb=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Oy(this.query,this.afs.schedulers.outsideAngular).pipe(Ve):Oy(this.query,this.afs.schedulers.outsideAngular).pipe(F(n=>n.filter(r=>e.indexOf(r.type)>-1)),gt(n=>n.length>0),Ve)}auditTrail(e){return this.stateChanges(e).pipe(cr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=F2(e);return O2(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ve)}valueChanges(e={}){return Lb(this.query,this.afs.schedulers.outsideAngular).pipe(F(r=>r.payload.docs.map(i=>e.idField?M({[e.idField]:i.id},i.data()):i.data())),Ve)}get(e){return re(this.query.get(e)).pipe(Ve)}},T7=new x("angularfire2.enableFirestorePersistence"),b7=new x("angularfire2.firestore.persistenceSettings"),S7=new x("angularfire2.firestore.settings"),A7=new x("angularfire2.firestore.use-emulator");function L2(t,e=n=>n){return{query:e(t),ref:t}}var V2=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,l,c,u,d,h,f,p,g,m,w,S){this.schedulers=l;let C=ai(n,a,r),b=u;d&&$c(C,a,h,p,g,m,f,w),[this.firestore,this.persistenceEnabled$]=Bi(`${C.name}.firestore`,"AngularFirestore",C.name,()=>{let B=a.runOutsideAngular(()=>C.firestore());if(s&&B.settings(s),b&&B.useEmulator(...b),i&&!Gs(o)){let H=()=>{try{return re(B.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(ye){return typeof console<"u"&&console.warn(ye),L(!1)}};return[B,a.runOutsideAngular(H)]}else return[B,L(!1)]},[s,b,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=L2(i,r),a=this.schedulers.ngZone.run(()=>s);return new Fy(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new Fb(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new ky(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(E(vr),E(wr,8),E(T7,8),E(S7,8),E(lt),E(ie),E(Ui),E(b7,8),E(A7,8),E(vp,8),E(Fc,8),E(Lc,8),E(Vc,8),E(jc,8),E(Uc,8),E(Bc,8),E(Yn,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var j2=(()=>{let e=class e{constructor(r){this.firestore=r}getPokemones(){return this.firestore.collection("pokemones").snapshotChanges()}getGeneros(){return this.firestore.collection("generos").snapshotChanges()}createPokemon(r){return this.firestore.collection("pokemones").add(Object.assign({},r))}updatePokemon(r){this.firestore.doc("pokemones/"+r.id).update(r)}deletePokemon(r){this.firestore.doc("pokemones/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(E(V2))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Q2=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(se(ri),se(yr))},e.\u0275dir=et({type:e});let t=e;return t})(),qy=(()=>{let e=class e extends Q2{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ei(e)))(s||e)}})(),e.\u0275dir=et({type:e,features:[Rn]});let t=e;return t})(),lh=new x("");var M7={provide:lh,useExisting:mr(()=>Hy),multi:!0};function N7(){let t=_r()?_r().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var P7=new x(""),Hy=(()=>{let e=class e extends Q2{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!N7())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(se(ri),se(yr),se(P7,8))},e.\u0275dir=et({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Yt("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Fi([M7]),Rn]});let t=e;return t})();function k7(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}var jb=new x(""),Y2=new x("");function O7(t){return k7(t.value)?{required:!0}:null}function U2(t){return null}function X2(t){return t!=null}function Z2(t){return Hs(t)?re(t):t}function J2(t){let e={};return t.forEach(n=>{e=n!=null?M(M({},e),n):e}),Object.keys(e).length===0?null:e}function ej(t,e){return e.map(n=>n(t))}function F7(t){return!t.validate}function tj(t){return t.map(e=>F7(e)?e:n=>e.validate(n))}function L7(t){if(!t)return null;let e=t.filter(X2);return e.length==0?null:function(n){return J2(ej(n,e))}}function Ub(t){return t!=null?L7(tj(t)):null}function V7(t){if(!t)return null;let e=t.filter(X2);return e.length==0?null:function(n){let r=ej(n,e).map(Z2);return m_(r).pipe(F(J2))}}function Bb(t){return t!=null?V7(tj(t)):null}function B2(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function j7(t){return t._rawValidators}function U7(t){return t._rawAsyncValidators}function Vb(t){return t?Array.isArray(t)?t:[t]:[]}function Vy(t,e){return Array.isArray(t)?t.includes(e):t===e}function $2(t,e){let n=Vb(e);return Vb(t).forEach(i=>{Vy(n,i)||n.push(i)}),n}function q2(t,e){return Vb(e).filter(n=>!Vy(t,n))}var jy=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ub(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Bb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Zl=class extends jy{get formDirective(){return null}get path(){return null}},ah=class extends jy{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Uy=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},B7={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},nle=fe(M({},B7),{"[class.ng-submitted]":"isSubmitted"}),nj=(()=>{let e=class e extends Uy{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(se(ah,2))},e.\u0275dir=et({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Yf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Rn]});let t=e;return t})(),rj=(()=>{let e=class e extends Uy{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(se(Zl,10))},e.\u0275dir=et({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Yf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Rn]});let t=e;return t})();var ih="VALID",Ly="INVALID",Xl="PENDING",sh="DISABLED";function ij(t){return(zy(t)?t.validators:t)||null}function $7(t){return Array.isArray(t)?Ub(t):t||null}function sj(t,e){return(zy(e)?e.asyncValidators:t)||null}function q7(t){return Array.isArray(t)?Bb(t):t||null}function zy(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function H7(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new V(1e3,"");if(!r[n])throw new V(1001,"")}function z7(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new V(1002,"")})}var By=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===ih}get invalid(){return this.status===Ly}get pending(){return this.status==Xl}get disabled(){return this.status===sh}get enabled(){return this.status!==sh}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators($2(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators($2(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(q2(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(q2(e,this._rawAsyncValidators))}hasValidator(e){return Vy(this._rawValidators,e)}hasAsyncValidator(e){return Vy(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Xl,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=sh,this.errors=null,this._forEachChild(r=>{r.disable(fe(M({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(fe(M({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=ih,this._forEachChild(r=>{r.enable(fe(M({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(fe(M({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ih||this.status===Xl)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sh:ih}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Xl,this._hasOwnPendingAsyncValidator=!0;let n=Z2(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new at,this.statusChanges=new at}_calculateStatus(){return this._allControlsDisabled()?sh:this.errors?Ly:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Xl)?Xl:this._anyControlsHaveStatus(Ly)?Ly:ih}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){zy(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=$7(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=q7(this._rawAsyncValidators)}},$y=class extends By{constructor(e,n,r){super(ij(n),sj(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){z7(this,!0,e),Object.keys(e).forEach(r=>{H7(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var $b=new x("CallSetDisabledState",{providedIn:"root",factory:()=>qb}),qb="always";function G7(t,e){return[...e.path,t]}function oj(t,e,n=qb){aj(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),K7(t,e),Y7(t,e),Q7(t,e),W7(t,e)}function H2(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function W7(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function aj(t,e){let n=j7(t);e.validator!==null?t.setValidators(B2(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=U7(t);e.asyncValidator!==null?t.setAsyncValidators(B2(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();H2(e._rawValidators,i),H2(e._rawAsyncValidators,i)}function K7(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&lj(t,e)})}function Q7(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&lj(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function lj(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Y7(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function X7(t,e){t==null,aj(t,e)}function Z7(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function J7(t){return Object.getPrototypeOf(t.constructor)===qy}function eY(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function tY(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Hy?n=s:J7(s)?r=s:i=s}),i||r||n||null}var nY={provide:Zl,useExisting:mr(()=>Hb)},oh=Promise.resolve(),Hb=(()=>{let e=class e extends Zl{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new at,this.form=new $y({},Ub(r),Bb(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){oh.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),oj(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){oh.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){oh.then(()=>{let i=this._findContainer(r.path),s=new $y({});X7(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){oh.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){oh.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,eY(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(se(jb,10),se(Y2,10),se($b,8))},e.\u0275dir=et({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&Yt("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:[Lt.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fi([nY]),Rn]});let t=e;return t})();function z2(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function G2(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var rY=class extends By{constructor(e=null,n,r){super(ij(n),sj(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),zy(n)&&(n.nonNullable||n.initialValueIsDefault)&&(G2(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){z2(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){z2(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){G2(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var iY={provide:ah,useExisting:mr(()=>zb)},W2=Promise.resolve(),zb=(()=>{let e=class e extends ah{constructor(r,i,s,o,a,l){super(),this._changeDetectorRef=a,this.callSetDisabledState=l,this.control=new rY,this._registered=!1,this.name="",this.update=new at,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=tY(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),Z7(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){oj(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){W2.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Vi(i);W2.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?G7(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(se(Zl,9),se(jb,10),se(Y2,10),se(lh,10),se(Li,8),se($b,8))},e.\u0275dir=et({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Lt.None,"disabled","isDisabled"],model:[Lt.None,"ngModel","model"],options:[Lt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Fi([iY]),Rn,ki]});let t=e;return t})(),cj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=et({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),sY={provide:lh,useExisting:mr(()=>Gb),multi:!0},Gb=(()=>{let e=class e extends qy{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ei(e)))(s||e)}})(),e.\u0275dir=et({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&Yt("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[Fi([sY]),Rn]});let t=e;return t})();var oY={provide:lh,useExisting:mr(()=>Gy),multi:!0};function uj(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function aY(t){return t.split(":")[0]}var Gy=(()=>{let e=class e extends qy{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=uj(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=aY(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ei(e)))(s||e)}})(),e.\u0275dir=et({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&Yt("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fi([oY]),Rn]});let t=e;return t})(),dj=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(uj(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(se(yr),se(ri),se(Gy,9))},e.\u0275dir=et({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),lY={provide:lh,useExisting:mr(()=>hj),multi:!0};function K2(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function cY(t){return t.split(":")[0]}var hj=(()=>{let e=class e extends qy{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let l=0;l<a.length;l++){let c=a[l],u=this._getOptionValue(c.value);s.push(u)}}else{let a=i.options;for(let l=0;l<a.length;l++){let c=a[l];if(c.selected){let u=this._getOptionValue(c.value);s.push(u)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=cY(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ei(e)))(s||e)}})(),e.\u0275dir=et({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&Yt("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fi([lY]),Rn]});let t=e;return t})(),fj=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(K2(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(K2(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(se(yr),se(ri),se(hj,9))},e.\u0275dir=et({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var uY=(()=>{let e=class e{constructor(){this._validator=U2}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):U2,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=et({type:e,features:[ki]});let t=e;return t})();var dY={provide:jb,useExisting:mr(()=>Wb),multi:!0};var Wb=(()=>{let e=class e extends uY{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Vi,this.createValidator=r=>O7}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ei(e)))(s||e)}})(),e.\u0275dir=et({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&Sc("required",s._enabled?"":null)},inputs:{required:"required"},features:[Fi([dY]),Rn]});let t=e;return t})();var hY=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({});let t=e;return t})();var pj=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:$b,useValue:r.callSetDisabledState??qb}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({imports:[hY]});let t=e;return t})();function pY(t,e){if(t&1){let n=MR();$(0,"div",70)(1,"span",71),Yt("click",function(){let i=kf(n).$implicit,s=Xf();return Of(s.selectPokemon(i))})("mouseleave",function(){kf(n);let i=Xf();return Of(i.quitarImagen())})("mouseenter",function(){let i=kf(n).$implicit,s=Xf();return Of(s.cambiarImagen(i))}),j()()}if(t&2){let n=e.$implicit;$e(),RR("pokesprite pokemon ",n.nombreSprite,"")}}function gY(t,e){if(t&1&&($(0,"option",72),Ee(1),j()),t&2){let n=e.$implicit;mw("value",n.idAlternativo),$e(),yw(" ",n.genero," ")}}var gj=(()=>{let e=class e{constructor(r){this.pokemonService=r,this.pokemones=[],this.pokemon=new is,this.generos=[],this.rutaImagen="assets/img/nada.png",this.informacion=""}ngOnInit(){this.pokemonService.getPokemones().subscribe(r=>{this.pokemones=r.map(i=>fe(M({},i.payload.doc.data()),{id:i.payload.doc.id}))}),this.pokemonService.getGeneros().subscribe(r=>{this.generos=r.map(i=>fe(M({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarPokemon(){this.validarFormulario()&&this.validarCaracteresEspeciales()&&(this.pokemonService.createPokemon(this.pokemon),this.pokemon=new is)}selectPokemon(r){this.pokemon=r}updatePokemon(){this.validarFormulario()&&this.validarCaracteresEspeciales()&&(this.pokemonService.updatePokemon(this.pokemon),this.pokemon=new is)}deletePokemon(r){this.pokemonService.deletePokemon(r),this.pokemon=new is}cambiarImagen(r){this.rutaImagen=r.imagen;let i="";r.tipo.split(", ").forEach(o=>{i+="<img src='assets/img/tipos/"+o+".png' class='mx-1'/>"}),this.informacion=r.apodo.toUpperCase()+"</br>/"+r.nombre.toUpperCase()+"</br>"+this.generoImagen(r.generoPokemon)+" "+r.estatura+"m "+r.peso+"lbs</br>"+i}generoImagen(r){return r==1?"<img src='assets/img/macho-pixel.png'>":r==2?"<img src='assets/img/hembra-pixel.png'>":""}quitarImagen(){this.rutaImagen="assets/img/nada.png",this.informacion=""}validarFormulario(){return this.pokemon.apodo?this.pokemon.generoPokemon?this.pokemon.nombreSprite?!0:(alert("Debe seleccionar un Pok\xE9mon."),!1):(alert("Debe seleccionar un g\xE9nero para el Pok\xE9mon."),!1):(alert("Debe ingresar un apodo para el Pok\xE9mon."),!1)}validarCaracteresEspeciales(){return/^[a-zA-ZáéíóúÁÉÍÓÚ\s]+$/.test(this.pokemon.apodo)?!0:(alert("El apodo solo puede contener letras y espacios."),!1)}limpiarPokemon(){this.pokemon=new is,this.quitarImagen()}};e.\u0275fac=function(i){return new(i||e)(se(j2))},e.\u0275cmp=Pi({type:e,selectors:[["app-home"]],decls:125,vars:20,consts:[[1,"fondo"],["src","assets/img/river_underwater.png","id","paisaje"],["src","assets/img/feebas.gif","id","feebas"],["src","assets/img/magikarp.gif","id","magikarp"],["src","assets/img/magikarp.gif","id","magikarp-juego"],["id","magikarp-gemelo","onmouseover","moverse()"],["id","agua"],["id","particles"],["src","assets/img/horsea.png","id","horsea"],["id","pc","name","PC"],["src","assets/img/pc.png","id","pc-img"],["id","bibli-pagina",1,"text-center"],["id","bibli-info",1,"text-center",3,"innerHTML"],["id","bibli-img",3,"src"],["id","bibli",1,"bibli"],[1,"row","row-cols-6","tabla-poke"],["class","col","style","height: 20px;",4,"ngFor","ngForOf"],[1,"row","botones-pag"],[1,"col","text-center"],["id","prevPage"],["src","assets/img/prev.png"],["id","nextPage"],["src","assets/img/next.png"],["id","agregar","name","Guardar en PC"],["id","formulario-pokemon"],["id","fieldset-pokemon"],["onerror","this.src='assets/img/missingno.png'","src","assets/img/missingno.png","id","perfil-img","alt","",1,"img-fluid","mx-auto","d-block","mt-2"],[2,"display","none"],[1,"form-label","mt-2"],["type","text","id","imagen-pokemon","name","imagen","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","apodo","id","apodo","placeholder","Ingrese un apodo","required","",1,"form-control",3,"ngModelChange","ngModel"],["id","genero","name","genero",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","search","id","input-box","name","nombre","placeholder","Buscar Pok\xE9mon","autocomplete","off","required","",1,"input-box","form-control","me-sm-2",3,"ngModelChange","ngModel"],["id","search-result","autocomplete","on",1,"search-result"],["id","ayudaPokemon",1,"form-text","text-muted"],["type","text","name","nombreSprite","id","name","placeholder","Name-id",1,"form-control",3,"ngModelChange","ngModel"],["id","a\xF1adir-tipo-id",1,"a\xF1adir-tipo"],["name","tipo","id","tipos-poke","type","text","value","","disabled","",1,"form-control",2,"display","none",3,"ngModelChange","ngModel"],["id","tipoContainer",1,"text-center"],["name","habilidades","id","habilidades","type","text","value","","disabled","",1,"form-control",3,"ngModelChange","ngModel"],["name","experiencia","id","experiencia","type","number","step","any","disabled","",1,"form-control",3,"ngModelChange","ngModel"],["name","estatura","id","estatura","type","number","step","any","disabled","",1,"form-control",3,"ngModelChange","ngModel"],["name","peso","id","peso","type","number","step","any","disabled","",1,"form-control",3,"ngModelChange","ngModel"],[1,"progress"],["name","salud","id","salud","type","number","step","any","disabled","",1,"form-control",2,"display","none",3,"ngModelChange","ngModel"],["id","salud-barra","role","progressbar","aria-valuemin","0","aria-valuemax","255","name","salud-barra",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-success"],["name","ataque","id","ataque","type","number","step","any","disabled","",1,"form-control",2,"display","none",3,"ngModelChange","ngModel"],["id","ataque-barra","role","progressbar","aria-valuemin","0","aria-valuemax","255",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-info"],["name","defensa","id","defensa","type","number","step","any","disabled","",1,"form-control",2,"display","none",3,"ngModelChange","ngModel"],["id","defensa-barra","role","progressbar","aria-valuemin","0","aria-valuemax","255","name","defensa-barra",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-warning"],["name","ataque-especial","id","ataque-especial","type","number","step","any","disabled","",1,"form-control",2,"display","none",3,"ngModelChange","ngModel"],["id","ataque-especial-barra","role","progressbar","aria-valuemin","0","aria-valuemax","255","name","ataque-especial-barra",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-danger"],["name","defensa-especial","id","defensa-especial","type","number","step","any","disabled","",1,"form-control",2,"display","none",3,"ngModelChange","ngModel"],["id","defensa-especial-barra","role","progressbar","aria-valuemin","0","aria-valuemax","255","name","defensa-especial-barra",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-sucess"],[1,"progress","mb-2"],["name","velocidad","id","velocidad","type","number",1,"form-control",2,"display","none",3,"ngModelChange","ngModel"],["id","velocidad-barra","role","progressbar","aria-valuemin","0","aria-valuemax","255","name","velocidad-barra",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-info"],[1,"container"],[1,"row"],["type","button","id","insertar-btn","onclick","agregar2()",1,"col","mx-2","btn","btn-primary",3,"click"],["type","button","onclick","agregar2()",1,"col","mx-2","btn","btn-warning",3,"click"],["type","button","onclick","agregar2()",1,"col","my-2","mx-2","btn","btn-danger",3,"click"],["type","button","onclick","agregar2()",1,"col","my-2","mx-2","btn","btn-info",3,"click"],["id","acerca","name","Acerca de"],["id","nombres"],["id","juego"],[1,"pokebolas-juego"],["id","pokemon-juego","src","assets/img/pikachu-f.gif"],["id","perder"],[1,"col",2,"height","20px"],["onclick","agregar2()",3,"click","mouseleave","mouseenter"],[3,"value"]],template:function(i,s){i&1&&($(0,"div",0),Oe(1,"img",1)(2,"img",2)(3,"img",3)(4,"img",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"img",8),$(9,"div",9),Oe(10,"img",10)(11,"div",11)(12,"div",12)(13,"img",13),$(14,"div",14)(15,"div",15),Qf(16,pY,2,3,"div",16),j(),$(17,"div",17)(18,"div",18)(19,"button",19),Oe(20,"img",20),j(),$(21,"button",21),Oe(22,"img",22),j()()()()(),$(23,"div",23)(24,"form",24)(25,"fieldset",25),Oe(26,"img",26),$(27,"div",27)(28,"label",28),Ee(29,"URL"),j(),$(30,"input",29),vt("ngModelChange",function(a){return Mt(s.pokemon.imagen,a)||(s.pokemon.imagen=a),a}),j()(),$(31,"div")(32,"label",28),Ee(33,"Apodo"),j(),$(34,"input",30),vt("ngModelChange",function(a){return Mt(s.pokemon.apodo,a)||(s.pokemon.apodo=a),a}),j()(),$(35,"div")(36,"label",28),Ee(37,"G\xE9nero"),j(),$(38,"select",31),vt("ngModelChange",function(a){return Mt(s.pokemon.generoPokemon,a)||(s.pokemon.generoPokemon=a),a}),Qf(39,gY,2,2,"option",32),j()(),$(40,"div")(41,"label",28),Ee(42,"P\xF3kemon"),j(),$(43,"input",33),vt("ngModelChange",function(a){return Mt(s.pokemon.nombre,a)||(s.pokemon.nombre=a),a}),j(),Oe(44,"div",34),$(45,"small",35),Ee(46,"Con esto completaremos los datos de tu Pok\xE9mon."),j()(),$(47,"div",27)(48,"label",28),Ee(49,"Name"),j(),$(50,"input",36),vt("ngModelChange",function(a){return Mt(s.pokemon.nombreSprite,a)||(s.pokemon.nombreSprite=a),a}),j()(),$(51,"div",37)(52,"label",28),Ee(53,"Tipo"),j(),$(54,"input",38),vt("ngModelChange",function(a){return Mt(s.pokemon.tipo,a)||(s.pokemon.tipo=a),a}),j(),Oe(55,"div",39),j(),$(56,"div")(57,"label",28),Ee(58,"Habilidades"),j(),$(59,"input",40),vt("ngModelChange",function(a){return Mt(s.pokemon.habilidades,a)||(s.pokemon.habilidades=a),a}),j()(),$(60,"div")(61,"label",28),Ee(62,"Experiencia Base"),j(),$(63,"input",41),vt("ngModelChange",function(a){return Mt(s.pokemon.experiencia,a)||(s.pokemon.experiencia=a),a}),j()(),$(64,"div")(65,"label",28),Ee(66,"Estatura (m)"),j(),$(67,"input",42),vt("ngModelChange",function(a){return Mt(s.pokemon.estatura,a)||(s.pokemon.estatura=a),a}),j()(),$(68,"div")(69,"label",28),Ee(70,"Peso (lbs)"),j(),$(71,"input",43),vt("ngModelChange",function(a){return Mt(s.pokemon.peso,a)||(s.pokemon.peso=a),a}),j()(),$(72,"label",28),Ee(73,"Puntos de salud (PS)"),j(),$(74,"div",44)(75,"input",45),vt("ngModelChange",function(a){return Mt(s.pokemon.salud,a)||(s.pokemon.salud=a),a}),j(),Oe(76,"div",46),j(),$(77,"label",28),Ee(78,"Ataque"),j(),$(79,"div",44)(80,"input",47),vt("ngModelChange",function(a){return Mt(s.pokemon.ataque,a)||(s.pokemon.ataque=a),a}),j(),Oe(81,"div",48),j(),$(82,"label",28),Ee(83,"Defensa"),j(),$(84,"div",44)(85,"input",49),vt("ngModelChange",function(a){return Mt(s.pokemon.defensa,a)||(s.pokemon.defensa=a),a}),j(),Oe(86,"div",50),j(),$(87,"label",28),Ee(88,"Ataque especial"),j(),$(89,"div",44)(90,"input",51),vt("ngModelChange",function(a){return Mt(s.pokemon.ataqueEspecial,a)||(s.pokemon.ataqueEspecial=a),a}),j(),Oe(91,"div",52),j(),$(92,"label",28),Ee(93,"Defensa especial"),j(),$(94,"div",44)(95,"input",53),vt("ngModelChange",function(a){return Mt(s.pokemon.defensaEspecial,a)||(s.pokemon.defensaEspecial=a),a}),j(),Oe(96,"div",54),j(),$(97,"label",28),Ee(98,"Velocidad"),j(),$(99,"div",55)(100,"input",56),vt("ngModelChange",function(a){return Mt(s.pokemon.velocidad,a)||(s.pokemon.velocidad=a),a}),j(),Oe(101,"div",57),j()(),$(102,"div",58)(103,"div",59)(104,"button",60),Yt("click",function(){return s.insertarPokemon()}),Ee(105,"Insertar"),j(),$(106,"button",61),Yt("click",function(){return s.updatePokemon()}),Ee(107,"Modificar"),j(),$(108,"button",62),Yt("click",function(){return s.deletePokemon(s.pokemon.id)}),Ee(109,"Eliminar"),j(),$(110,"button",63),Yt("click",function(){return s.limpiarPokemon()}),Ee(111,"Limpiar"),j()()()()(),$(112,"div",64)(113,"div",65),Ee(114," INTEGRANTES "),Oe(115,"br")(116,"br"),Ee(117," Daniel Alberto Cruz Herrera / Carolina Ugalde Serrano / Mar\xEDa Jos\xE9 Martinez Cayetano / Viviana Itzel Cruz de Jes\xFAs "),Oe(118,"br")(119,"br"),Ee(120," DS01SV-23 "),j(),$(121,"div",66),Oe(122,"div",67)(123,"img",68)(124,"div",69),j()()()),i&2&&($e(12),Ea("innerHTML",s.informacion,jx),$e(),Ea("src",s.rutaImagen,Jv),$e(3),Ea("ngForOf",s.pokemones),$e(14),_t("ngModel",s.pokemon.imagen),$e(4),_t("ngModel",s.pokemon.apodo),$e(4),_t("ngModel",s.pokemon.generoPokemon),$e(),Ea("ngForOf",s.generos),$e(4),_t("ngModel",s.pokemon.nombre),$e(7),_t("ngModel",s.pokemon.nombreSprite),$e(4),_t("ngModel",s.pokemon.tipo),$e(5),_t("ngModel",s.pokemon.habilidades),$e(4),_t("ngModel",s.pokemon.experiencia),$e(4),_t("ngModel",s.pokemon.estatura),$e(4),_t("ngModel",s.pokemon.peso),$e(4),_t("ngModel",s.pokemon.salud),$e(5),_t("ngModel",s.pokemon.ataque),$e(5),_t("ngModel",s.pokemon.defensa),$e(5),_t("ngModel",s.pokemon.ataqueEspecial),$e(5),_t("ngModel",s.pokemon.defensaEspecial),$e(5),_t("ngModel",s.pokemon.velocidad))},dependencies:[tM,cj,dj,fj,Hy,Gb,Gy,nj,rj,Wb,zb,Hb],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;letter-spacing:.5px;box-sizing:border-box}.fondo[_ngcontent-%COMP%]{position:relative;width:100%;height:100vh;display:flex;justify-content:center;align-items:center;overflow:hidden}#particles[_ngcontent-%COMP%]{width:100%;height:100%;z-index:-1}.fondo[_ngcontent-%COMP%]   #paisaje[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:cover;pointer-events:none;image-rendering:pixelated;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}#feebas[_ngcontent-%COMP%]{left:0;bottom:75px;width:10%;position:absolute;image-rendering:pixelated;z-index:-3;animation:_ngcontent-%COMP%_pez 40s cubic-bezier(.9,1,.3,.75) 0s infinite normal;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}#magikarp[_ngcontent-%COMP%]{left:0;bottom:225px;width:10%;position:absolute;image-rendering:pixelated;z-index:-3;animation:_ngcontent-%COMP%_pez 25s cubic-bezier(.7,1,.3,.5) 0s infinite normal;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}@keyframes _ngcontent-%COMP%_pez{0%{transform:translate(0) scaleX(-1);-webkit-transform:translate(0vw) scaleX(-1);-moz-transform:translate(0vw) scaleX(-1);-ms-transform:translate(0vw) scaleX(-1);-o-transform:translate(0vw) scaleX(-1)}10%{transform:translate(20vw,-125px) scaleX(-1);-webkit-transform:translate(20vw,-125px) scaleX(-1);-moz-transform:translate(20vw,-125px) scaleX(-1);-ms-transform:translate(20vw,-125px) scaleX(-1);-o-transform:translate(20vw,-125px) scaleX(-1)}20%{transform:translate(40vw,-45px) rotate(22deg) scaleX(-1);-webkit-transform:translate(40vw,-45px) rotateZ(22deg) scaleX(-1);-moz-transform:translate(40vw,-45px) rotateZ(22deg) scaleX(-1);-ms-transform:translate(40vw,-45px) rotateZ(22deg) scaleX(-1);-o-transform:translate(40vw,-45px) rotateZ(22deg) scaleX(-1)}30%{transform:translate(60vw,-250px) scaleX(-1);-webkit-transform:translate(60vw,-250px) scaleX(-1);-moz-transform:translate(60vw,-250px) scaleX(-1);-ms-transform:translate(60vw,-250px) scaleX(-1);-o-transform:translate(60vw,-250px) scaleX(-1)}40%{transform:translate(80vw,-80px) rotate(22deg) scaleX(-1);-webkit-transform:translate(80vw,-80px) rotateZ(22deg) scaleX(-1);-moz-transform:translate(80vw,-80px) rotateZ(22deg) scaleX(-1);-ms-transform:translate(80vw,-80px) rotateZ(22deg) scaleX(-1);-o-transform:translate(80vw,-80px) rotateZ(22deg) scaleX(-1)}50%{transform:translate(100vw,-145px) scaleX(-1);-webkit-transform:translate(100vw,-145px) scaleX(-1);-moz-transform:translate(100vw,-145px) scaleX(-1);-ms-transform:translate(100vw,-145px) scaleX(-1);-o-transform:translate(100vw,-145px) scaleX(-1)}51%{transform:translate(100vw,-145px) rotateY(180deg) scaleX(-1);-webkit-transform:translate(100vw,-145px) rotateY(180deg) scaleX(-1);-moz-transform:translate(100vw,-145px) rotateY(180deg) scaleX(-1);-ms-transform:translate(100vw,-145px) rotateY(180deg) scaleX(-1);-o-transform:translate(100vw,-145px) rotateY(180deg) scaleX(-1)}60%{transform:translate(80vw,-80px) rotateY(180deg) rotate(22deg) scaleX(-1);-webkit-transform:translate(80vw,-80px) rotateY(180deg) rotateZ(22deg) scaleX(-1);-moz-transform:translate(80vw,-80px) rotateY(180deg) rotateZ(22deg) scaleX(-1);-ms-transform:translate(80vw,-80px) rotateY(180deg) rotateZ(22deg) scaleX(-1);-o-transform:translate(80vw,-80px) rotateY(180deg) rotateZ(22deg) scaleX(-1)}70%{transform:translate(60vw,-250px) rotateY(180deg) scaleX(-1);-webkit-transform:translate(60vw,-250px) rotateY(180deg) scaleX(-1);-moz-transform:translate(60vw,-250px) rotateY(180deg) scaleX(-1);-ms-transform:translate(60vw,-250px) rotateY(180deg) scaleX(-1);-o-transform:translate(60vw,-250px) rotateY(180deg) scaleX(-1)}80%{transform:translate(40vw,-45px) rotateY(180deg) rotate(22deg) scaleX(-1);-webkit-transform:translate(40vw,-45px) rotateY(180deg) rotateZ(22deg) scaleX(-1);-moz-transform:translate(40vw,-45px) rotateY(180deg) rotateZ(22deg) scaleX(-1);-ms-transform:translate(40vw,-45px) rotateY(180deg) rotateZ(22deg) scaleX(-1);-o-transform:translate(40vw,-45px) rotateY(180deg) rotateZ(22deg) scaleX(-1)}90%{transform:translate(20vw,-125px) rotateY(180deg) scaleX(-1);-webkit-transform:translate(20vw,-125px) rotateY(180deg) scaleX(-1);-moz-transform:translate(20vw,-125px) rotateY(180deg) scaleX(-1);-ms-transform:translate(20vw,-125px) rotateY(180deg) scaleX(-1);-o-transform:translate(20vw,-125px) rotateY(180deg) scaleX(-1)}99%{transform:translate(0) rotateY(180deg) rotate(22deg) scaleX(-1);-webkit-transform:translate(0vw) rotateY(180deg) rotateZ(22deg) scaleX(-1);-moz-transform:translate(0vw) rotateY(180deg) rotateZ(22deg) scaleX(-1);-ms-transform:translate(0vw) rotateY(180deg) rotateZ(22deg) scaleX(-1);-o-transform:translate(0vw) rotateY(180deg) rotateZ(22deg) scaleX(-1)}to{transform:translate(0) scaleX(-1);-webkit-transform:translate(0vw) scaleX(-1);-moz-transform:translate(0vw) scaleX(-1);-ms-transform:translate(0vw) scaleX(-1);-o-transform:translate(0vw) scaleX(-1)}}.fondo[_ngcontent-%COMP%]   #horsea[_ngcontent-%COMP%]{position:absolute;width:50%;object-fit:fill;pointer-events:none;image-rendering:pixelated;animation:_ngcontent-%COMP%_horsea 8s infinite alternate-reverse;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}@keyframes _ngcontent-%COMP%_horsea{0%{transform:translateY(20px) rotate(-10deg)}to{transform:translateY(60px) rotate(10deg)}}.fondo[_ngcontent-%COMP%]   img#paisaje[_ngcontent-%COMP%]{z-index:-4;animation:_ngcontent-%COMP%_ondulacion 6s ease-in-out alternate infinite;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}@keyframes _ngcontent-%COMP%_ondulacion{0%,to{transform:skew(0) scale(1.35);filter:saturate(100%) invert(0%)}25%{filter:saturate(180%) invert(10%)}50%{transform:skew(2deg,2deg) scale(1.35);filter:saturate(100%) invert(0%)}75%{filter:saturate(150%) invert(20%)}}.fondo[_ngcontent-%COMP%]   img#horsea[_ngcontent-%COMP%]{z-index:-1;filter:drop-shadow(1.5px 1.5px 4px #040018);-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}.fondo[_ngcontent-%COMP%]   #agua[_ngcontent-%COMP%]{position:absolute;opacity:.5;width:100%;height:100%;object-fit:cover;background:linear-gradient(to top,#2305c7,#8adfc7);z-index:-2;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}#pc[_ngcontent-%COMP%]{filter:drop-shadow(.5px .5px 4px #040018);height:320px;width:480px;background-color:#fff}#pc-img[_ngcontent-%COMP%]{position:relative;image-rendering:pixelated;object-fit:contain;height:100%;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}#bibli[_ngcontent-%COMP%]{left:164px;top:38px;position:absolute;width:312px;height:282px;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;background-image:url(https://media.discordapp.net/attachments/1219525220109389865/1219525327919906816/fondo-pc.png?ex=660b9e77&is=65f92977&hm=ea4896ab038ff3246d3333dea93beecb8137b316cc2eef3a84addcead44f3e8f&=&format=webp&quality=lossless&width=234&height=211);image-rendering:pixelated;background-repeat:no-repeat;background-size:100%}.bibli[_ngcontent-%COMP%]{cursor:url(https://cdn.discordapp.com/attachments/1219525220109389865/1219528297923350539/puntero.png?ex=660ba13b&is=65f92c3b&hm=b90b9ba998784f59c19f682af60a6571f4a5ebcd03e06121c155539336963d63&) 0 64,auto}.tabla-poke[_ngcontent-%COMP%]{position:relative;width:312px;height:232px;top:38px;display:flex}#contendor-pokemon[_ngcontent-%COMP%]{width:100%;height:100%}.pokesprite[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_salto2 .5s linear alternate infinite}.pokesprite[_ngcontent-%COMP%]:hover{animation:_ngcontent-%COMP%_saltoalegre .5s linear alternate infinite}@keyframes _ngcontent-%COMP%_salto{0%{transform:translateZ(0) scaleZ(1)}40%{transform:translate3d(0,.2%,0) scale3d(.8,1.2,1)}to{transform:translate3d(0,.7%,0) scale3d(1,.7,1)}}@keyframes _ngcontent-%COMP%_salto2{0%{transform:translateZ(0)}40%{transform:translate3d(-2%,2%,0)}to{transform:translate3d(-4%,8%,0)}}@keyframes _ngcontent-%COMP%_saltoalegre{0%{transform:translateZ(0) scaleZ(1)}40%{transform:translate3d(0,2%,0) scale3d(.8,1.2,1)}to{transform:translate3d(0,8%,0) scale3d(1,.8,1)}}.botones-pag[_ngcontent-%COMP%]{top:10px;position:absolute}#prevPage[_ngcontent-%COMP%]{all:unset;position:relative;left:12px;animation:_ngcontent-%COMP%_izquierda .25s linear alternate infinite}#prevPage[_ngcontent-%COMP%]:hover, #nextPage[_ngcontent-%COMP%]:hover{filter:invert(1)}#nextPage[_ngcontent-%COMP%]{all:unset;position:relative;left:268px;animation:_ngcontent-%COMP%_derecha .25s linear alternate infinite}#prevPage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #nextPage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;image-rendering:pixelated;object-fit:cover}@keyframes _ngcontent-%COMP%_izquierda{0%{transform:translate3d(-20%,0,0)}40%{transform:translate3d(-8%,0,0)}to{transform:translateZ(0)}}@keyframes _ngcontent-%COMP%_derecha{0%{transform:translate3d(20%,0,0)}40%{transform:translate3d(8%,0,0)}to{transform:translateZ(0)}}#bibli-pagina[_ngcontent-%COMP%]{font-family:Pixelify Sans;text-shadow:2px 2px 0 #000;color:#fff;left:196px;top:48px;position:absolute;width:248px;height:25px;z-index:1}#bibli-info[_ngcontent-%COMP%]{font-family:Pixelify Sans;text-shadow:2px 2px 0 #000;color:#fff;left:4px;top:200px;position:absolute;width:148px;height:110px;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}#bibli-img[_ngcontent-%COMP%]{left:20px;top:56px;position:absolute;width:120px;height:120px;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;image-rendering:pixelated}#agregar[_ngcontent-%COMP%]{filter:drop-shadow(.5px .5px 4px #040018);height:400px;width:210px;background-color:#fff;overflow-y:scroll;left:70px;top:100px}#formulario-pokemon[_ngcontent-%COMP%]{padding:0 10px}#perfil-img[_ngcontent-%COMP%]{image-rendering:pixelated;object-fit:cover;height:160px;width:160px;animation:_ngcontent-%COMP%_tamano 2s infinite}@keyframes _ngcontent-%COMP%_tamano{0%,20%,40%,80%,to{transform:scale(1) translateY(0)}60%{transform:scale(.8) translateY(-15px)}}#bibli-img[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_saltoInicial .6s linear alternate infinite}@keyframes _ngcontent-%COMP%_saltoInicial{0%,20%,40%,80%,to{transform:translateY(0)}60%{transform:translateY(-10px)}}#magikarp-juego[_ngcontent-%COMP%]{top:10%;left:70%;width:10%;position:absolute;image-rendering:pixelated;z-index:-3;transition-duration:1s;animation:_ngcontent-%COMP%_magikarp-juego 8s infinite alternate-reverse}#magikarp-gemelo[_ngcontent-%COMP%]{top:10%;left:70%;position:absolute;image-rendering:pixelated;z-index:0}@keyframes _ngcontent-%COMP%_magikarp-juego{0%{transform:rotate(10deg)}to{transform:rotate(30deg)}}#acerca[_ngcontent-%COMP%]{filter:drop-shadow(.5px .5px 4px #040018);height:400px;width:250px;background-color:#fdeaeb;right:70px;top:100px}#juego[_ngcontent-%COMP%]{position:relative;height:300px;width:250px;top:80px}#perder[_ngcontent-%COMP%]{position:absolute;width:100%;height:10px;bottom:0}#pokemon-juego[_ngcontent-%COMP%]{width:70px;height:63.14px;image-rendering:pixelated;object-fit:cover;position:absolute;bottom:10px;left:calc(50% - 25px)}#nombres[_ngcontent-%COMP%]{position:absolute;font-family:Pixelify Sans;color:#e597bd;height:80px;width:250px;text-align:center;padding:20px}"]});let t=e;return t})();var mY=[{path:"home",component:gj},{path:"**",redirectTo:"home"}],mj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Pe({imports:[XC.forRoot(mY),XC]});let t=e;return t})();var yj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Pi({type:e,selectors:[["app-menu"]],decls:17,vars:0,consts:[["data-bs-theme","dark",1,"navbar","navbar-expand-lg","bg-primary"],[1,"container-fluid"],["routerLink","/home","onclick","mostrarTodasVentanas()",1,"navbar-brand"],["src","assets/img/icono.png","id","icono-home"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarColor03","aria-controls","navbarColor03","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarColor03",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto"],[1,"nav-item"],["routerLink","","onclick","pc()",1,"nav-link"],["routerLink","","onclick","agregar()",1,"nav-link"],["id","acerca-de","routerLink","","onclick","acerca()",1,"nav-link"]],template:function(i,s){i&1&&($(0,"nav",0)(1,"div",1)(2,"a",2),Oe(3,"img",3),j(),$(4,"button",4),Oe(5,"span",5),j(),$(6,"div",6)(7,"ul",7)(8,"li",8)(9,"a",9),Ee(10,"MI PC"),j()(),$(11,"li",8)(12,"a",10),Ee(13,"AGREGAR"),j()(),$(14,"li",8)(15,"a",11),Ee(16,"ACERCA DE"),j()()()()()())},dependencies:[LO],styles:[".navbar-expand-lg[_ngcontent-%COMP%]{position:fixed;font-family:Pixelify Sans;width:100%;z-index:1;font-size:xx-large}#icono-home[_ngcontent-%COMP%]{filter:brightness(0) invert(1);height:50px;image-rendering:pixelated}"]});let t=e;return t})();var _j=(()=>{let e=class e{constructor(){this.title="pokedex"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Pi({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(i,s){i&1&&Oe(0,"app-menu")(1,"router-outlet")},dependencies:[HC,yj]});let t=e;return t})();var vj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ke({type:e,bootstrap:[_j]}),e.\u0275inj=Pe({imports:[CM,mj,pj,xM.initializeApp(Xk.firebaseConfig),dk,Yk,pM]});let t=e;return t})();IM().bootstrapModule(vj).catch(t=>console.error(t));
